<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0048)http://topic.csdn.net/t/20040921/14/3394457.html -->
<HTML lang=zh-CN xml:lang="zh-CN" 
xmlns="http://www.w3.org/1999/xhtml"><HEAD><TITLE>捣蛋的来了 C++ Builder / 基础类 - CSDN社区 community.csdn.net</TITLE>
<META content=all name=robots>
<META http-equiv=Content-Language content=zh-CN>
<META http-equiv=Content-Type content="text/html; charset=utf-8"><LINK 
href="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/topic.css" 
type=text/css rel=stylesheet>
<SCRIPT src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/Topic.js" 
type=text/javascript></SCRIPT>

<META 
content="access stutc ftcreate ftlastwrite ftlastaccess systemtimetodatetime filetimetosystemtime datetimetostr dt showmessage C++ Builder 基础类" 
name=Keywords>
<META 
content="  SYSTEMTIME stUTC;  TDateTime DT;  FILETIME ftCreate, ftLastAccess, ftLastWrite;  String filename=ParamStr(0);  HANDLE hFile;  hFile= CreateFile(  filename.c_str(),                       GENERIC_READ,                       0,                       NULL,                       OPEN_EXISTING,                       FILE_ATTRIBUTE_NORMAL,                       NULL);  GetFileTime(filename.c_str(),&amp;ftCreate,&amp;ftLastAccess,&amp;ftLastWrite);  FileTimeToSystemTime( &amp;ftCreate, &amp;stUTC );  " 
name=description>
<META content="MSHTML 6.00.2900.5848" name=GENERATOR></HEAD>
<BODY>
<DIV id=wrapper>
<DIV id=innerWrapper>
<DIV id=logo>
<SCRIPT 
src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/csdn_ggmm.js"></SCRIPT>

<SCRIPT type=text/javascript>show_ads_zone(230);</SCRIPT>
<IMG style="DISPLAY: none" alt="" 
src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/pv.aspx"> 
<DIV>
<TABLE class=CSDN-PHF id=CSDNPHL cellSpacing=1 cellPadding=0 border=0>
  <TBODY>
  <TR>
    <TD><A href="http://www.csdn.net/" rel=external>CSDN首页</A></TD>
    <TD><A href="http://hi.csdn.net/" rel=external>空间</A></TD>
    <TD><A href="http://news.csdn.net/" rel=external>新闻</A></TD>
    <TD><A href="http://bbs.csdn.net/" rel=external>论坛</A></TD>
    <TD><A href="http://blog.csdn.net/" rel=external>Blog</A></TD>
    <TD><A href="http://download.csdn.net/" rel=external>下载</A></TD>
    <TD><A href="http://book.csdn.net/" rel=external>读书</A></TD>
    <TD><A href="http://wz.csdn.net/" rel=external>网摘</A></TD>
    <TD><A href="http://search.csdn.net/" rel=external>搜索</A></TD>
    <TD><A href="http://dotnet.csdn.net/" rel=external>.NET</A></TD>
    <TD><A href="http://java.csdn.net/" rel=external>Java</A></TD>
    <TD><A href="http://live.csdn.net/" rel=external>视频</A></TD>
    <TD><A href="http://prj.csdn.net/" rel=external>接项目</A></TD>
    <TD><A href="http://job.csdn.net/" rel=external>求职</A></TD>
    <TD><A href="http://www.itcast.net/" rel=external>在线学习</A></TD>
    <TD><A href="http://www.dearbook.com.cn/" rel=external>买书</A></TD>
    <TD><A href="http://www.programmer.com.cn/" rel=external>程序员</A></TD>
    <TD><A href="http://hi.csdn.net/Admin/NotifyList.aspx"><SPAN 
      id=notifyPrompt>通知</SPAN></A></TD></TR></TBODY></TABLE>
<DIV id=logo>
<TABLE cellSpacing=0 cellPadding=0 width=760 border=0>
  <TBODY>
  <TR style="TEXT-ALIGN: center">
    <TD style="MARGIN: auto; VERTICAL-ALIGN: middle; BACKGROUND-COLOR: #026994" 
    align=middle width=380 height=36><!--a href="http://community.csdn.net/Games/GamesList.aspx/" target="_blank"><font size="3px" color="white"><strong>可用分押宝游戏火热进行中...</strong></font></a--><A 
      href="http://g.csdn.net/5085044" target=_blank><FONT color=white 
      size=3><STRONG>【经验总结】不能实施并行处理的情况</STRONG></FONT></A> </TD>
    <TD style="MARGIN: auto; VERTICAL-ALIGN: middle; BACKGROUND-COLOR: #026994" 
    align=middle width=380 height=36><A href="http://g.csdn.net/5085045" 
      target=_blank><FONT color=white 
      size=3><STRONG>浅谈并行编程中的任务分解模式</STRONG></FONT></A> </TD></TR>
  <TR id=bigFlash style="TEXT-ALIGN: center"><!--td colspan="2"><a href="http://community.csdn.net/" target="_blank"><img src="/t/img/topicAD.jpg" width="760" height="300" border="0" /></a></td-->
    <TD colSpan=2><A href="http://g.csdn.net/5078710" target=_blank><IMG 
      height=300 
      src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/20090403.jpg" 
      width=760 border=0></A></TD></TR></TBODY></TABLE>
<SCRIPT type=text/javascript>setTimeout("document.getElementById('bigFlash').style.display='none'", 5000);</SCRIPT>
</DIV>
<TABLE>
  <TBODY>
  <TR>
    <TD><A href="http://community.csdn.net/" rel=external><IMG alt=CSDN社区 
      src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/logo_csdn.gif"></A></TD>
    <TD>
      <SCRIPT type=text/javascript>show_ads_zone(228);</SCRIPT>
<!--<iframe frameborder="0" width="475" height="60" scrolling="no" src="/t/img/centerAd.htm">
    </iframe>--></TD>
    <TD>
      <SCRIPT type=text/javascript>show_ads_zone(229);</SCRIPT>
    </TD></TR></TBODY></TABLE><!-- script src="http://notify.hi.csdn.net/PromptInfo.ashx?ForWhat=FullJs"></script --><LINK 
media=all 
href="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/csdn_favbykimi.css" 
type=text/css rel=stylesheet>
<DIV id=navigation>
<DIV id=search>
<DIV id=innerSearch><INPUT id=key onfocus="value=''"><A 
onclick="return Search()" 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">搜索</A>&nbsp;<CITE 
class=fav_csdnstylebykimi><A title=收藏到我的网摘中，并分享给我的朋友 
href="javascript:d=document;t=d.selection?(d.selection.type!='None'?d.selection.createRange().text:''):(d.getSelection?d.getSelection():'');void(saveit=window.open('http://wz.csdn.net/storeit.aspx?t='+escape(d.title)+'&amp;u='+escape(d.location.href)+'&amp;c='+escape(t),'saveit','scrollbars=no,width=590,height=300,left=75,top=20,status=no,resizable=yes'));saveit.focus();">收藏</A></CITE>&nbsp;<A 
onclick="return Print()" 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">打印</A>&nbsp;<A 
onclick="return Close()" 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">关闭</A> </DIV></DIV>
<DIV><A class=CSDNRoom href="http://community.csdn.net/" 
rel=external>CSDN社区</A>&nbsp;&gt;&nbsp; <A 
href="http://community.csdn.net/Expert/ForumsList.asp?typenum=1&amp;roomid=55" 
rel=external>C++ Builder</A>&nbsp;&gt;&nbsp; <A 
href="http://community.csdn.net/Expert/ForumList.asp?typenum=1&amp;roomid=5501" 
rel=external>基础类</A> </DIV></DIV>
<DIV id=mainWrapper>
<DIV id=pageContent>
<DIV id=innerContent>
<H1>捣蛋的来了</H1>
<DIV class=author><A class=anchor name=Top>楼主</A>MEFULEU（没有作不到，只有想不到）<INPUT class=star1 title="一星用户 该版得分小于等于10000分，大于5000分" type=button>2004-09-21 
14:47:52 在 C++ Builder / 基础类 提问</DIV>
<P> <BR>&nbsp; &nbsp; &nbsp; SYSTEMTIME &nbsp; stUTC; &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; TDateTime &nbsp; DT; &nbsp; <BR>&nbsp; &nbsp; &nbsp; FILETIME &nbsp; 
ftCreate, &nbsp; ftLastAccess, &nbsp; ftLastWrite; &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; String &nbsp; filename=ParamStr(0); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
HANDLE &nbsp; hFile; &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; &nbsp; hFile= 
&nbsp; CreateFile( &nbsp; &nbsp; filename.c_str(), &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
GENERIC_READ, &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0, &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NULL, &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; OPEN_EXISTING, &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FILE_ATTRIBUTE_NORMAL, 
&nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; NULL); &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
GetFileTime(filename.c_str(),&amp;ftCreate,&amp;ftLastAccess,&amp;ftLastWrite); 
&nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; &nbsp; FileTimeToSystemTime( &nbsp; 
&amp;ftCreate, &nbsp; &amp;stUTC &nbsp; ); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
DT=SystemTimeToDateTime(stUTC); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
ShowMessage(DateTimeToStr(DT)); &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; FileTimeToSystemTime( &nbsp; &amp;ftLastAccess, &nbsp; &amp;stUTC &nbsp; 
); &nbsp; <BR>&nbsp; &nbsp; &nbsp; DT=SystemTimeToDateTime(stUTC); &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; ShowMessage(DateTimeToStr(DT)); &nbsp; <BR>&nbsp; 
&nbsp; <BR>&nbsp; &nbsp; &nbsp; FileTimeToSystemTime( &nbsp; &amp;ftLastWrite, 
&nbsp; &amp;stUTC &nbsp; ); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
DT=SystemTimeToDateTime(stUTC); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
ShowMessage(DateTimeToStr(DT)); &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; CloseHandle(hFile); &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
为什么得到的文件时间不是当前的时间????????? &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
<SPAN>问题点数：200、回复次数：16</SPAN><A 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A> </P>
<DIV class=tagad><IFRAME 
src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/Board.htm" 
frameBorder=0 scrolling=no></IFRAME></DIV>
<H3><STRONG><A class=anchor name=r_24248540>1 楼</A>cczlp（不惑）<INPUT class=star2 title="二星用户 该版得分小于等于30000分，大于10000分" type=button></STRONG><SPAN>回复于 
2004-09-21 14:58:01 得分 0 </SPAN></H3>
<P>把exe文件删除再编译<A 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24248741>2 楼</A>zfive5（醉马不肖）<INPUT class=user2 title="二级用户 该版得分小于等于500分，大于100分" type=button></STRONG><SPAN>回复于 
2004-09-21 15:03:37 得分 0 </SPAN></H3>
<P>Not &nbsp; all &nbsp; file &nbsp; systems &nbsp; can &nbsp; record &nbsp; 
creation &nbsp; and &nbsp; last &nbsp; access &nbsp; time &nbsp; and &nbsp; not 
&nbsp; all &nbsp; file &nbsp; systems &nbsp; record &nbsp; them &nbsp; in &nbsp; 
the &nbsp; same &nbsp; manner. &nbsp; For &nbsp; example, &nbsp; on &nbsp; NT 
&nbsp; FAT, &nbsp; create &nbsp; time &nbsp; has &nbsp; a &nbsp; resolution 
&nbsp; of &nbsp; 10 &nbsp; milliseconds, &nbsp; write &nbsp; time &nbsp; has 
&nbsp; a &nbsp; resolution &nbsp; of &nbsp; 2 &nbsp; seconds, &nbsp; and &nbsp; 
access &nbsp; time &nbsp; has &nbsp; a &nbsp; resolution &nbsp; of &nbsp; 1 
&nbsp; day &nbsp; (really, &nbsp; the &nbsp; access &nbsp; date). &nbsp; On 
&nbsp; NTFS, &nbsp; access &nbsp; time &nbsp; has &nbsp; a &nbsp; resolution 
&nbsp; of &nbsp; 1 &nbsp; hour. &nbsp; For &nbsp; more &nbsp; information, 
&nbsp; see &nbsp; File &nbsp; Times.<A 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24248817>3 楼</A>clong320（clong320）<INPUT class=user5 title="五级用户 该版得分小于等于5000分，大于2000分" type=button></STRONG><SPAN>回复于 
2004-09-21 15:05:30 得分 <EM>100</EM></SPAN></H3>
<P>你用这个涵数保证能得到： &nbsp; <BR>&nbsp; // &nbsp; 
&gt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt; &nbsp; 读取文件创建、修改、访问时间 
&nbsp; &lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&lt; &nbsp; 
<BR>&nbsp; AnsiString &nbsp; __fastcall &nbsp; 
TForm_Face::GetFileLastAccessTime(AnsiString &nbsp; sFileName, &nbsp; byte 
&nbsp; uFlag) &nbsp; <BR>&nbsp; { &nbsp; <BR>&nbsp; &nbsp; union &nbsp; 
<BR>&nbsp; &nbsp; { &nbsp; <BR>&nbsp; &nbsp; &nbsp; LongRec &nbsp; lr; &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; DWord &nbsp; dft; &nbsp; <BR>&nbsp; &nbsp; 
}heightAndLow; &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; &nbsp; TWin32FindData 
&nbsp; ffd; &nbsp; <BR>&nbsp; &nbsp; &nbsp; FILETIME &nbsp; lft; &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; HANDLE &nbsp; h; &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
AnsiString &nbsp; fileDatetime &nbsp; = &nbsp; ""; &nbsp; <BR>&nbsp; &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; h &nbsp; = &nbsp; FindFirstFile(sFileName.c_str(), 
&nbsp; &amp;ffd); &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; &nbsp; if(h &nbsp; 
!= &nbsp; INVALID_HANDLE_VALUE) &nbsp; <BR>&nbsp; &nbsp; &nbsp; { &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; switch(uFlag) &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; { &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case 
&nbsp; 0: &nbsp; &nbsp; &nbsp; //&gt;&gt;&lt;&gt;&lt;&gt; &nbsp; 创建时间 &nbsp; 
&lt;&gt;&lt;&gt;&lt;&lt; &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
FileTimeToLocalFileTime(&amp;(ffd.ftCreationTime), &nbsp; &amp;lft); &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; break; &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case &nbsp; 
1: &nbsp; &nbsp; &nbsp; //&gt;&gt;&lt;&gt;&lt;&gt; &nbsp; 修改时间 &nbsp; 
&lt;&gt;&lt;&gt;&lt;&lt; &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
FileTimeToLocalFileTime(&amp;(ffd.ftLastWriteTime), &nbsp; &amp;lft); &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
break; &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case &nbsp; 2: 
&nbsp; &nbsp; &nbsp; //&gt;&gt;&lt;&gt;&lt;&gt; &nbsp; 访问时间 &nbsp; 
&lt;&gt;&lt;&gt;&lt;&lt; &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
FileTimeToLocalFileTime(&amp;(ffd.ftLastAccessTime), &nbsp; &amp;lft); &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
break &nbsp; ; &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } &nbsp; <BR>&nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; FileTimeToDosDateTime(&amp;lft, &nbsp; 
&amp;(heightAndLow.lr.Hi), &nbsp; &amp;(heightAndLow.lr.Lo)); &nbsp; <BR>&nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; fileDatetime &nbsp; = &nbsp; 
AnsiString(FormatDateTime("yyyy-mm-dd",FileDateToDateTime(heightAndLow.dft))); 
&nbsp; <BR>&nbsp; &nbsp; &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
FindClose(h); &nbsp; <BR>&nbsp; &nbsp; &nbsp; } &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
else &nbsp; fileDatetime &nbsp; = &nbsp; "" &nbsp; ; &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; return &nbsp; fileDatetime &nbsp; ; &nbsp; <BR>&nbsp; } &nbsp; <BR>&nbsp; 
<A href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24249544>4 楼</A>zxcdewq（zxcdewq）<INPUT class=star1 title="一星用户 该版得分小于等于10000分，大于5000分" type=button></STRONG><SPAN>回复于 
2004-09-21 15:23:26 得分 0 </SPAN></H3>
<P> <BR>&nbsp; &nbsp; &nbsp; SYSTEMTIME &nbsp; stUTC; &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; TDateTime &nbsp; DT; &nbsp; <BR>&nbsp; &nbsp; &nbsp; FILETIME &nbsp; 
ftCreate, &nbsp; ftLastAccess, &nbsp; ftLastWrite; &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; String &nbsp; filename=ParamStr(0); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
HANDLE &nbsp; hFile; &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; &nbsp; hFile= 
&nbsp; CreateFile( &nbsp; &nbsp; filename.c_str(), &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
GENERIC_READ, &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0, &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NULL, &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; OPEN_EXISTING,//文件是否存在？用OPEN_ALWAYS，不存在创建。 &nbsp; <BR>&nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; FILE_ATTRIBUTE_NORMAL, &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NULL); &nbsp; <BR>&nbsp; 
&nbsp; <BR>&nbsp; &nbsp; //第一个参数错了 &nbsp; 
GetFileTime(filename.c_str(),&amp;ftCreate,&amp;ftLastAccess,&amp;ftLastWrite);// 
&nbsp; <BR>&nbsp; 
GetFileTime(hFile,&amp;ftCreate,&amp;ftLastAccess,&amp;ftLastWrite); &nbsp; 
<BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; &nbsp; FileTimeToSystemTime( &nbsp; 
&amp;ftCreate, &nbsp; &amp;stUTC &nbsp; ); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
DT=SystemTimeToDateTime(stUTC); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
ShowMessage(DateTimeToStr(DT)); &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; FileTimeToSystemTime( &nbsp; &amp;ftLastAccess, &nbsp; &amp;stUTC &nbsp; 
); &nbsp; <BR>&nbsp; &nbsp; &nbsp; DT=SystemTimeToDateTime(stUTC); &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; ShowMessage(DateTimeToStr(DT)); &nbsp; <BR>&nbsp; 
&nbsp; <BR>&nbsp; &nbsp; &nbsp; FileTimeToSystemTime( &nbsp; &amp;ftLastWrite, 
&nbsp; &amp;stUTC &nbsp; ); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
DT=SystemTimeToDateTime(stUTC); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
ShowMessage(DateTimeToStr(DT)); &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; CloseHandle(hFile); &nbsp; <BR>&nbsp; <A 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24249948>5 楼</A>zxcdewq（zxcdewq）<INPUT class=star1 title="一星用户 该版得分小于等于10000分，大于5000分" type=button></STRONG><SPAN>回复于 
2004-09-21 15:33:27 得分 0 </SPAN></H3>
<P>FILETIME &nbsp; ftCreate, &nbsp; ftLastAccess, &nbsp; ftLastWrite, &nbsp; 
ftLocal; &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
FileTimeToLocalFileTime(&amp;ftWrite, &nbsp; &amp;ftLocal);//加一句 &nbsp; 
<BR>&nbsp; FileTimeToSystemTime( &nbsp; &amp;ftLocal, &nbsp; &amp;stUTC &nbsp; 
); &nbsp; <BR>&nbsp; DT=SystemTimeToDateTime(stUTC); &nbsp; <BR>&nbsp; 
ShowMessage(DateTimeToStr(DT));<A 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24264759>6 楼</A>MEFULEU（没有作不到，只有想不到）<INPUT class=star1 title="一星用户 该版得分小于等于10000分，大于5000分" type=button></STRONG><SPAN>回复于 
2004-09-22 08:40:04 得分 0 </SPAN></H3>
<P>to &nbsp; :zxcdewq(,) &nbsp; &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 我的文件名成为 
&nbsp; String &nbsp; filename=ParamStr(0); &nbsp; //当前运行的文件 &nbsp; <BR>&nbsp; 
&nbsp; <BR>&nbsp; 怎么会不存在????? &nbsp; <BR>&nbsp; <A 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24264873>7 楼</A>zxcdewq（zxcdewq）<INPUT class=star1 title="一星用户 该版得分小于等于10000分，大于5000分" type=button></STRONG><SPAN>回复于 
2004-09-22 08:43:46 得分 0 </SPAN></H3>
<P>呵，我怎么知道你ParamStr(0)是什么意思。 &nbsp; <BR>&nbsp; 
不过GetFileTime(filename.c_str(),&amp;ftCreate,&amp;ftLastAccess,&amp;ftLastWrite);第一个参数确实错了。应该是文件Handle 
&nbsp; <BR>&nbsp; <A 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24265129>8 楼</A>MEFULEU（没有作不到，只有想不到）<INPUT class=star1 title="一星用户 该版得分小于等于10000分，大于5000分" type=button></STRONG><SPAN>回复于 
2004-09-22 08:50:05 得分 0 </SPAN></H3>
<P>to &nbsp; :zxcdewq(,) &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 添加 &nbsp; 
<BR>&nbsp; FileTimeToLocalFileTime(&amp;ftWrite, &nbsp; &amp;ftLocal);//加一句 
&nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 也不行的;得到的文件时间如此格式:1601-1-1; &nbsp; <BR>&nbsp; 
&nbsp; <BR>&nbsp; 都不是2004-9-21 &nbsp; 此类! &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
clong320(clong320)的方法可行；但是好像没有小时分! &nbsp; <BR>&nbsp; <A 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24270426>9 楼</A>zxcdewq（zxcdewq）<INPUT class=star1 title="一星用户 该版得分小于等于10000分，大于5000分" type=button></STRONG><SPAN>回复于 
2004-09-22 10:39:00 得分 0 </SPAN></H3>
<P>MEFULEU(没有作不到，只有想不到) &nbsp; 兄弟。你怎么没看全啊。 &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
//*********************************************************************************** 
&nbsp; <BR>&nbsp; //第一个参数错了 &nbsp; 
GetFileTime(filename.c_str(),&amp;ftCreate,&amp;ftLastAccess,&amp;ftLastWrite);// 
&nbsp; <BR>&nbsp; 
//************************************************************************************ 
&nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
GetFileTime(hFile,&amp;ftCreate,&amp;ftLastAccess,&amp;ftLastWrite); &nbsp; 
<BR>&nbsp; &nbsp; <BR>&nbsp; 这个是关键错误. &nbsp; <BR>&nbsp; <A 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24270818>10 楼</A>zxcdewq（zxcdewq）<INPUT class=star1 title="一星用户 该版得分小于等于10000分，大于5000分" type=button></STRONG><SPAN>回复于 
2004-09-22 10:47:27 得分 0 </SPAN></H3>
<P>你把filename指定个存在文件的路径,运行下面的代码仔细看看,没问题. &nbsp; <BR>&nbsp; void &nbsp; 
__fastcall &nbsp; TForm1::Button1Click(TObject &nbsp; *Sender) &nbsp; <BR>&nbsp; 
{ &nbsp; <BR>&nbsp; &nbsp; &nbsp; <BR>&nbsp; &nbsp; &nbsp; SYSTEMTIME &nbsp; 
stUTC; &nbsp; <BR>&nbsp; &nbsp; &nbsp; TDateTime &nbsp; DT; &nbsp; <BR>&nbsp; 
&nbsp; &nbsp; FILETIME &nbsp; ftCreate, &nbsp; ftLastAccess, &nbsp; ftLastWrite, 
&nbsp; ftLocal; &nbsp; <BR>&nbsp; &nbsp; &nbsp; //String &nbsp; 
filename=ParamStr(0); &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; String &nbsp; 
filename="c:\\COMMAND.COM"; &nbsp; <BR>&nbsp; &nbsp; &nbsp; HANDLE &nbsp; hFile; 
&nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; &nbsp; hFile= &nbsp; CreateFile( 
&nbsp; &nbsp; filename.c_str(), &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GENERIC_READ, &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; 0, &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NULL, &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
OPEN_EXISTING, &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FILE_ATTRIBUTE_NORMAL, &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; NULL); &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
GetFileTime(hFile,&amp;ftCreate,&amp;ftLastAccess,&amp;ftLastWrite); &nbsp; 
<BR>&nbsp; &nbsp; <BR>&nbsp; FileTimeToLocalFileTime(&amp;ftLastWrite, &nbsp; 
&amp;ftLocal); &nbsp; <BR>&nbsp; FileTimeToSystemTime( &nbsp; &amp;ftLocal, 
&nbsp; &amp;stUTC &nbsp; ); &nbsp; <BR>&nbsp; DT=SystemTimeToDateTime(stUTC); 
&nbsp; <BR>&nbsp; ShowMessage(DateTimeToStr(DT)); &nbsp; <BR>&nbsp; &nbsp; 
<BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
FileTimeToLocalFileTime(&amp;ftLastAccess, &nbsp; &amp;ftLocal); &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; FileTimeToSystemTime( &nbsp; &amp;ftLocal, &nbsp; 
&amp;stUTC &nbsp; ); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
DT=SystemTimeToDateTime(stUTC); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
ShowMessage(DateTimeToStr(DT)); &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; FileTimeToLocalFileTime(&amp;ftLastWrite, &nbsp; &amp;ftLocal); &nbsp; 
<BR>&nbsp; &nbsp; &nbsp; FileTimeToSystemTime( &nbsp; &amp;ftLocal, &nbsp; 
&amp;stUTC &nbsp; ); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
DT=SystemTimeToDateTime(stUTC); &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
ShowMessage(DateTimeToStr(DT)); &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; CloseHandle(hFile); &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
}<A href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24272495>11 楼</A>toney2002（Toney）<INPUT class=user2 title="二级用户 该版得分小于等于500分，大于100分" type=button></STRONG><SPAN>回复于 
2004-09-22 11:25:07 得分 0 </SPAN></H3>
<P>mark..<A href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24277978>12 楼</A>MEFULEU（没有作不到，只有想不到）<INPUT class=star1 title="一星用户 该版得分小于等于10000分，大于5000分" type=button></STRONG><SPAN>回复于 
2004-09-22 13:38:18 得分 0 </SPAN></H3>
<P>ParamStr(0);为当前运行的执行程序全路径名称 &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
我就想得到当前运行的执行程序的创建时间；更改时间最后访问时间 &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
^O^因为我想做些坏事^O^ &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 使用你以上的代码一样只是显示1601-1-1 &nbsp; 
此类时间;这是不对的; &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
clong320(clong320) &nbsp; 的方法可行; &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
不过奇怪为什么我的代码不行呢? &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; <A 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24278190>13 楼</A>MEFULEU（没有作不到，只有想不到）<INPUT class=star1 title="一星用户 该版得分小于等于10000分，大于5000分" type=button></STRONG><SPAN>回复于 
2004-09-22 13:43:40 得分 0 </SPAN></H3>
<P>：zxcdewq(,) &nbsp; &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
没有运行的程序方法是可行的；但是如果是但前运行的程序就有问题 &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
另ParamStr(0)为系统自己已经定义了的变量；非我自己定义的变量! &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
你的程序运行位置为F:\\GG\MM\SS\DD.EXE; &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; 
那么ParamStr(0)即为这个路径; &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; <A 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24278223>14 楼</A>MEFULEU（没有作不到，只有想不到）<INPUT class=star1 title="一星用户 该版得分小于等于10000分，大于5000分" type=button></STRONG><SPAN>回复于 
2004-09-22 13:44:21 得分 0 </SPAN></H3>
<P>下午结贴!<A href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24280724>15 楼</A>zxcdewq（zxcdewq）<INPUT class=star1 title="一星用户 该版得分小于等于10000分，大于5000分" type=button></STRONG><SPAN>回复于 
2004-09-22 14:39:16 得分 <EM>100</EM></SPAN></H3>
<P>我刚试了一下String &nbsp; filename=ParamStr(0);在跟踪时时间不对，但运行exe程序没错误。 &nbsp; 
<BR>&nbsp; 改了下面代码，跟踪也没错误了。 &nbsp; <BR>&nbsp; &nbsp; <BR>&nbsp; hFile= &nbsp; 
CreateFile( &nbsp; &nbsp; filename.c_str(), &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
GENERIC_READ, &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FILE_SHARE_READ, &nbsp; <BR>&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
NULL, &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; OPEN_EXISTING, &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
FILE_ATTRIBUTE_NORMAL, &nbsp; <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NULL);<A 
href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H3><STRONG><A class=anchor name=r_24280957>16 楼</A>zxcdewq（zxcdewq）<INPUT class=star1 title="一星用户 该版得分小于等于10000分，大于5000分" type=button></STRONG><SPAN>回复于 
2004-09-22 14:45:33 得分 0 </SPAN></H3>
<P>问题是在CreateFile时独占访问，返回的hFile是FFFFFFFF，也就是失败，所以返回时间也是错误的。 &nbsp; <BR>&nbsp; 
判断一下比较好 &nbsp; &nbsp; &nbsp; <BR>&nbsp; if(hFile &nbsp; ==INVALID_HANDLE_VALUE) 
&nbsp; <BR>&nbsp; &nbsp; { &nbsp; <BR>&nbsp; // &nbsp; <BR>&nbsp; &nbsp; &nbsp; 
&nbsp; }<A href="http://topic.csdn.net/t/20040921/14/3394457.html#">Top</A></P>
<H4><STRONG>相关问题</STRONG></H4>
<DIV class=relation>
<UL>
  <LI><A href="http://topic.csdn.net/t/20050530/14/4045909.html" 
  rel=external>ArcGIS 9 捣蛋啊！</A> 
  <LI><A href="http://topic.csdn.net/t/20011114/09/369589.html" 
  rel=external>老外捣蛋不算，居然还看不起我们中国程序员！！！（公开信笺内容）</A> 
  <LI><A href="http://topic.csdn.net/t/20010620/11/164999.html" 
  rel=external>劳改犯严正声明:支持3B、蝈蝈的正确领导，声讨"捣蛋杂碎"及"跳梁小丑".坚决维护水园的安定团结.</A> 
</LI></UL></DIV></DIV></DIV>
<DIV id=sidebar>
<H3>关键词</H3>
<DIV>
<UL>
  <LI><A href="http://tag.csdn.net/tag/access/" rel=external>access</A> 
  <LI><A href="http://tag.csdn.net/tag/stutc/" rel=external>stutc</A> 
  <LI><A href="http://tag.csdn.net/tag/ftcreate/" rel=external>ftcreate</A> 
  <LI><A href="http://tag.csdn.net/tag/ftlastwrite/" 
  rel=external>ftlastwrite</A> 
  <LI><A href="http://tag.csdn.net/tag/ftlastaccess/" 
  rel=external>ftlastaccess</A> 
  <LI><A href="http://tag.csdn.net/tag/systemtimetodatetime/" 
  rel=external>systemtimetodatetime</A> 
  <LI><A href="http://tag.csdn.net/tag/filetimetosystemtime/" 
  rel=external>filetimetosystemtime</A> 
  <LI><A href="http://tag.csdn.net/tag/datetimetostr/" 
  rel=external>datetimetostr</A> 
  <LI><A href="http://tag.csdn.net/tag/dt/" rel=external>dt</A> 
  <LI><A href="http://tag.csdn.net/tag/showmessage/" 
  rel=external>showmessage</A> </LI></UL></DIV>
<H3>得分解答快速导航</H3>
<DIV>
<UL>
  <LI>帖主：<A 
  href="http://topic.csdn.net/t/20040921/14/3394457.html#Top">MEFULEU</A> 
  <LI><A 
  href="http://topic.csdn.net/t/20040921/14/3394457.html#r_24248817">clong320</A> 

  <LI><A 
  href="http://topic.csdn.net/t/20040921/14/3394457.html#r_24280724">zxcdewq</A> 
  </LI></UL></DIV>
<H3>相关链接</H3>
<DIV>
<UL>
  <LI><A href="http://blog.csdn.net/" target=_blank>CSDN Blog</A> 
  <LI><A href="http://dev.csdn.net/" target=_blank>技术文档</A> 
  <LI><A href="http://download.csdn.net/" target=_blank>代码下载</A> 
  <LI><A href="http://www.dearbook.com.cn/" target=_blank>第二书店</A> 
  <LI><A href="http://book.csdn.net/" target=_blank>读书频道</A> </LI></UL></DIV>
<H3>广告也精彩</H3>
<DIV>
<SCRIPT 
src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/show_ads.js" 
type=text/javascript></SCRIPT>
</DIV>
<H3>反馈</H3>
<DIV>请通过下述方式给我们反馈<BR><IMG alt=反馈 
src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/feedback.gif"></DIV></DIV>
<DIV class=clear></DIV></DIV>
<DIV style="TEXT-ALIGN: center">
<DIV id=pubfooter style="WIDTH: 770px">
<DIV id=Float21789 
style="Z-INDEX: 9; RIGHT: 3px; WIDTH: 190px; POSITION: absolute; TOP: 200px">
<CENTER>
<DIV id=AD21789 
style="FLOAT: none; WIDTH: 190px; HEIGHT: 90px; TEXT-ALIGN: center"><A 
style="PADDING-RIGHT: 10px; FLOAT: right; CURSOR: pointer" 
onclick="document.getElementById('Float21789').style.display='none';">x</A> <A 
href="http://g.csdn.net/5060169" target=_blank><IMG 
style="PADDING-RIGHT: 3px; WIDTH: 180px; HEIGHT: 50px" alt=提问 
src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/questions.gif"></A> 
</DIV></CENTER></DIV>
<SCRIPT language=JavaScript type=text/javascript>
    var csdnScrollTop=function(){
        return document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop;
        };
        function mymove21789(){
        document.getElementById("Float21789").style.top=csdnScrollTop()+100+'px';document.getElementById("Float21789").style.right=3+'px';setTimeout("mymove21789();",50);
        }
        mymove21789();
    </SCRIPT>
<!--
    <div id="Float21790" style="position: absolute; z-index: 9; width: 190px; top: 300px;
        right: 3px;">
        <center>
            <div id="AD21790" style="width: 190px; height: 90px; text-align: center; float: none;">
                <a href="http://vote.csdn.net/VoteList.aspx" target="_blank">
                    <img src="http://topic.csdn.net/t/img/hotvote.gif" alt="惹火投票。。火热进行中..." style="width: 180px; height: 30px;" /></a>
            </div>
        </center>
    </div>

    <script type="text/javascript" language="JavaScript">
        function mymove21790(){
        document.getElementById("Float21790").style.top=csdnScrollTop()+200+'px';document.getElementById("Float21790").style.right=3+'px';setTimeout("mymove21790();",50);
        }
        mymove21790();
    </script>
	-->
<SCRIPT src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/fb2.js" 
type=text/javascript></SCRIPT>
<LINK 
href="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/public_header_footer.css" 
type=text/css rel=stylesheet>
<DL>
  <DT>
  <DD><A href="http://www.csdn.net/help/intro.htm" target=_blank>网站简介</A>|<A 
  href="http://www.csdn.net/help/ads.htm" target=_blank>广告服务</A>|<A 
  href="http://www.csdn.net/help/vip.htm" target=_blank>VIP资费标准</A>|<A 
  href="http://www.csdn.net/help/bankaccount.htm" target=_blank>银行汇款帐号</A>|<A 
  href="http://www.csdn.net/help/sitemap.htm" target=_blank>网站地图</A>|<A 
  href="http://www.csdn.net/help/help.htm" target=_blank>帮助</A>|<A 
  href="http://www.csdn.net/help/contact.htm" target=_blank>联系方式</A>|<A 
  href="http://job.csdn.net/Jobs/f9c75c9f2ad14404a604669b757b9ed0/viewcompany.aspx" 
  target=_blank>诚聘英才</A>|<A href="http://www.csdn.net/help/english.htm" 
  target=_blank>English</A>|<A 
  onclick="window.location.href='mai'+'lto:'+'webm'+'aster@c'+'sdn.n'+'et?subject=Report To CSDN';return false" 
  href="http://topic.csdn.net/t/20040921/14/3394457.html#">问题报告</A> 
  <DD>北京创新乐知广告有限公司 版权所有,&nbsp;京&nbsp;ICP&nbsp;证&nbsp;070598&nbsp;号 
  <DD>世纪乐知(北京)网络技术有限公司 提供技术支持 
  <DD>CSDN网站24小时值班电话：13552009689 
  <DD class=small>Copyright © 2000-2009, CSDN.NET, All Rights Reserved 
  <DD><A 
  href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001032100010" 
  target=_blank><IMG alt=GongshangLogo 
  src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/gongshang_logos.gif"></A> 
  </DD></DL></DIV></DIV><!--google   Analytics begin -->
<SCRIPT 
src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/urchin.js" 
type=text/javascript>
        </SCRIPT>

<SCRIPT type=text/javascript>
_uacct = "UA-2688088-7";
urchinTracker();
        </SCRIPT>
<!--google   Analytics end -->
<SCRIPT 
src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/counter.js" 
type=text/javascript></SCRIPT>

<SCRIPT 
src="捣蛋的来了 C++ Builder - 基础类 - CSDN社区 community_csdn_net.files/clickeye.js"></SCRIPT>
<!-- Control Code/Caption.Yo-Focus-->
<SCRIPT language=JavaScript1.1>
var afp_keyword_BDA9CBA6_5658_A4DB_7E1D_1B781AF3DEE8 = "";
var afp_ad_count = 0;
var afp_keyword_lenth = 200;

var _YOYI_CONTROL_ = false;

if ((navigator.userAgent.indexOf("MSIE 7.0") != -1) && (navigator.userAgent.indexOf("Windows") != -1))
{
	afp_keyword_lenth = 273;
}

if (document.title != "")
	afp_keyword_BDA9CBA6_5658_A4DB_7E1D_1B781AF3DEE8 = document.title;
if (window.keywords)
	afp_keyword_BDA9CBA6_5658_A4DB_7E1D_1B781AF3DEE8 += window.keywords.content;
if (window.description)
	afp_keyword_BDA9CBA6_5658_A4DB_7E1D_1B781AF3DEE8 += window.description.content;

if (document.innerTEXT)
	afp_all_keyword_BDA9CBA6_5658_A4DB_7E1D_1B781AF3DEE8 = document.innerTEXT;

if(afp_keyword_BDA9CBA6_5658_A4DB_7E1D_1B781AF3DEE8.length > afp_keyword_lenth) 
{
	afp_keyword_BDA9CBA6_5658_A4DB_7E1D_1B781AF3DEE8 = afp_keyword_BDA9CBA6_5658_A4DB_7E1D_1B781AF3DEE8.substring(0,afp_keyword_lenth);
}

document.write("<scr"+"ipt src='http://server.yoyi.com.cn/afp/get/;pl_id=BDA9CBA6_5658_A4DB_7E1D_1B781AF3DEE8;tp=js;sk=0;ck=0;ext_key="+afp_keyword_BDA9CBA6_5658_A4DB_7E1D_1B781AF3DEE8+";u_id=afu;ex_id=;/?'></scr"+"ipt>");
</SCRIPT>
<!-- Control Code End/No.csdn--></DIV></DIV></DIV></DIV></BODY></HTML>
