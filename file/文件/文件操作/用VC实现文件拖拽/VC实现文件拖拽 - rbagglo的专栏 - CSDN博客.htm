<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0060)http://blog.csdn.net/rbagglo/archive/2009/02/01/3856669.aspx -->
<HTML xmlns="http://www.w3.org/1999/xhtml"><HEAD><TITLE>VC实现文件拖拽 - rbagglo的专栏 - CSDN博客</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<SCRIPT src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/jquery-1.2.3.pack.js" 
type=text/javascript></SCRIPT>

<SCRIPT src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/jquery.highlighter.js" 
type=text/javascript></SCRIPT>

<SCRIPT src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/highlighter.js" 
type=text/javascript></SCRIPT>

<SCRIPT src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/common.js" 
type=text/javascript></SCRIPT>
<LINK media=all href="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/Cogitation_1.css" 
type=text/css rel=stylesheet><LINK media=all 
href="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/csdn_favbykimi.css" type=text/css 
rel=stylesheet><LINK href="http://profile.csdn.net/rbagglo/picture/1.ico" 
rel="Shortcut Icon"><LINK title=RSS 
href="http://feeds.feedsky.com/csdn.net/rbagglo" type=application/rss+xml 
rel=alternate>
<META content="MSHTML 6.00.2900.5848" name=GENERATOR></HEAD>
<BODY id=defaultuser>
<DIV id=csdnblog_allwrap>
<DIV id=csdnblog_midwrap>
<DIV id=csdnblog_header>
<H1><A href="http://blog.csdn.net/rbagglo">rbagglo的专栏</A></H1>
<H2></H2>
<UL id=personalnav>
  <LI style="DISPLAY: none"><A id=a_login 
  href="http://passport.csdn.net/UserLogin.aspx">登录</A> </LI>
  <LI style="DISPLAY: none"><A id=a_register 
  href="http://passport.csdn.net/CSDNUserRegister.aspx">注册</A> </LI>
  <LI style="DISPLAY: none"><A id=a_welcome href="http://hi.csdn.net/" 
  target=_blank>欢迎</A> </LI>
  <LI style="DISPLAY: none"><A id=a_exit 
  href="http://writeblog.csdn.net/Signout.aspx">退出</A> </LI>
  <LI style="DISPLAY: none"><A id=a_myblog href="http://blog.csdn.net/">我的博客</A> 
  </LI>
  <LI style="DISPLAY: none"><A id=a_configure 
  href="http://writeblog.csdn.net/configure.aspx" target=_blank>配置</A> </LI>
  <LI style="DISPLAY: none"><A id=a_postedit 
  href="http://writeblog.csdn.net/PostEdit.aspx" target=_blank>写文章</A> </LI>
  <LI style="DISPLAY: none"><A id=a_postlist 
  href="http://writeblog.csdn.net/PostList.aspx" target=_blank>文章管理</A> </LI>
  <LI style="DISPLAY: none"><A id=a_bloghome href="http://blog.csdn.net/" 
  target=_blank>博客首页</A> </LI></UL>
<UL id=blogsearchsty>
  <LI><INPUT class=bolgsearch id=inputSearch> </LI>
  <LI class=selectsty><SELECT id=Search_ddlSearchScope 
  name=Search:ddlSearchScope> <OPTION value=all selected>全站</OPTION> <OPTION 
    value=rbagglo>当前博客</OPTION></SELECT> </LI>
  <LI><INPUT class=bolggobtn id=buttonSearch type=button value=搜索> </LI></UL>
<UL id=menu>
  <LI><A href="http://hi.csdn.net/rbagglo" target=_blank>空间</A> </LI>
  <LI><A class=on href="http://blog.csdn.net/rbagglo">博客</A> </LI>
  <LI><A href="http://hi.csdn.net/!s/friend/list/rbagglo" target=_blank>好友</A> 
  </LI>
  <LI><A href="http://hi.csdn.net/!s/album/list/rbagglo" target=_blank>相册</A> 
  </LI>
  <LI><A class=last href="http://hi.csdn.net/!s/wall/to/rbagglo" 
  target=_blank>留言</A> </LI></UL></DIV>
<SCRIPT type=text/javascript>
	var CurrentUserName = 'rbagglo';
</SCRIPT>

<DIV id=csdnblog_sidebar>
<DIV class=gutter>
<DIV class=aboutauthor>
<DL>
  <DT>用户操作 
  <DD class=middle><A href="http://hi.csdn.net/!s/wall/to/rbagglo" 
  target=_blank>[留言]</A>&nbsp; <A href="http://hi.csdn.net/!s/msg/to/rbagglo" 
  target=_blank>[发消息]</A>&nbsp; <A 
  href="http://hi.csdn.net/!s/friend/add/rbagglo" target=_blank>[加为好友]</A>&nbsp; 
  <SPAN id=userInfo></SPAN><SPAN id=SubscriptionList>
  <DT>订阅我的博客 
  <DD><A href="http://feeds.feedsky.com/csdn.net/rbagglo"><IMG alt=XML聚合 
  src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/gif.gif" border=0> </A>&nbsp;&nbsp; 
  <A href="http://feeds.feedsky.com/csdn.net/rbagglo" target=_blank><IMG 
  alt=FeedSky src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/feedsky.gif" border=0> 
  </A>
  <DD><A 
  href="http://www.xianguo.com/subscribe.php?url=http://feeds.feedsky.com/csdn.net/rbagglo" 
  target=_blank><IMG alt=订阅到鲜果 
  src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/rss_xianguo.jpg" border=0> </A>
  <DD><A 
  href="http://fusion.google.com/add?feedurl=http://feeds.feedsky.com/csdn.net/rbagglo" 
  target=_blank><IMG alt=订阅到Google 
  src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/rss_google.gif" border=0> </A>
  <DD><A 
  href="http://www.zhuaxia.com/add_channel.php?url=http://feeds.feedsky.com/csdn.net/rbagglo" 
  target=_blank><IMG alt=订阅到抓虾 
  src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/rss_zhuaxia.gif" border=0> 
  </A></SPAN>
  <DT><SPAN class=floatright style="DISPLAY: none"><A class=a_edit 
  href="http://writeblog.csdn.net/configure.aspx" 
  target=_blank>[编辑]</A></SPAN>rbagglo的公告 
  <DD>
  <DT><SPAN class=floatright style="DISPLAY: none"><A class=a_edit 
  href="http://writeblog.csdn.net/EditCategories.aspx?catID=1" 
  target=_blank>[编辑]</A></SPAN>文章分类 
  <DD>
  <DIV class=publiclist_sidebar>
  <UL>
    <LI><A href="http://blog.csdn.net/rbagglo/category/363725.aspx/rss"><IMG 
    alt=(RSS) src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/rss.gif"></A><A 
    href="http://blog.csdn.net/rbagglo/category/363725.aspx">C#</A>
    <LI><A href="http://blog.csdn.net/rbagglo/category/363723.aspx/rss"><IMG 
    alt=(RSS) src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/rss.gif"></A><A 
    title="C++ Primer学习心得" 
    href="http://blog.csdn.net/rbagglo/category/363723.aspx">C++</A>
    <LI><A href="http://blog.csdn.net/rbagglo/category/373959.aspx/rss"><IMG 
    alt=(RSS) src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/rss.gif"></A><A 
    title=积累实践中所遇问题和解决的方法 
    href="http://blog.csdn.net/rbagglo/category/373959.aspx">VC</A>
    <LI><A href="http://blog.csdn.net/rbagglo/category/363724.aspx/rss"><IMG 
    alt=(RSS) src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/rss.gif"></A><A 
    title=算法与数据结构 
    href="http://blog.csdn.net/rbagglo/category/363724.aspx">算法与数据结构</A>
    <LI><A href="http://blog.csdn.net/rbagglo/category/493846.aspx/rss"><IMG 
    alt=(RSS) src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/rss.gif"></A><A title=杂文 
    href="http://blog.csdn.net/rbagglo/category/493846.aspx">杂文</A></LI></UL></DIV>
  <DT>存档 
  <DD>
  <DIV class=publiclist_sidebar>
  <UL>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2009/06.aspx">2009年06月(2)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2009/05.aspx">2009年05月(1)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2009/03.aspx">2009年03月(2)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2009/02.aspx">2009年02月(3)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2009/01.aspx">2009年01月(2)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2008/12.aspx">2008年12月(1)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2008/11.aspx">2008年11月(1)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2008/09.aspx">2008年09月(2)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2008/07.aspx">2008年07月(1)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2008/06.aspx">2008年06月(1)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2008/05.aspx">2008年05月(4)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2008/04.aspx">2008年04月(1)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2008/03.aspx">2008年03月(2)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2008/02.aspx">2008年02月(12)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2008/01.aspx">2008年01月(2)</A>
    <LI><A 
    href="http://blog.csdn.net/rbagglo/archive/2007/10.aspx">2007年10月(1)</A></LI></UL></DIV></DD></DL></DIV></DIV></DIV>
<DIV id=csdnblog_content>
<DIV class=gutter>
<DIV class=default_contents>
<DIV class=user_article>
<SCRIPT src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/LoadFeedbackCount.js" 
type=text/javascript></SCRIPT>

<H1 class=title_txt>VC实现文件拖拽 <CITE class=fav_csdnstylebykimi><A 
class=fav_csdnstylebykimi title=收藏到我的网摘中，并分享给我的朋友 
href="javascript:d=document;t=d.selection?(d.selection.type!='None'?d.selection.createRange().text:''):(d.getSelection?d.getSelection():'');void(saveit=window.open('http://wz.csdn.net/storeit.aspx?t='+escape(d.title)+'&amp;u='+escape(d.location.href)+'&amp;c='+escape(t),'saveit','scrollbars=no,width=590,height=300,left=75,top=20,status=no,resizable=yes'));saveit.focus();">收藏</A> 
</CITE></H1>
<DIV class=blogstory>
<SCRIPT type=text/javascript>
						document.body.oncopy = function() {
							if (window.clipboardData) {
								setTimeout(function() {
									var text = clipboardData.getData("text"); 
									if (text && text.length>300) {
										text = text + "\r\n\n本文来自CSDN博客，转载请标明出处：" + location.href;
										clipboardData.setData("text", text); 
									}
								}, 100);
							}
						}
					</SCRIPT>

<SCRIPT type=text/javascript>function StorePage(){d=document;t=d.selection?(d.selection.type!='None'?d.selection.createRange().text:''):(d.getSelection?d.getSelection():'');void(keyit=window.open('http://www.365key.com/storeit.aspx?t='+escape(d.title)+'&u='+escape(d.location.href)+'&c='+escape(t),'keyit','scrollbars=no,width=475,height=575,left=75,top=20,status=no,resizable=yes'));keyit.focus();}</SCRIPT>

<P>&nbsp; 
使用过QQ的人都知道，只要把文件拖拽到消息框中就可以传送文件了。那么这种功能是如何实现的呢？其实很简单，只需要响应一个WM_DROPFILES消息就可以了。<BR>&nbsp;&nbsp;&nbsp; 
在基于对话框的程序中，默认是没有这个消息的，按下Ctrl+W，弹出类向导对话框，选择Class Info标签，在Message 
fileter下拉列表中选择Window，然后再点击Message 
Maps标签，就出现WM_DROPFILES消息了，添加该消息的响应函数：<BR>&nbsp;&nbsp;&nbsp;&nbsp; void 
CTestDlg::OnDropFiles(HDROP hDropInfo) <BR>&nbsp;&nbsp;&nbsp;&nbsp; 
{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
// TODO: Add your message handler code here and/or call 
default<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
CDialog::OnDropFiles(hDropInfo);<BR>&nbsp;&nbsp;&nbsp;&nbsp; 
}<BR>&nbsp;&nbsp;&nbsp;&nbsp; 
另外，要让对话框能够接受文件拖拽，还需要设置对话框属性。在对话框上点击右键，选择Properties-&gt;Extended Styles，点选Accept 
files选项即可。</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp; 要获得当前拖拽的文件的完整文件名（含路径），只需要一个函数：<BR><SPAN 
style="COLOR: #000080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UINT 
DragQueryFile(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
HDROP 
hDrop,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
UINT 
iFile,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
LPTSTR 
lpszFile,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
UINT cch<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
);</SPAN><BR>&nbsp;&nbsp;&nbsp;&nbsp; 
参数解释：<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hDrop: 
HDROP标识符，即响应函数中的hDropInfo参数<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; iFile: 
待查询的文件索引号，从0开始。可以同时拖拽多个文件，因此就需要一个索引号来进行区分。如果该参数为0xFFFFFFFF，则该函数返回拖拽的文件的个数<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
lpszFile: 用于存放文件名的缓冲区首地址<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cch: 
缓冲区长度<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 返回值：文件名长度</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp; 另外，查询完成后需要释放系统分配内存，使用下面这个函数：<BR><SPAN 
style="COLOR: #000080">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VOID 
DragFinish(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
HDROP hDrop<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );</SPAN></P>
<P>&nbsp;&nbsp;&nbsp; 
下面是一个完整的代码示例，将文件拖拽到对话框上后会弹出消息框显示完整文件名：<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
void CTestDlg::OnDropFiles(HDROP hDropInfo) 
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
// TODO: Add your message handler code here and/or call 
default<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
UINT 
count;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
char filePath[200];</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
count = DragQueryFile(hDropInfo, 0xFFFFFFFF, NULL, 
0);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
if(count)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
for(UINT i=0; i&lt;count; 
i++)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
int pathLen = DragQueryFile(hDropInfo, i, filePath, 
sizeof(filePath));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
AfxMessageBox(filePath);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
}</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
DragFinish(hDropInfo);<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
CDialog::OnDropFiles(hDropInfo);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
}</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp; 同理，如果只有把文件拖拽到特定的控件中时才有响应，只需要把该控件的Accept 
files样式勾选上即可。</P>
<P class="right articalinfo">发表于 @ 2009年02月01日　13:16:00&nbsp;| <A id=a_comment 
title=评论 
href="http://blog.csdn.net/rbagglo/archive/2009/02/01/3856669.aspx#FeedBack">评论( 
<SPAN id=FeedbackCount_3856669>loading...</SPAN>
<SCRIPT type=text/javascript>
								AddFeedbackCountStack("3856669")
							</SCRIPT>
 ) </A>| <SPAN style="DISPLAY: none"><A class=a_edit title=编辑 
href="http://writeblog.csdn.net/PostEdit.aspx?entryId=3856669">编辑</A>|</SPAN> <A 
href="mailto:webmaster@csdn.net?subject=Article Report!!!&amp;body=Author:rbaggloURL:http://blog.csdn.net/ArticleContent.aspx?UserName=rbagglo&amp;Entryid=3856669">举报</A>| 
<CITE class=fav_csdnstylebykimi><A class=fav_csdnstylebykimi 
title=收藏到我的网摘中，并分享给我的朋友 
href="javascript:d=document;t=d.selection?(d.selection.type!='None'?d.selection.createRange().text:''):(d.getSelection?d.getSelection():'');void(saveit=window.open('http://wz.csdn.net/storeit.aspx?t='+escape(d.title)+'&amp;u='+escape(d.location.href)+'&amp;c='+escape(t),'saveit','scrollbars=no,width=590,height=300,left=75,top=20,status=no,resizable=yes'));saveit.focus();">收藏</A> 
</CITE></P><SPAN id=Post.ascx_ViewPost_PreviousAndNextEntriesDown>
<H3 class=pagego><A 
href="http://blog.csdn.net/rbagglo/archive/2009/01/09/3741651.aspx">旧一篇:获取文件图标</A>&nbsp;|&nbsp;<A 
href="http://blog.csdn.net/rbagglo/archive/2009/02/17/3898853.aspx">新一篇:RichEdit控件 
SDK 参考手册</A></H3></SPAN></DIV></DIV><A name=FeedBack></A>
<DIV class=commentslist>
<SCRIPT type=text/javascript>
					var CurrentEntryId = '3856669';
				</SCRIPT>

<SCRIPT src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/feedback.js" 
type=text/javascript></SCRIPT>

<DIV id=commentslist></DIV></DIV>
<DIV class=spacecommment></DIV>
<SCRIPT type=text/javascript>
			LoadFeedbackCount();
			document.write("<img src='http://counter.csdn.net/pv.aspx?id=24' border=0 width=0 height=0>");
			</SCRIPT>
</DIV></DIV></DIV>
<DIV id=pubfooter>
<DL>
  <DT>
  <DD>Copyright © rbagglo 
  <DD>Powered by CSDN Blog </DD></DL></DIV>
<SCRIPT src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/counter.js" 
type=text/javascript></SCRIPT>

<SCRIPT src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/ga.js" 
type=text/javascript></SCRIPT>

<SCRIPT type=text/javascript>
try {
	var pageTracker = _gat._getTracker("UA-2688088-9");
	pageTracker._trackPageview();
} catch (err) { }
</SCRIPT>
</DIV></DIV><IMG height=0 src="VC实现文件拖拽 - rbagglo的专栏 - CSDN博客.files/count.htm" 
width=0> </BODY></HTML>
