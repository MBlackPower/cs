From: <ÓÉ Microsoft Internet Explorer 5 ±£´æ>
Subject: =?gb2312?B?zL2y4ldpbmRvd3MySy9YUC8yMDAzsb67+s+1zbPQxc+i?=
Date: Wed, 19 May 2004 21:39:30 +0800
MIME-Version: 1.0
Content-Type: text/html;
	charset="gb2312"
Content-Transfer-Encoding: quoted-printable
Content-Location: http://www.fz5fz.org/Archives/13.htm
X-MimeOLE: Produced By Microsoft MimeOLE V5.00.2615.200

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>=CC=BD=B2=E2Windows2K/XP/2003=B1=BE=BB=FA=CF=B5=CD=B3=D0=
=C5=CF=A2</TITLE>
<META content=3D"text/html; charset=3Dgb2312" http-equiv=3DContent-Type>
<STYLE type=3Dtext/css>A:link {
	COLOR: #0000ff; TEXT-DECORATION: none
}
A:visited {
	COLOR: #0000ff; TEXT-DECORATION: none
}
A:hover {
	COLOR: #ff0000; TEXT-DECORATION: underline
}
INPUT {
	FONT-SIZE: 9pt
}
SELECT {
	FONT-SIZE: 9pt
}
TD {
	FONT-SIZE: 9pt
}
.a {
	FONT-SIZE: 10.5pt
}
.botton {
	BACKGROUND-COLOR: #ffffff; BORDER-BOTTOM: #999999 1px dotted; =
BORDER-LEFT: #999999 1px dotted; BORDER-RIGHT: #999999 1px dotted; =
BORDER-TOP: #999999 1px dotted
}
.title {
	FONT-SIZE: 12px
}
.search {
	FONT-SIZE: 9pt
}
</STYLE>

<META content=3D"MSHTML 5.00.2614.3500" name=3DGENERATOR></HEAD>
<BODY bgColor=3D#ffffff>
<TABLE align=3Dcenter border=3D0 cellPadding=3D0 cellSpacing=3D0 =
width=3D"90%">
  <TBODY>
  <TR>
    <TD width=3D"100%"><BR><BR>
      =
<CENTER><B>=CC=BD=B2=E2Windows2K/XP/2003=B1=BE=BB=FA=CF=B5=CD=B3=D0=C5=CF=
=A2</B></CENTER><BR><BR>=CC=BD=B2=E2Windows2K/XP/2003=B1=BE=BB=FA=CF=B5=CD=
=B3=D0=C5=CF=A2<BR><BR>Author:=20
      TOo2y [=D4=AD=B4=B4]<BR>E-Mail: TOo2y@safechina.net<BR>HomePage: =
www.safechina.net=20
      &amp;&amp; fz5fz.yeah.net<BR>Date:=20
      05-10-2003<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;Native =
API=C4=CBWindows=D3=C3=BB=A7=C4=A3=CA=BD=D6=D0=CE=AA=C9=CF=B2=E3Win32=20
      =
API=CC=E1=B9=A9=BD=D3=BF=DA=B5=C4=B1=BE=BB=FA=CF=B5=CD=B3=B7=FE=CE=F1=A1=A3=
=C6=BD=B3=A3=CE=D2=C3=C7=D7=DC=CA=C7=B5=F7=D3=C3MS=CE=AA=CE=D2=C3=C7=CC=E1=
=B9=A9=B5=C4=B9=AB=D3=C3=B5=C4Win32=20
      =
API=BA=AF=CA=FD=C0=B4=CA=B5=CF=D6=C0=B4=CA=B5=CF=D6=CE=D2=C3=C7=CF=B5=CD=B3=
=B5=C4=B9=A6=C4=DC=A1=A3=A3=A8PS=A3=BA=C7=B0=B2=BB=BE=C3=A3=AC=C5=BC=D0=B4=
=C1=CB=D2=BB=B8=F6Windows=C8=CE=CE=F1=B9=DC=C0=ED=C6=F7=A3=AC=D6=A7=B3=D6=
=B6=D4=D7=C0=C3=E6=A3=AC=BD=F8=B3=CC/=CF=DF=B3=CC=A3=AC=CF=B5=CD=B3=D0=D4=
=C4=DC=A3=AC=B4=C5=C5=CC=A3=AC=BB=B7=BE=B3=B1=E4=C1=BF=A3=AC=CA=C2=BC=FE=C8=
=D5=D6=BE=A3=AC=CD=F8=C2=E7=A3=AC=C9=E8=B1=B8=C7=FD=B6=AF=A3=ACWin32=B7=FE=
=CE=F1=A3=AC=B9=B2=CF=ED=A3=AC=D3=C3=BB=A7=A3=AC=CF=B5=CD=B3=BC=B0=B9=D8=BB=
=FA=B5=C8=D0=C5=CF=A2=B5=C4=CC=BD=B2=E2=BA=CD=BF=D8=D6=C6=A3=AC=CD=EA=C8=AB=
=BB=F9=D3=DAWin32=20
      =
API=A3=AC=B4=F3=BC=D2=BF=C9=D2=D4=B5=BD=CE=D2=C3=C7=B5=C4=D6=F7=D2=B3=CF=C2=
=D4=D8=A3=A9=A1=A3=BD=F1=CC=EC=CE=D2=C3=C7=D2=AA=CC=B8=B5=C4=CA=C7=C8=E7=BA=
=CE=CD=A8=B9=FD=B1=BE=BB=FA=CF=B5=CD=B3=B7=FE=CE=F1(Native=20
      =
API=A3=A9=C0=B4=CC=BD=B2=E2=B1=BE=BB=FA=CF=B5=CD=B3=D0=C5=CF=A2=A1=A3=B5=B1=
=C8=BB=A3=AC=CE=A2=C8=ED=C3=BB=D3=D0=CE=AA=CE=D2=C3=C7=CC=E1=B9=A9=B9=D8=D3=
=DA=B1=BE=BB=FA=CF=B5=CD=B3=B7=FE=CE=F1=B5=C4=CE=C4=B5=B5(Undocumented)=A3=
=AC=D2=B2=BE=CD=CA=C7=B2=BB=BB=E1=CE=AA=B6=D4=CB=FC=B5=C4=CA=B9=D3=C3=CC=E1=
=B9=A9=C8=CE=BA=CE=B5=C4=B1=A3=D6=A4=A3=AC=CB=F9=D2=D4=CE=D2=C3=C7=B2=BB=CC=
=E1=B3=AB=CA=B9=D3=C3Native=20
      =
API=C0=B4=BF=AA=B7=A2=C8=ED=BC=FE=A1=A3=B2=BB=B9=FD=D4=DA=CC=D8=CA=E2=C7=E9=
=BF=F6=CF=C2=A3=AC=B1=BE=BB=FA=CF=B5=CD=B3=B7=FE=CE=F1=C8=B4=CE=AA=CE=D2=C3=
=C7=CC=E1=B9=A9=C1=CB=CD=A8=CF=F2=A1=B0=C3=D8=C3=DC=A1=B1=B5=C4=BD=DD=BE=B6=
=A1=A3=B1=BE=CE=C4=CC=E1=B5=BD=B5=C4=D0=C5=CF=A2=BD=F6=D4=DAWindows2000/X=
P/2003=C9=CF=B2=E2=CA=D4=B9=FD=A1=A3<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;=BD=F1=
=CC=EC=A3=AC=CE=D2=C3=C7=D6=F7=D2=AA=CC=D6=C2=DB=B5=C4=CA=C7=D2=BB=B8=F6=BA=
=AF=CA=FDNtQuerySystemInformation(ZwQuerySystemInformation)=A1=A3=B5=B1=C8=
=BB=A3=AC=C4=E3=B2=BB=D2=AA=D0=A1=BF=B4=D5=E2=C3=B4=D2=BB=B8=F6=BA=AF=CA=FD=
=A3=AC=CB=FC=C8=B4=CE=AA=CE=D2=C3=C7=CC=E1=B9=A9=C1=CB=B7=E1=B8=BB=B5=C4=CF=
=B5=CD=B3=D0=C5=CF=A2=A3=AC=CD=AC=CA=B1=BB=B9=B0=FC=C0=A8=B6=D4=C4=B3=D0=A9=
=D0=C5=CF=A2=B5=C4=BF=D8=D6=C6=BA=CD=C9=E8=D6=C3=A1=A3=D2=D4=CF=C2=CA=C7=D5=
=E2=B8=F6=BA=AF=CA=FD=B5=C4=D4=AD=D0=CD=A3=BA<BR><BR>typedef=20
      NTSTATUS (__stdcall=20
      =
*NTQUERYSYSTEMINFORMATION)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      (IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SYSTEM_INFORMATION_CLASS=20
      SystemInformationClass,<BR>IN=20
      =
OUT&nbsp;&nbsp;PVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System=
Information,<BR>IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SystemInformationLength,<BR>OUT&nbsp;&nb=
sp;&nbsp;&nbsp;=20
      =
PULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      ReturnLength&nbsp;&nbsp;OPTIONAL);<BR>NTQUERYSYSTEMINFORMATION=20
      =
NtQuerySystemInformation;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;=B4=D3=D6=D0=BF=C9=
=D2=D4=BF=B4=B5=BD=A3=ACSystemInformationClass=CA=C7=D2=BB=B8=F6=C0=E0=D0=
=CD=D0=C5=CF=A2=A3=AC=CB=FC=B4=F3=B8=C5=CC=E1=B9=A9=C1=CB50=D3=E0=D6=D6=D0=
=C5=CF=A2=A3=AC=D2=B2=BE=CD=CA=C7=CE=D2=C3=C7=BF=C9=D2=D4=CD=A8=B9=FD=D5=E2=
=B8=F6=BA=AF=CA=FD=B6=D4=B4=F3=D4=BC50=B6=E0=D6=D6=B5=C4=CF=B5=CD=B3=D0=C5=
=CF=A2=BD=F8=D0=D0=CC=BD=B2=E2=BB=F2=C9=E8=D6=C3=A1=A3SystemInformation=CA=
=C7=D2=BB=B8=F6LPVOID=D0=CD=B5=C4=D6=B8=D5=EB=A3=AC=CB=FC=CE=AA=CE=D2=C3=C7=
=CC=E1=B9=A9=D0=E8=D2=AA=BB=F1=B5=C3=B5=C4=D0=C5=CF=A2=A3=AC=BB=F2=CA=C7=CE=
=D2=C3=C7=D0=E8=D2=AA=C9=E8=D6=C3=B5=C4=CF=B5=CD=B3=D0=C5=CF=A2=A1=A3Syst=
emInformationLength=CA=C7SystemInformation=B5=C4=B3=A4=B6=C8=A3=AC=CB=FC=B8=
=F9=BE=DD=CC=BD=B2=E2=B5=C4=D0=C5=CF=A2=C0=E0=D0=CD=C0=B4=BE=F6=B6=A8=A1=A3=
=D6=C1=D3=DAReturnLength=D4=F2=CA=C7=CF=B5=CD=B3=B7=B5=BB=D8=B5=C4=D0=E8=D2=
=AA=B5=C4=B3=A4=B6=C8=A3=AC=CD=A8=B3=A3=BF=C9=D2=D4=C9=E8=D6=C3=CE=AA=BF=D5=
=D6=B8=D5=EB(NULL)=A1=A3<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;=CA=D7=CF=C8=A3=AC=
=CE=D2=C3=C7=C0=B4=BF=B4=BF=B4=B4=F3=BC=D2=B1=C8=BD=CF=CA=EC=CF=A4=B5=C4=CF=
=B5=CD=B3=BD=F8=B3=CC/=CF=DF=B3=CC=CF=E0=B9=D8=B5=C4=D0=C5=CF=A2=A1=A3=D5=
=E2=B8=F6=CC=E2=C4=BF=D4=DA=CD=F8=C9=CF=D2=D1=BE=AD=CC=D6=C2=DB=C1=CBN=B6=
=E0=C4=EA=C1=CB=A3=AC=CB=F9=D2=D4=CE=D2=BE=CD=B2=BB=D4=DA=C0=CF=C9=FA=B3=A3=
=CC=B8=C1=CB=A3=AC=BA=C7=BA=C7=A1=A3=C4=C7=C3=B4=BE=CD=CC=E1=B3=F6=D5=E2=B8=
=F6=BD=E1=B9=B9=C0=E0=D0=CD=B5=C4=B6=A8=D2=E5=A3=BA<BR><BR>typedef=20
      struct=20
      =
_SYSTEM_PROCESSES<BR>{<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;NextEntryDelta;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;//=B9=B9=B3=C9=BD=E1=B9=B9=D0=F2=C1=D0=B5=C4=C6=AB=D2=
=C6=C1=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;ThreadCount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;=20
      =
//=CF=DF=B3=CC=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;Reserved1[6];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
<BR>LARGE_INTEGER&nbsp;&nbsp;CreateTime;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=B4=B4=BD=A8=CA=B1=BC=
=E4=A3=BB<BR>LARGE_INTEGER&nbsp;&nbsp;UserTime;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D3=
=C3=BB=A7=C4=A3=CA=BD(Ring=20
      =
3)=B5=C4CPU=CA=B1=BC=E4=A3=BB<BR>LARGE_INTEGER&nbsp;&nbsp;KernelTime;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;//=C4=DA=BA=CB=C4=A3=CA=BD(Ring=20
      0)=B5=C4CPU=CA=B1=BC=E4=A3=BB<BR>UNICODE_STRING=20
      =
ProcessName;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;=20
      =
//=BD=F8=B3=CC=C3=FB=B3=C6=A3=BB<BR>KPRIORITY&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;BasePriority;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;//=BD=F8=B3=CC=D3=C5=CF=C8=C8=A8=A3=BB<BR>ULONG&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessId;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;=20
      =
//=BD=F8=B3=CC=B1=EA=CA=B6=B7=FB=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InheritedFromProcessId;&nbsp;&nbsp;//=B8=
=B8=BD=F8=B3=CC=B5=C4=B1=EA=CA=B6=B7=FB=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HandleCount;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=BE=E4=B1=FA=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;Reserved2[2];<BR>VM_COUNTERS&nbsp;&nbsp;&nbsp=
;&nbsp;VmCounters;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D0=E9=C4=E2=B4=E6=B4=A2=C6=F7=B5=C4=BD=E1=
=B9=B9=A3=AC=BC=FB=CF=C2=A3=BB<BR>IO_COUNTERS&nbsp;&nbsp;&nbsp;&nbsp;IoCo=
unters;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;//IO=BC=C6=CA=FD=BD=E1=B9=B9=A3=AC=BC=FB=CF=C2=A3=BB<BR=
>SYSTEM_THREADS=20
      =
Threads[1];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;//=BD=F8=B3=CC=CF=E0=B9=D8=CF=DF=B3=CC=B5=C4=BD=E1=B9=
=B9=CA=FD=D7=E9=A3=AC=BC=FB=CF=C2=A3=BB<BR>}SYSTEM_PROCESSES,*PSYSTEM_PRO=
CESSES;<BR><BR>typedef=20
      struct _SYSTEM_THREADS<BR>{<BR>LARGE_INTEGER=20
      =
KernelTime;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;=20
      =
//CPU=C4=DA=BA=CB=C4=A3=CA=BD=CA=B9=D3=C3=CA=B1=BC=E4=A3=BB<BR>LARGE_INTE=
GER=20
      =
UserTime;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//CPU=D3=C3=BB=A7=C4=A3=CA=BD=CA=B9=D3=C3=CA=B1=BC=E4=A3=BB<BR>LARGE_INTE=
GER=20
      =
CreateTime;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;=20
      =
//=CF=DF=B3=CC=B4=B4=BD=A8=CA=B1=BC=E4=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
WaitTime;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=B5=C8=B4=FD=CA=B1=BC=E4=A3=BB<BR>PVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;=20
      =
StartAddress;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;=20
      =
//=CF=DF=B3=CC=BF=AA=CA=BC=B5=C4=D0=E9=C4=E2=B5=D8=D6=B7=A3=BB<BR>CLIENT_=
ID&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
ClientId;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=CF=DF=B3=CC=B1=EA=CA=B6=B7=FB=A3=BB<BR>KPRIORITY&nbsp;&nbsp;&nbsp;&nbs=
p;=20
      =
Priority;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=CF=DF=B3=CC=D3=C5=CF=C8=BC=B6=A3=BB<BR>KPRIORITY&nbsp;&nbsp;&nbsp;&nbs=
p;=20
      =
BasePriority;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;=20
      =
//=BB=F9=B1=BE=D3=C5=CF=C8=BC=B6=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;=20
      ContextSwitchCount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=BB=B7=BE=B3=C7=D0=BB=BB=CA=FD=C4=BF=A3=BB<BR>THREAD_STATE&nbsp;&nbsp;S=
tate;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=B5=B1=C7=B0=D7=B4=CC=
=AC=A3=BB<BR>KWAIT_REASON&nbsp;&nbsp;WaitReason;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=B5=C8=B4=FD=D4=AD=D2=F2=A3=BB<BR>}SYSTEM_THREADS,*PSYSTEM_THREADS;<BR>=
<BR>typedef struct=20
      _VM_COUNTERS<BR>{<BR>ULONG=20
      =
PeakVirtualSize;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D0=E9=C4=E2=B4=E6=B4=
=A2=B7=E5=D6=B5=B4=F3=D0=A1=A3=BB<BR>ULONG=20
      =
VirtualSize;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=
=D0=E9=C4=E2=B4=E6=B4=A2=B4=F3=D0=A1=A3=BB<BR>ULONG=20
      =
PageFaultCount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      //=D2=B3=B9=CA=D5=CF=CA=FD=C4=BF=A3=BB<BR>ULONG=20
      =
PeakWorkingSetSize;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      //=B9=A4=D7=F7=BC=AF=B7=E5=D6=B5=B4=F3=D0=A1=A3=BB<BR>ULONG=20
      =
WorkingSetSize;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      //=B9=A4=D7=F7=BC=AF=B4=F3=D0=A1=A3=BB<BR>ULONG=20
      =
QuotaPeakPagedPoolUsage;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;//=B7=D6=D2=B3=B3=D8=CA=B9=D3=C3=C5=E4=B6=EE=B7=E5=D6=B5=A3=BB=
<BR>ULONG=20
      =
QuotaPagedPoolUsage;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=B7=D6=D2=B3=B3=D8=CA=B9=D3=C3=C5=E4=B6=EE=
=A3=BB<BR>ULONG=20
      QuotaPeakNonPagedPoolUsage;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=B7=C7=B7=D6=D2=B3=B3=D8=CA=B9=D3=C3=C5=E4=B6=EE=B7=E5=D6=B5=A3=BB<BR>U=
LONG=20
      =
QuotaNonPagedPoolUsage;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;=20
      //=B7=C7=B7=D6=D2=B3=B3=D8=CA=B9=D3=C3=C5=E4=B6=EE=A3=BB<BR>ULONG=20
      =
PagefileUsage;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D2=B3=CE=C4=
=BC=FE=CA=B9=D3=C3=C7=E9=BF=F6=A3=BB<BR>ULONG=20
      =
PeakPagefileUsage;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D2=B3=CE=C4=BC=FE=CA=B9=D3=C3=
=B7=E5=D6=B5=A3=BB<BR>}VM_COUNTERS,*PVM_COUNTERS;<BR><BR>typedef=20
      struct _IO_COUNTERS<BR>{<BR>LARGE_INTEGER=20
      ReadOperationCount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      //I/O=B6=C1=B2=D9=D7=F7=CA=FD=C4=BF=A3=BB<BR>LARGE_INTEGER=20
      =
WriteOperationCount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//I/O=D0=B4=B2=D9=
=D7=F7=CA=FD=C4=BF=A3=BB<BR>LARGE_INTEGER=20
      =
OtherOperationCount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//I/O=C6=E4=CB=FB=
=B2=D9=D7=F7=CA=FD=C4=BF=A3=BB<BR>LARGE_INTEGER=20
      =
ReadTransferCount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//I/O=B6=
=C1=CA=FD=BE=DD=CA=FD=C4=BF=A3=BB<BR>LARGE_INTEGER=20
      WriteTransferCount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      //I/O=D0=B4=CA=FD=BE=DD=CA=FD=C4=BF=A3=BB<BR>LARGE_INTEGER=20
      OtherTransferCount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//I/O=C6=E4=CB=FB=B2=D9=D7=F7=CA=FD=BE=DD=CA=FD=C4=BF=A3=BB<BR>}IO_COUNTE=
RS,*PIO_COUNTERS;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;=D2=D4=C9=CF=D5=E2=D0=A9=
=D0=C5=CF=A2=D3=A6=B8=C3=CA=C7=B1=C8=BD=CF=C8=AB=C3=E6=B5=C4=C1=CB=A3=AC=D4=
=DAWin32=20
      =
API=C0=EF=CE=AA=CE=D2=C3=C7=CC=E1=B9=A9=C1=CBPSAPI(=BD=F8=B3=CC=D7=B4=CC=AC=
)=BA=CDToolHelp32=D5=E2=C1=BD=D6=D6=CC=BD=B2=E2=CF=B5=CD=B3=BD=F8=B3=CC/=CF=
=DF=B3=CC=D0=C5=CF=A2=B5=C4=B7=BD=CA=BD=A3=AC=D4=DAWindows2K/XP/2003=B6=BC=
=D6=A7=B3=D6=CB=FC=C3=C7=A1=A3<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;=CF=D6=D4=DA=
=A3=AC=CE=D2=C3=C7=C0=B4=BF=B4=BF=B4=CF=B5=CD=B3=B5=C4=D0=D4=C4=DC=D0=C5=CF=
=A2=A3=AC=D0=D4=C4=DC=BD=E1=B9=B9SYSTEM_PERFORMANCE_INFORMATION=CE=AA=CE=D2=
=C3=C7=CC=E1=B9=A9=C1=CB70=D3=E0=D6=D6=CF=B5=CD=B3=D0=D4=C4=DC=B7=BD=C3=E6=
=B5=C4=D0=C5=CF=A2=A3=AC=D5=E6=CA=C7=CC=AB=B7=E1=B8=BB=C1=CB=A3=AC=C7=EB=C2=
=FD=C2=FD=CC=E5=BB=E1~<BR><BR>typedef=20
      struct=20
      =
_SYSTEM_PERFORMANCE_INFORMATION<BR>{<BR>LARGE_INTEGER&nbsp;&nbsp;IdleTime=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//CPU=BF=D5=CF=D0=CA=B1=BC=
=E4=A3=BB<BR>LARGE_INTEGER&nbsp;&nbsp;ReadTransferCount;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//I/O=B6=C1=B2=D9=D7=F7=CA=FD=C4=BF=A3=BB<BR>LARGE_INTEGER&nbsp;&nbsp;Wri=
teTransferCount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;//I/O=D0=B4=B2=D9=D7=F7=CA=FD=C4=BF=A3=BB<BR>LARGE_INTEGER&nbsp;&nbsp;=
OtherTransferCount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;//I/O=C6=E4=CB=FB=B2=D9=D7=F7=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadOperationCount;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//I/O=B6=C1=CA=FD=BE=
=DD=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;WriteOperationCount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;=20
      =
//I/O=D0=B4=CA=FD=BE=DD=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OtherOperationCount;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//I/O=C6=E4=CB=FB=B2=D9=D7=F7=CA=FD=BE=DD=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AvailablePages;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;//=BF=C9=BB=F1=B5=C3=B5=C4=D2=B3=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TotalCommittedPages=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=D7=DC=B9=B2=CC=E1=BD=BB=D2=B3=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TotalCommitLimit;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D2=D1=CC=
=E1=BD=BB=D2=B3=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PeakCommitment;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D2=B3=CC=E1=BD=BB=
=B7=E5=D6=B5=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;PageFaults;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D2=B3=B9=CA=
=D5=CF=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;WriteCopyFaults;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//Copy-On-Write=B9=CA=D5=CF=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TransitionFaults;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=C8=ED=D2=B3=B9=
=CA=D5=CF=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;Reserved1;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DemandZeroFaults;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D0=E8=C7=F30=B9=CA=D5=CF=CA=
=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;PagesRead;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=B6=C1=D2=B3=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;PageReadIos;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=B6=C1=D2=B3I/O=B2=D9=D7=F7=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reserved2[2];<BR>ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PagefilePagesWritten;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D2=D1=D0=B4=D2=B3=CE=C4=BC=FE=
=D2=B3=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;PagefilePageWriteIos;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;//=D2=D1=D0=B4=D2=B3=CE=C4=BC=FE=B2=D9=D7=F7=CA=FD=A3=BB<BR>ULO=
NG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MappedFileP=
agesWritten;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D2=D1=D0=B4=D3=B3=C9=E4=
=CE=C4=BC=FE=D2=B3=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;MappedFileWriteIos;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D2=D1=D0=B4=D3=B3=C9=E4=CE=C4=BC=FE=B2=
=D9=D7=F7=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;PagedPoolUsage;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=B7=D6=D2=B3=B3=D8=CA=B9=D3=C3=
=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;NonPagedPoolUsage;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;=20
      =
//=B7=C7=B7=D6=D2=B3=B3=D8=CA=B9=D3=C3=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PagedPoolAllocs;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=B7=D6=D2=B3=B3=D8=B7=D6=C5=E4=C7=E9=BF=F6=A3=BB<BR>ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PagedPoolFrees;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/=
/=B7=D6=D2=B3=B3=D8=CA=CD=B7=C5=C7=E9=BF=F6=A3=BB<BR>ULONG&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NonPagedPoolAllocs;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=B7=C7=B7=D6=D2=B3=B3=
=D8=B7=D6=C5=E4=C7=E9=BF=F6=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NonPagedPoolFress;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=B7=C7=B7=D6=D2=B3=B3=D8=CA=CD=B7=C5=C7=E9=BF=F6=A3=BB<BR>ULONG&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TotalFreeSystemPtes;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=CF=B5=CD=B3=D2=B3=B1=ED=CF=EE=CA=CD=B7=C5=D7=DC=CA=FD=A3=BB<BR>ULONG&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SystemCodePage;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;//=B2=D9=D7=F7=CF=B5=CD=B3=B4=FA=C2=EB=D2=B3=CA=FD=A3=BB<BR>UL=
ONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TotalSyste=
mDriverPages;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=BF=C9=B7=D6=D2=B3=C7=FD=
=B6=AF=B3=CC=D0=F2=D2=B3=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TotalSystemCodePages;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;//=B2=D9=D7=F7=CF=B5=CD=B3=B4=FA=C2=EB=D2=B3=D7=
=DC=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;SmallNonPagedLookasideListAllocateHits;=20
      =
//=D0=A1=B7=C7=B7=D6=D2=B3=B2=E0=CA=D3=C1=D0=B1=ED=B7=D6=C5=E4=B4=CE=CA=FD=
=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;SmallPagedLookasideListAllocateHits;&nbsp;&nbsp;&nbsp;&nbsp;//=D0=A1=B7=
=D6=D2=B3=B2=E0=CA=D3=C1=D0=B1=ED=B7=D6=C5=E4=B4=CE=CA=FD=A3=BB<BR>ULONG&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reserved3;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MmSy=
stemCachePage;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;//=CF=B5=CD=B3=BB=BA=B4=E6=D2=B3=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PagedPoolPage;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=B7=D6=
=D2=B3=B3=D8=D2=B3=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;SystemDriverPage;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=BF=C9=B7=D6=D2=B3=C7=FD=B6=AF=D2=B3=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FastReadNoWait;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=D2=EC=B2=BD=BF=EC=CB=D9=B6=C1=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FastReadWait;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=CD=AC=B2=BD=BF=EC=CB=D9=B6=C1=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FastReadResourceMiss;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=BF=EC=CB=D9=B6=C1=D7=CA=D4=B4=B3=E5=CD=BB=CA=FD=A3=BB<BR>ULONG&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FastReadNotPossible;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=BF=EC=CB=D9=B6=C1=CA=A7=
=B0=DC=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;FastMdlReadNoWait;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;//=D2=EC=B2=BDMDL=BF=EC=CB=D9=B6=C1=CA=FD=C4=BF=A3=BB<=
BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FastM=
dlReadWait;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;//=CD=AC=B2=BDMDL=BF=EC=CB=D9=B6=C1=CA=FD=C4=BF=A3=BB<BR>ULONG&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FastMdlReadRes=
ourceMiss;&nbsp;&nbsp;&nbsp;&nbsp;//MDL=B6=C1=D7=CA=D4=B4=B3=E5=CD=BB=CA=FD=
=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;FastMdlReadNotPossible;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//MDL=B6=C1=CA=A7=B0=DC=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapDataNoWait;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D2=EC=B2=BD=D3=
=B3=C9=E4=CA=FD=BE=DD=B4=CE=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapDataWait;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=CD=
=AC=B2=BD=D3=B3=C9=E4=CA=FD=BE=DD=B4=CE=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapDataNoWaitMiss;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D2=EC=B2=BD=D3=B3=C9=
=E4=CA=FD=BE=DD=B3=E5=CD=BB=B4=CE=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapDataWaitMiss;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=CD=AC=B2=BD=D3=
=B3=C9=E4=CA=FD=BE=DD=B3=E5=CD=BB=B4=CE=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PinMappedDataCount;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=C7=A3=D6=C6=D3=B3=C9=E4=CA=FD=BE=DD=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PinReadNoWait;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;//=C7=A3=D6=C6=D2=EC=B2=BD=B6=C1=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PinReadWait;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;//=C7=A3=D6=C6=CD=AC=B2=BD=B6=C1=CA=FD=C4=BF=A3=BB<BR>ULONG&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PinReadNoWaitMi=
ss;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=C7=A3=D6=
=C6=D2=EC=B2=BD=B6=C1=B3=E5=CD=BB=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PinReadWaitMiss;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=C7=A3=D6=
=C6=CD=AC=B2=BD=B6=C1=B3=E5=CD=BB=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CopyReadNoWait;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=D2=EC=B2=BD=BF=BD=B1=B4=B6=C1=B4=CE=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CopyReadWait;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=CD=AC=B2=BD=BF=BD=B1=B4=B6=C1=B4=CE=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CopyReadNoWaitMiss;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=D2=EC=B2=BD=BF=BD=B1=B4=B6=C1=B9=CA=D5=CF=B4=CE=CA=FD=A3=BB<BR>ULONG&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CopyReadWaitMis=
s;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=CD=AC=B2=BD=BF=BD=B1=B4=B6=C1=B9=CA=D5=CF=B4=CE=CA=FD=A3=BB<BR>ULONG&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MdlReadNoWait;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;//=D2=EC=B2=BDMDL=B6=C1=B4=CE=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MdlReadWait;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;//=CD=AC=B2=BDMDL=B6=C1=B4=CE=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MdlReadNoWaitMiss;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D2=EC=B2=BDMDL=B6=C1=
=B9=CA=D5=CF=B4=CE=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;MdlReadWaitMiss;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=CD=AC=B2=BDMDL=B6=C1=B9=CA=D5=
=CF=B4=CE=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;ReadAheadIos;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=CF=F2=C7=B0=B6=C1=B2=D9=D7=F7=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LazyWriteIos;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//LAZY=D0=B4=B2=D9=D7=F7=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LazyWritePages;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//LAZY=D0=B4=D2=B3=CE=C4=BC=FE=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataFlushes;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;//=BB=BA=B4=E6=CB=A2=D0=C2=B4=CE=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataPages;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;//=BB=BA=B4=E6=CB=A2=D0=C2=D2=B3=CA=FD=A3=BB<BR>ULONG&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ContextSwitches=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
//=BB=B7=BE=B3=C7=D0=BB=BB=CA=FD=C4=BF=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FirstLevelTbFills;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=B5=DA=D2=BB=B2=E3=BB=BA=B3=
=E5=C7=F8=CC=EE=B3=E4=B4=CE=CA=FD=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecondLevelTbFills;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=B5=DA=B6=FE=B2=E3=BB=BA=B3=E5=C7=F8=CC=EE=B3=E4=B4=CE=CA=FD=A3=BB<BR>U=
LONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SystemCal=
l;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=CF=B5=CD=B3=B5=F7=D3=C3=B4=CE=CA=FD=A3=BB<BR>}SYSTEM_PERFORMANCE_INFOR=
MATION,*PSYSTEM_PERFORMANCE_INFORMATION;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;=CF=
=D6=D4=DA=BF=B4=B5=BD=B5=C4=CA=C7=BD=E1=B9=B9SYSTEM_PROCESSOR_TIMES=CC=E1=
=B9=A9=B5=C4=CF=B5=CD=B3=B4=A6=C0=ED=C6=F7=B5=C4=CA=B9=D3=C3=C7=E9=BF=F6=A3=
=AC=B0=FC=C0=A8=B8=F7=D6=D6=C7=E9=BF=F6=CF=C2=B5=C4=CA=B9=D3=C3=CA=B1=BC=E4=
=BC=B0=D6=D0=B6=CF=CA=FD=C4=BF=A3=BA<BR><BR>typedef=20
      struct __SYSTEM_PROCESSOR_TIMES<BR>{<BR>LARGE_INTEGER=20
      =
IdleTime;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;=20
      //=BF=D5=CF=D0=CA=B1=BC=E4=A3=BB<BR>LARGE_INTEGER=20
      =
KernelTime;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;=20
      //=C4=DA=BA=CB=C4=A3=CA=BD=CA=B1=BC=E4=A3=BB<BR>LARGE_INTEGER=20
      =
UserTime;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;=20
      //=D3=C3=BB=A7=C4=A3=CA=BD=CA=B1=BC=E4=A3=BB<BR>LARGE_INTEGER=20
      =
DpcTime;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=D1=D3=B3=D9=B9=FD=B3=CC=B5=F7=D3=C3=CA=B1=
=BC=E4=A3=BB<BR>LARGE_INTEGER=20
      =
InterruptTime;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;//=D6=D0=B6=CF=CA=B1=BC=E4=A3=BB<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;=20
      InterruptCount;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=D6=D0=B6=CF=B4=CE=CA=FD=A3=BB<BR>}SYSTEM_PROCESSOR_TIMES,*PSYSTEM_PROC=
ESSOR_TIMES;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;=D2=B3=CE=C4=BC=FE=B5=C4=CA=B9=
=D3=C3=C7=E9=BF=F6=A3=ACSYSTEM_PAGEFILE_INFORMATION=CC=E1=B9=A9=C1=CB=CB=F9=
=D0=E8=B5=C4=CF=E0=B9=D8=D0=C5=CF=A2=A3=BA<BR><BR>typedef=20
      struct _SYSTEM_PAGEFILE_INFORMATION<BR>{<BR>ULONG=20
      =
NetxEntryOffset;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=CF=C2=D2=BB=B8=F6=BD=E1=B9=B9=B5=
=C4=C6=AB=D2=C6=C1=BF=A3=BB<BR>ULONG=20
      =
CurrentSize;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=B5=B1=C7=B0=
=D2=B3=CE=C4=BC=FE=B4=F3=D0=A1=A3=BB<BR>ULONG=20
      =
TotalUsed;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=B5=
=B1=C7=B0=CA=B9=D3=C3=B5=C4=D2=B3=CE=C4=BC=FE=CA=FD=A3=BB<BR>ULONG=20
      =
PeakUsed;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
//=B5=B1=C7=B0=CA=B9=D3=C3=B5=C4=D2=B3=CE=C4=BC=FE=B7=E5=D6=B5=CA=FD=A3=BB=
<BR>UNICODE_STRING=20
      =
FileName;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;//=D2=B3=CE=C4=BC=FE=B5=C4=CE=C4=BC=FE=C3=FB=B3=C6=A3=
=BB<BR>}SYSTEM_PAGEFILE_INFORMATION,*PSYSTEM_PAGEFILE_INFORMATION;<BR><BR=
>&nbsp;&nbsp;&nbsp;&nbsp;=CF=B5=CD=B3=B8=DF=CB=D9=BB=BA=B4=E6=B5=C4=CA=B9=
=D3=C3=C7=E9=BF=F6=B2=CE=BC=FB=BD=E1=B9=B9SYSTEM_CACHE_INFORMATION=CC=E1=B9=
=A9=B5=C4=D0=C5=CF=A2=A3=BA<BR><BR>typedef=20
      struct _SYSTEM_CACHE_INFORMATION<BR>{<BR>ULONG=20
      =
SystemCacheWsSize;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=B8=DF=CB=D9=BB=BA=B4=E6=B4=F3=D0=A1=A3=BB=
<BR>ULONG=20
      =
SystemCacheWsPeakSize;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;//=B8=DF=CB=D9=BB=BA=B4=E6=B7=E5=D6=B5=B4=F3=D0=A1=A3=BB<BR>ULON=
G=20
      =
SystemCacheWsFaults;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;//=B8=DF=CB=D9=BB=BA=B4=E6=D2=B3=B9=CA=D5=CF=CA=FD=C4=BF=
=A3=BB<BR>ULONG=20
      =
SystemCacheWsMinimum;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;=20
      =
//=B8=DF=CB=D9=BB=BA=B4=E6=D7=EE=D0=A1=D2=B3=B4=F3=D0=A1=A3=BB<BR>ULONG=20
      =
SystemCacheWsMaximum;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;=20
      =
//=B8=DF=CB=D9=BB=BA=B4=E6=D7=EE=B4=F3=D2=B3=B4=F3=D0=A1=A3=BB<BR>ULONG=20
      =
TransitionSharedPages;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;//=B9=B2=CF=ED=D2=B3=CA=FD=C4=BF=A3=BB<BR>ULONG=20
      =
TransitionSharedPagesPeak;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//=B9=B2=CF=
=ED=D2=B3=B7=E5=D6=B5=CA=FD=C4=BF=A3=BB<BR>ULONG=20
      =
Reserved[2];<BR>}SYSTEM_CACHE_INFORMATION,*PSYSTEM_CACHE_INFORMATION;<BR>=
<BR>=B8=BD=C2=BC=A3=BA(=CB=F9=D3=D0=CD=EA=D5=FB=D4=B4=B4=FA=C2=EB=A3=AC=C4=
=FA=BF=C9=D2=D4=B5=BD=CE=D2=C3=C7FZ5FZ=B5=C4=D6=F7=D2=B3=CF=C2=D4=D8)=A1=A3=
<BR><BR>1.T-PMList=B5=C4=CD=B7=CE=C4=BC=FE=D4=B4=B4=FA=C2=EB=A3=BA<BR><BR=
>#ifndef=20
      T_PMLIST_H<BR>#define T_PMLIST_H<BR><BR>#include=20
      &lt;windows.h&gt;<BR>#include &lt;stdio.h&gt;<BR><BR>#define=20
      =
NT_PROCESSTHREAD_INFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x05=
<BR>#define=20
      =
MAX_INFO_BUF_LEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;=20
      0x500000<BR>#define=20
      =
STATUS_SUCCESS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;=20
      ((NTSTATUS)0x00000000L)<BR>#define=20
      =
STATUS_INFO_LENGTH_MISMATCH&nbsp;&nbsp;((NTSTATUS)0xC0000004L)<BR><BR>typ=
edef=20
      LONG NTSTATUS;<BR><BR>typedef struct=20
      =
_LSA_UNICODE_STRING<BR>{<BR>USHORT&nbsp;&nbsp;Length;<BR>USHORT&nbsp;&nbs=
p;MaximumLength;<BR>PWSTR&nbsp;&nbsp;=20
      Buffer;<BR>}LSA_UNICODE_STRING,*PLSA_UNICODE_STRING;<BR>typedef=20
      LSA_UNICODE_STRING UNICODE_STRING, =
*PUNICODE_STRING;<BR><BR>typedef struct=20
      _CLIENT_ID<BR>{<BR>HANDLE UniqueProcess;<BR>HANDLE=20
      UniqueThread;<BR>}CLIENT_ID;<BR>typedef CLIENT_ID=20
      *PCLIENT_ID;<BR><BR>typedef LONG KPRIORITY;<BR><BR>typedef struct=20
      _VM_COUNTERS<BR>{<BR>ULONG PeakVirtualSize;<BR>ULONG =
VirtualSize;<BR>ULONG=20
      PageFaultCount;<BR>ULONG PeakWorkingSetSize;<BR>ULONG=20
      WorkingSetSize;<BR>ULONG QuotaPeakPagedPoolUsage;<BR>ULONG=20
      QuotaPagedPoolUsage;<BR>ULONG QuotaPeakNonPagedPoolUsage;<BR>ULONG =

      QuotaNonPagedPoolUsage;<BR>ULONG PagefileUsage;<BR>ULONG=20
      PeakPagefileUsage;<BR>}VM_COUNTERS,*PVM_COUNTERS;<BR><BR>typedef =
struct=20
      _IO_COUNTERS<BR>{<BR>LARGE_INTEGER =
ReadOperationCount;<BR>LARGE_INTEGER=20
      WriteOperationCount;<BR>LARGE_INTEGER=20
      OtherOperationCount;<BR>LARGE_INTEGER =
ReadTransferCount;<BR>LARGE_INTEGER=20
      WriteTransferCount;<BR>LARGE_INTEGER=20
      OtherTransferCount;<BR>}IO_COUNTERS,*PIO_COUNTERS;<BR><BR>typedef =
enum=20
      =
_THREAD_STATE<BR>{<BR>StateInitialized,<BR>StateReady,<BR>StateRunning,<B=
R>StateStandby,<BR>StateTerminated,<BR>StateWait,<BR>StateTransition,<BR>=
StateUnknown<BR>}THREAD_STATE;<BR><BR>typedef=20
      enum=20
      =
_KWAIT_REASON<BR>{<BR>Executive,<BR>FreePage,<BR>PageIn,<BR>PoolAllocatio=
n,<BR>DelayExecution,<BR>Suspended,<BR>UserRequest,<BR>WrExecutive,<BR>Wr=
FreePage,<BR>WrPageIn,<BR>WrPoolAllocation,<BR>WrDelayExecution,<BR>WrSus=
pended,<BR>WrUserRequest,<BR>WrEventPair,<BR>WrQueue,<BR>WrLpcReceive,<BR=
>WrLpcReply,<BR>WrVertualMemory,<BR>WrPageOut,<BR>WrRendezvous,<BR>Spare2=
,<BR>Spare3,<BR>Spare4,<BR>Spare5,<BR>Spare6,<BR>WrKernel<BR>}KWAIT_REASO=
N;<BR><BR>typedef=20
      struct _SYSTEM_THREADS<BR>{<BR>LARGE_INTEGER =
KernelTime;<BR>LARGE_INTEGER=20
      UserTime;<BR>LARGE_INTEGER=20
      =
CreateTime;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      WaitTime;<BR>PVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =

      StartAddress;<BR>CLIENT_ID&nbsp;&nbsp;&nbsp;&nbsp;=20
      ClientId;<BR>KPRIORITY&nbsp;&nbsp;&nbsp;&nbsp;=20
      Priority;<BR>KPRIORITY&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
BasePriority;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
ContextSwitchCount;<BR>THREAD_STATE&nbsp;&nbsp;State;<BR>KWAIT_REASON&nbs=
p;&nbsp;WaitReason;<BR>}SYSTEM_THREADS,*PSYSTEM_THREADS;<BR><BR>typedef=20
      struct=20
      =
_SYSTEM_PROCESSES<BR>{<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;NextEntryDelta;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ThreadCount;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reserved1[6];<BR>LARGE_INTEGER&nbsp;=
&nbsp;CreateTime;<BR>LARGE_INTEGER&nbsp;&nbsp;UserTime;<BR>LARGE_INTEGER&=
nbsp;&nbsp;KernelTime;<BR>UNICODE_STRING=20
      =
ProcessName;<BR>KPRIORITY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BasePriority=
;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pro=
cessId;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;InheritedFromProcessId;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;HandleCount;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reserved2[2];<BR>VM_COUNTERS&nbsp;&nbsp;&nb=
sp;&nbsp;VmCounters;<BR>IO_COUNTERS&nbsp;&nbsp;&nbsp;&nbsp;IoCounters;<BR=
>SYSTEM_THREADS=20
      =
Threads[1];<BR>}SYSTEM_PROCESSES,*PSYSTEM_PROCESSES;<BR><BR>typedef=20
      DWORD&nbsp;&nbsp;&nbsp;&nbsp;SYSTEM_INFORMATION_CLASS;<BR>typedef =
NTSTATUS=20
      (__stdcall=20
      =
*NTQUERYSYSTEMINFORMATION)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      (IN&nbsp;&nbsp;&nbsp;&nbsp; SYSTEM_INFORMATION_CLASS,<BR>IN OUT=20
      PVOID,<BR>IN&nbsp;&nbsp;&nbsp;&nbsp;=20
      ULONG,<BR>OUT&nbsp;&nbsp;&nbsp;&nbsp;PULONG=20
      OPTIONAL);<BR>NTQUERYSYSTEMINFORMATION=20
      NtQuerySystemInformation;<BR><BR>DWORD=20
      =
EnumProcess()<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
PSYSTEM_PROCESSES&nbsp;&nbsp;pSystemProc;<BR>HMODULE&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hNtDll&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =3D=20
      =
NULL;<BR>LPVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;=20
      lpSystemInfo&nbsp;&nbsp; =3D=20
      =
NULL;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;dwNumberBytes&nbsp;&nbsp;=3D=20
      =
MAX_INFO_BUF_LEN;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwTotalProcess=20
      =3D=20
      =
0;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;dwReturnLength;<BR>NTSTATUS&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      Status;=20
      =
<BR>LONGLONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =

      llTempTime;<BR><BR>__try<BR>{<BR>hNtDll =3D=20
      =
LoadLibrary("NtDll.dll");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;=20
      if(hNtDll =3D=3D=20
      =
NULL)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;printf("LoadLibrary=20
      Error:=20
      =
%d\n",GetLastError());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      __leave;<BR>}<BR><BR>NtQuerySystemInformation =3D=20
      =
(NTQUERYSYSTEMINFORMATION)GetProcAddress(hNtDll,"NtQuerySystemInformation=
");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(NtQ=
uerySystemInformation=20
      =3D=3D=20
      =
NULL)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      printf("GetProcAddress for NtQuerySystemInformation Error:=20
      =
%d\n",GetLastError());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      __leave;<BR>}<BR><BR>lpSystemInfo =3D=20
      (LPVOID)malloc(dwNumberBytes);<BR>Status =3D=20
      =
NtQuerySystemInformation(NT_PROCESSTHREAD_INFO,<BR>&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      lpSystemInfo,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      dwNumberBytes,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      &amp;dwReturnLength);<BR>if(Status =3D=3D=20
      =
STATUS_INFO_LENGTH_MISMATCH)<BR>{<BR>printf("STATUS_INFO_LENGTH_MISMATCH\=
n");<BR>__leave;<BR>}<BR>else=20
      if(Status !=3D =
STATUS_SUCCESS)<BR>{<BR>printf("NtQuerySystemInformation=20
      Error:=20
      =
%d\n",GetLastError());<BR>__leave;<BR>}<BR><BR>printf("%-20s%6s%7s%8s%6s%=
7s%7s%13s\n","ProcessName","PID","PPID","WsSize","Prio.","Thread","Handle=
","CPU=20
      =
Time");<BR>printf("------------------------------------------------------=
--------------------\n");<BR>pSystemProc=20
      =3D =
(PSYSTEM_PROCESSES)lpSystemInfo;<BR>while(pSystemProc-&gt;NextEntryDelta =

      !=3D 0)<BR>{<BR>if(pSystemProc-&gt;ProcessId !=3D=20
      =
0)<BR>{<BR>wprintf(L"%-20s",pSystemProc-&gt;ProcessName.Buffer);<BR>}<BR>=
else<BR>{<BR>wprintf(L"%-20s",L"System=20
      Idle=20
      =
Process");<BR>}<BR>printf("%6d",pSystemProc-&gt;ProcessId);<BR>printf("%7=
d",pSystemProc-&gt;InheritedFromProcessId);<BR>printf("%7dK",pSystemProc-=
&gt;VmCounters.WorkingSetSize/1024);<BR>printf("%6d",pSystemProc-&gt;Base=
Priority);<BR>printf("%7d",pSystemProc-&gt;ThreadCount);<BR>printf("%7d",=
pSystemProc-&gt;HandleCount);<BR>llTempTime&nbsp;&nbsp;=3D=20
      pSystemProc-&gt;KernelTime.QuadPart +=20
      pSystemProc-&gt;UserTime.QuadPart;<BR>llTempTime /=3D=20
      10000;<BR>printf("%3d:",llTempTime/(60*60*1000));<BR>llTempTime =
%=3D=20
      60*60*1000;<BR>printf("%.2d:",llTempTime/(60*1000));<BR>llTempTime =
%=3D=20
      60*1000;<BR>printf("%.2d.",llTempTime/1000);<BR>llTempTime %=3D=20
      =
1000;<BR>printf("%.3d",llTempTime);<BR><BR>printf("\n");<BR>dwTotalProces=
s=20
      ++;<BR>pSystemProc =3D (PSYSTEM_PROCESSES)((char *)pSystemProc +=20
      =
pSystemProc-&gt;NextEntryDelta);<BR>}<BR>printf("------------------------=
--------------------------------------------------\n");<BR>printf("\nTota=
l=20
      %d Process(es) !\n\n",dwTotalProcess);<BR>printf("PID\t =3D=3D&gt; =
Process=20
      Identification\n");<BR>printf("PPID\t =3D=3D&gt; Parent Process=20
      Identification\n");<BR>printf("WsSize\t =3D=3D&gt; Working Set=20
      Size\n");<BR>printf("Prio.\t =3D=3D&gt; Base =
Priority\n");<BR>printf("Thread\t=20
      =3D=3D&gt; Thread Count\n");<BR>printf("Handle\t =3D=3D&gt; Handle =

      Count\n");<BR>printf("CPU Time =3D=3D&gt; Processor=20
      Time\n");<BR>}<BR>__finally<BR>{<BR>if(lpSystemInfo !=3D=20
      NULL)<BR>{<BR>free(lpSystemInfo);<BR>}<BR>if(hNtDll !=3D=20
      =
NULL)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FreeLibrary(hNtDll);<BR>}<BR>}<BR><B=
R>return=20
      0;<BR>}<BR><BR>DWORD SpeciProcess(DWORD=20
      dwPID)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
PSYSTEM_PROCESSES&nbsp;&nbsp;pSystemProc&nbsp;&nbsp;&nbsp;&nbsp;=3D=20
      =
NULL;<BR>PSYSTEM_THREADS&nbsp;&nbsp;&nbsp;&nbsp;pSystemThre&nbsp;&nbsp;&n=
bsp;&nbsp;=3D=20
      =
NULL;&nbsp;&nbsp;<BR>HMODULE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;hNtDll&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;=20
      =3D=20
      =
NULL;<BR>LPVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;=20
      lpSystemInfo&nbsp;&nbsp; =3D=20
      =
NULL;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;dwNumberBytes&nbsp;&nbsp;=3D=20
      =
MAX_INFO_BUF_LEN;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwTotalProcess=20
      =3D=20
      =
0;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;dwReturnLength;<BR>NTSTATUS&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      Status;=20
      =
<BR>LONGLONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =

      =
llTempTime;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ulIndex;<BR><BR>__try<BR>{<BR>hNtDll=20
      =3D=20
      =
LoadLibrary("NtDll.dll");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;=20
      if(hNtDll =3D=3D=20
      =
NULL)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;=20
      printf("LoadLibrary Error:=20
      =
%d\n",GetLastError());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
__leave;<BR>}<BR><BR>NtQuerySystemInformation=20
      =3D=20
      =
(NTQUERYSYSTEMINFORMATION)GetProcAddress(hNtDll,"NtQuerySystemInformation=
");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(NtQuerySystemInformation=20
      =3D=3D=20
      =
NULL)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      printf("GetProcAddress for NtQuerySystemInformation Error:=20
      =
%d\n",GetLastError());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__leave;<BR>=
}<BR><BR>lpSystemInfo=20
      =3D (LPVOID)malloc(dwNumberBytes);<BR>Status =3D=20
      =
NtQuerySystemInformation(NT_PROCESSTHREAD_INFO,<BR>&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      lpSystemInfo,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      dwNumberBytes,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      &amp;dwReturnLength);<BR>if(Status =3D=3D=20
      =
STATUS_INFO_LENGTH_MISMATCH)<BR>{<BR>printf("STATUS_INFO_LENGTH_MISMATCH\=
n");<BR>__leave;<BR>}<BR>else=20
      if(Status !=3D =
STATUS_SUCCESS)<BR>{<BR>printf("NtQuerySystemInformation=20
      Error: %d\n",GetLastError());<BR>__leave;<BR>}<BR><BR>pSystemProc =
=3D=20
      =
(PSYSTEM_PROCESSES)lpSystemInfo;<BR>while(pSystemProc-&gt;NextEntryDelta =

      !=3D 0)<BR>{<BR>if(pSystemProc-&gt;ProcessId =3D=3D=20
      dwPID)<BR>{<BR>printf("ProcessName:\t\t=20
      ");<BR>if(pSystemProc-&gt;ProcessId !=3D=20
      =
0)<BR>{<BR>wprintf(L"%-20s\n",pSystemProc-&gt;ProcessName.Buffer);<BR>}<B=
R>else<BR>{<BR>wprintf(L"%-20s\n",L"System=20
      Idle Process");<BR>}<BR>printf("ProcessID:\t\t=20
      =
%d\t\t",pSystemProc-&gt;ProcessId);<BR>printf("ParentProcessID:\t%d\n",pS=
ystemProc-&gt;InheritedFromProcessId);<BR><BR>printf("KernelTime:\t\t=20
      ");<BR>llTempTime&nbsp;&nbsp;=3D=20
      pSystemProc-&gt;KernelTime.QuadPart;<BR>llTempTime /=3D=20
      10000;<BR>printf("%d:",llTempTime/(60*60*1000));<BR>llTempTime =
%=3D=20
      60*60*1000;<BR>printf("%.2d:",llTempTime/(60*1000));<BR>llTempTime =
%=3D=20
      60*1000;<BR>printf("%.2d.",llTempTime/1000);<BR>llTempTime %=3D=20
      =
1000;<BR>printf("%.3d\t",llTempTime);<BR><BR>printf("UserTime:\t\t");<BR>=
llTempTime&nbsp;&nbsp;=3D=20
      pSystemProc-&gt;UserTime.QuadPart;<BR>llTempTime /=3D=20
      10000;<BR>printf("%d:",llTempTime/(60*60*1000));<BR>llTempTime =
%=3D=20
      60*60*1000;<BR>printf("%.2d:",llTempTime/(60*1000));<BR>llTempTime =
%=3D=20
      60*1000;<BR>printf("%.2d.",llTempTime/1000);<BR>llTempTime %=3D=20
      =
1000;<BR>printf("%.3d\n",llTempTime);<BR><BR>printf("Privilege:\t\t=20
      %d%%\t\t",(pSystemProc-&gt;KernelTime.QuadPart *=20
      100)/(pSystemProc-&gt;KernelTime.QuadPart +=20
      =
pSystemProc-&gt;UserTime.QuadPart));<BR>printf("User:\t\t\t%d%%\n",(pSyst=
emProc-&gt;UserTime.QuadPart=20
      * 100)/(pSystemProc-&gt;KernelTime.QuadPart +=20
      =
pSystemProc-&gt;UserTime.QuadPart));<BR><BR>printf("ThreadCount:\t\t=20
      =
%d\t\t",pSystemProc-&gt;ThreadCount);<BR>printf("HandleCount:\t\t%d\n",pS=
ystemProc-&gt;HandleCount);<BR><BR>printf("BasePriority:\t\t=20
      =
%-2d\t\t",pSystemProc-&gt;BasePriority);<BR>printf("PageFaultCount:\t\t%d=
\n\n",pSystemProc-&gt;VmCounters.PageFaultCount);<BR><BR>printf("PeakWork=
ingSetSize(K):\t=20
      =
%-8d\t",pSystemProc-&gt;VmCounters.PeakWorkingSetSize/1024);<BR>printf("W=
orkingSetSize(K):\t%-8d\n",pSystemProc-&gt;VmCounters.WorkingSetSize/1024=
);<BR><BR>printf("PeakPagedPool(K):\t=20
      =
%-8d\t",pSystemProc-&gt;VmCounters.QuotaPeakPagedPoolUsage/1024);<BR>prin=
tf("PagedPool(K):\t\t%-8d\n",pSystemProc-&gt;VmCounters.QuotaPagedPoolUsa=
ge/1024);<BR><BR>printf("PeakNonPagedPook(K):\t=20
      =
%-8d\t",pSystemProc-&gt;VmCounters.QuotaPeakNonPagedPoolUsage/1024);<BR>p=
rintf("NonePagedPook(K):\t%-8d\n",pSystemProc-&gt;VmCounters.QuotaNonPage=
dPoolUsage/1024);<BR><BR>printf("PeakPagefile(K):\t=20
      =
%-8d\t",pSystemProc-&gt;VmCounters.PeakPagefileUsage/1024);<BR>printf("Pa=
gefile(K):\t\t%-8d\n",pSystemProc-&gt;VmCounters.PagefileUsage/1024);<BR>=
<BR>printf("PeakVirtualSize(K):\t=20
      =
%-8d\t",pSystemProc-&gt;VmCounters.PeakVirtualSize/1024);<BR>printf("Virt=
ualSize(K):\t\t%-8d\n\n",pSystemProc-&gt;VmCounters.VirtualSize/1024);<BR=
><BR>printf("ReadTransfer:\t\t=20
      =
%-8d\t",pSystemProc-&gt;IoCounters.ReadTransferCount);<BR>printf("ReadOpe=
rationCount:\t%-8d\n",pSystemProc-&gt;IoCounters.ReadOperationCount);<BR>=
<BR>printf("WriteTransfer:\t\t=20
      =
%-8d\t",pSystemProc-&gt;IoCounters.WriteTransferCount);<BR>printf("WriteO=
perationCount:\t%-8d\n",pSystemProc-&gt;IoCounters.WriteOperationCount);<=
BR><BR>printf("OtherTransfer:\t\t=20
      =
%-8d\t",pSystemProc-&gt;IoCounters.OtherTransferCount);<BR>printf("OtherO=
perationCount:\t%-8d\n\n",pSystemProc-&gt;IoCounters.OtherOperationCount)=
;<BR><BR>printf("%-5s%3s%4s%5s%5s%11s%12s%12s%7s%6s%9s\n","TID","Pri","BP=
r","Priv","User","KernelTime","UserTime","StartAddr","CSwitC","State","Wt=
Reason");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
=20
      =
printf("-----------------------------------------------------------------=
--------------\n");<BR><BR>for(ulIndex=20
      =3D 0; ulIndex &lt; pSystemProc-&gt;ThreadCount;=20
      ulIndex++)<BR>{<BR>pSystemThre =3D=20
      =
&amp;pSystemProc-&gt;Threads[ulIndex];<BR>printf("%-5d",pSystemProc-&gt;T=
hreads[ulIndex].ClientId.UniqueThread);<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;=20
      =
printf("%3d",pSystemProc-&gt;Threads[ulIndex].Priority);<BR>printf("%4d",=
pSystemProc-&gt;Threads[ulIndex].BasePriority);<BR><BR>&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
printf("%4d%%",(pSystemProc-&gt;Threads[ulIndex].KernelTime.QuadPart *=20
      100)/(pSystemProc-&gt;KernelTime.QuadPart +=20
      =
pSystemProc-&gt;UserTime.QuadPart));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("%4=
d%%",(pSystemProc-&gt;Threads[ulIndex].UserTime.QuadPart=20
      * 100)/(pSystemProc-&gt;KernelTime.QuadPart +=20
      =
pSystemProc-&gt;UserTime.QuadPart));<BR><BR>llTempTime&nbsp;&nbsp;=3D=20
      =
pSystemProc-&gt;Threads[ulIndex].KernelTime.QuadPart;<BR>llTempTime /=3D =

      10000;<BR>printf("%2d:",llTempTime/(60*60*1000));<BR>llTempTime =
%=3D=20
      60*60*1000;<BR>printf("%.2d.",llTempTime/(60*1000));<BR>llTempTime =
%=3D=20
      60*1000;<BR>printf("%.2d.",llTempTime/1000);<BR>llTempTime %=3D=20
      100;<BR>printf("%.2d =
",llTempTime);<BR><BR>llTempTime&nbsp;&nbsp;=3D=20
      pSystemProc-&gt;Threads[ulIndex].UserTime.QuadPart;<BR>llTempTime =
/=3D=20
      10000;<BR>printf("%2d:",llTempTime/(60*60*1000));<BR>llTempTime =
%=3D=20
      60*60*1000;<BR>printf("%.2d.",llTempTime/(60*1000));<BR>llTempTime =
%=3D=20
      60*1000;<BR>printf("%.2d.",llTempTime/1000);<BR>llTempTime %=3D=20
      100;<BR>printf("%.2d ",llTempTime);<BR><BR>printf("=20
      =
0x%.8X",pSystemProc-&gt;Threads[ulIndex].StartAddress);<BR>printf("%7d",p=
SystemProc-&gt;Threads[ulIndex].ContextSwitchCount);<BR><BR>switch(pSyste=
mProc-&gt;Threads[ulIndex].State)<BR>{<BR>case=20
      StateInitialized:<BR>printf("%6s","Init.");<BR>break;<BR>case=20
      StateReady:<BR>printf("%6s","Ready");<BR>break;<BR>case=20
      StateRunning:<BR>printf("%6s","Run");<BR>break;<BR>case=20
      StateStandby:<BR>printf("%6s","StBy.");<BR>break;<BR>case=20
      StateTerminated:<BR>printf("%6s","Term.");<BR>break;<BR>case=20
      StateWait:<BR>printf("%6s","Wait");<BR>break;<BR>case=20
      StateTransition:<BR>printf("%6s","Tran.");<BR>break;<BR>case=20
      =
StateUnknown:<BR>printf("%6s","Unkn.");<BR>break;<BR>default:<BR>printf("=
%6s","Unkn.");<BR>break;<BR>}<BR><BR>switch(pSystemProc-&gt;Threads[ulInd=
ex].WaitReason)<BR>{<BR>case=20
      Executive:<BR>printf(" %-8s","Executi.");<BR>break;<BR>case=20
      FreePage:<BR>printf(" %-8s","FreePag.");<BR>break;<BR>case=20
      PageIn:<BR>printf(" %-8s","PageIn");<BR>break;<BR>case=20
      PoolAllocation:<BR>printf(" %-8s","PoolAll.");<BR>break;<BR>case=20
      DelayExecution:<BR>printf(" %-8s","DelayEx.");<BR>break;<BR>case=20
      Suspended:<BR>printf(" %-8s","Suspend.");<BR>break;<BR>case=20
      UserRequest:<BR>printf(" %-8s","UserReq.");<BR>break;<BR>case=20
      WrExecutive:<BR>printf(" %-8s","WrExect.");<BR>break;<BR>case=20
      WrFreePage:<BR>printf(" %-8s","WrFrePg.");<BR>break;<BR>case=20
      WrPageIn:<BR>printf(" %-8s","WrPageIn");<BR>break;<BR>case=20
      WrPoolAllocation:<BR>printf(" %-8s","WrPoolA.");<BR>break;<BR>case =

      WrSuspended:<BR>printf(" %-8s","WrSuspe.");<BR>break;<BR>case=20
      WrUserRequest:<BR>printf(" %-8s","WrUsReq.");<BR>break;<BR>case=20
      WrEventPair:<BR>printf(" %-8s","WrEvent.");<BR>break;<BR>case=20
      WrQueue:<BR>printf(" %-8s","WrQueue");<BR>break;<BR>case=20
      WrLpcReceive:<BR>printf(" %-8s","WrLpcRv.");<BR>break;<BR>case=20
      WrLpcReply:<BR>printf(" %-8s","WrLpcRp.");<BR>break;<BR>case=20
      WrVertualMemory:<BR>printf(" %-8s","WrVerMm.");<BR>break;<BR>case=20
      WrPageOut:<BR>printf(" %-8s","WrPgOut.");<BR>break;<BR>case=20
      WrRendezvous:<BR>printf(" %-8s","WrRende.");<BR>break;<BR>case=20
      WrKernel:<BR>printf(" =
%-8s","WrKernel");<BR>break;<BR>default:<BR>printf("=20
      =
%-8s","Unknown");<BR>break;<BR>}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("\n");<BR>}<BR>&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;printf("------------------------------------------------=
-------------------------------\n\n");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("T=
otal=20
      %d Thread(s) !\n\n",ulIndex);<BR><BR>dwTotalProcess=20
      ++;<BR>break;<BR>}<BR>pSystemProc =3D (PSYSTEM_PROCESSES)((char=20
      *)pSystemProc +=20
      =
pSystemProc-&gt;NextEntryDelta);<BR>}<BR>}<BR>__finally<BR>{<BR>if(dwTota=
lProcess=20
      =3D=3D 0)<BR>{<BR>printf("Could not found the %d Process=20
      =
!\n",dwPID);<BR>}<BR>else<BR>{<BR>printf("TID:\t\t=3D=3D=3D=3D&gt;\tThrea=
d=20
      =
Identification\n");<BR>printf("Pri:\t\t=3D=3D=3D=3D&gt;\tPriority\n");<BR=
>printf("BPr:\t\t=3D=3D=3D=3D&gt;\tBase=20
      =
Priority\n");<BR>printf("Priv:\t\t=3D=3D=3D=3D&gt;\tPrivilege\n");<BR>pri=
ntf("StartAddr:\t=3D=3D=3D=3D&gt;\tThread=20
      Start Address\n");<BR>printf("CSwitC:\t\t=3D=3D=3D=3D&gt;\tContext =
Switch=20
      Count\n");<BR>printf("WtReason:\t=3D=3D=3D=3D&gt;\tWait=20
      Reason\n");<BR>}<BR>if(lpSystemInfo !=3D=20
      NULL)<BR>{<BR>free(lpSystemInfo);<BR>}<BR>if(hNtDll !=3D=20
      =
NULL)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      FreeLibrary(hNtDll);<BR>}<BR>}<BR><BR>return 0;<BR>}<BR><BR>VOID=20
      Start()<BR>{<BR>printf("T-PMList, by TOo2y\n");<BR>printf("E-mail: =

      TOo2y@safechina.net\n");<BR>printf("HomePage:=20
      www.safechina.net\n");<BR>printf("Date: =
05-10-2003\n\n");<BR>return=20
      ;<BR>}<BR><BR>VOID=20
      Usage()<BR>{<BR>printf("Usage:\tT-PMList&nbsp;&nbsp;[-e] =A9=A6 =
[-s PID]\n");=20
      <BR>printf("&nbsp;&nbsp;-e\t&nbsp;&nbsp;Enumerate All=20
      Processes\n");<BR>printf("&nbsp;&nbsp;-s PID&nbsp;&nbsp;Show =
Special=20
      Process Information with PID\n\n");<BR>return=20
      =
;<BR>}<BR><BR>#endif<BR><BR>2.T-PMPerf=B5=C4=CD=B7=CE=C4=BC=FE=D4=B4=B4=FA=
=C2=EB=A3=BA<BR><BR>#ifndef=20
      T_PMPERF_H<BR>#define T_PMPERF_H<BR><BR>#include =
"windows.h"<BR>#include=20
      "stdio.h"<BR><BR>#define=20
      =
SYSTEM_PERF_INFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;=20
      0x02<BR>#define=20
      =
SYSTEM_PROC_TIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;=20
      0x08<BR>#define=20
      =
SYSTEM_PAGE_INFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;=20
      0x12<BR>#define=20
      =
SYSTEM_CACHE_INFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;0x15<BR>#define=20
      =
MAX_INFO_BUF_LEN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;=20
      0x500000<BR>#define=20
      =
STATUS_SUCCESS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;=20
      ((NTSTATUS)0x00000000L)<BR><BR>typedef=20
      LONG&nbsp;&nbsp;NTSTATUS;<BR>typedef DWORD=20
      SYSTEM_INFORMATION_CLASS;<BR><BR>typedef struct=20
      =
_LSA_UNICODE_STRING<BR>{<BR>USHORT&nbsp;&nbsp;Length;<BR>USHORT&nbsp;&nbs=
p;MaximumLength;<BR>PWSTR&nbsp;&nbsp;=20
      Buffer;<BR>}LSA_UNICODE_STRING,*PLSA_UNICODE_STRING;<BR>typedef=20
      LSA_UNICODE_STRING UNICODE_STRING, =
*PUNICODE_STRING;<BR><BR>typedef struct=20
      =
_SYSTEM_PERFORMANCE_INFORMATION<BR>{<BR>LARGE_INTEGER&nbsp;&nbsp;IdleTime=
;<BR>LARGE_INTEGER&nbsp;&nbsp;ReadTransferCount;<BR>LARGE_INTEGER&nbsp;&n=
bsp;WriteTransferCount;<BR>LARGE_INTEGER&nbsp;&nbsp;OtherTransferCount;<B=
R>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadOp=
erationCount;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;WriteOperationCount;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;OtherOperationCount;<BR>ULONG&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AvailablePages;<BR>ULONG&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TotalCommittedPages;<=
BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total=
CommitLimit;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;PeakCommitment;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;PageFaults;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;WriteCopyFaults;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TransitionFaults;<BR>ULONG&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reserved1;<BR>ULONG&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DemandZeroFaults=
;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pag=
esRead;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;PageReadIos;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;Reserved2[2];<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;PagefilePagesWritten;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PagefilePageWriteIos;<BR>ULONG&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MappedFilePagesWrit=
ten;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
MappedFileWriteIos;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;PagedPoolUsage;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;NonPagedPoolUsage;<BR>ULONG&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PagedPoolAllocs;<BR>ULONG&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PagedPoolFrees;<BR>UL=
ONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NonPagedPo=
olAllocs;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;NonPagedPoolFress;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;TotalFreeSystemPtes;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SystemCodePage;<BR>ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TotalSystemDriverPages;<BR>=
ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TotalSys=
temCodePages;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;SmallNonPagedLookasideListAllocateHits;<BR>ULONG&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SmallPagedLookasideListAlloca=
teHits;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;Reserved3;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;MmSystemCachePage;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;PagedPoolPage;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SystemDriverPage;<BR>ULONG&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FastReadNoWait;<BR>ULONG&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FastReadWait;<BR=
>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FastRea=
dResourceMiss;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;FastReadNotPossible;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;FastMdlReadNoWait;<BR>ULONG&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FastMdlReadWait;<BR>ULONG&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FastMdlReadResourceMi=
ss;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;F=
astMdlReadNotPossible;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;MapDataNoWait;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;MapDataWait;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapDataNoWaitMiss;<BR>ULONG&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MapDataWaitMiss;<BR>ULO=
NG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PinMappedDa=
taCount;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;PinReadNoWait;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;PinReadWait;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;PinReadNoWaitMiss;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PinReadWaitMiss;<BR>ULONG&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CopyReadNoWait;<BR>ULONG&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CopyReadWait;<=
BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CopyR=
eadNoWaitMiss;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;CopyReadWaitMiss;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;MdlReadNoWait;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MdlReadWait;<BR>ULONG&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MdlReadNoWaitMiss;<BR>ULONG&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MdlReadWaitMiss;<B=
R>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadAh=
eadIos;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;LazyWriteIos;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;LazyWritePages;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;DataFlushes;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataPages;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ContextSwitches;<BR>ULONG&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FirstLevelTbFills;<BR>UL=
ONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecondLeve=
lTbFills;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;SystemCall;<BR>}SYSTEM_PERFORMANCE_INFORMATION,*PSYSTEM_PERFORMANCE_=
INFORMATION;<BR><BR>typedef=20
      struct __SYSTEM_PROCESSOR_TIMES<BR>{<BR>LARGE_INTEGER=20
      IdleTime;<BR>LARGE_INTEGER KernelTime;<BR>LARGE_INTEGER=20
      UserTime;<BR>LARGE_INTEGER DpcTime;<BR>LARGE_INTEGER=20
      =
InterruptTime;<BR>ULONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
InterruptCount;<BR>}SYSTEM_PROCESSOR_TIMES,*PSYSTEM_PROCESSOR_TIMES;<BR><=
BR>typedef=20
      struct _SYSTEM_PAGEFILE_INFORMATION<BR>{<BR>ULONG=20
      NetxEntryOffset;<BR>ULONG CurrentSize;<BR>ULONG =
TotalUsed;<BR>ULONG=20
      PeakUsed;<BR>UNICODE_STRING=20
      =
FileName;<BR>}SYSTEM_PAGEFILE_INFORMATION,*PSYSTEM_PAGEFILE_INFORMATION;<=
BR><BR>typedef=20
      struct _SYSTEM_CACHE_INFORMATION<BR>{<BR>ULONG =
SystemCacheWsSize;<BR>ULONG=20
      SystemCacheWsPeakSize;<BR>ULONG SystemCacheWsFaults;<BR>ULONG=20
      SystemCacheWsMinimum;<BR>ULONG SystemCacheWsMaximum;<BR>ULONG=20
      TransitionSharedPages;<BR>ULONG =
TransitionSharedPagesPeak;<BR>ULONG=20
      =
Reserved[2];<BR>}SYSTEM_CACHE_INFORMATION,*PSYSTEM_CACHE_INFORMATION;<BR>=
<BR>typedef=20
      NTSTATUS (__stdcall *=20
      =
NTQUERYSYSTEMINFORMATION)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      (IN&nbsp;&nbsp;&nbsp;&nbsp; SYSTEM_INFORMATION_CLASS,<BR>IN OUT=20
      =
PVOID,<BR>INT&nbsp;&nbsp;&nbsp;&nbsp;ULONG,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;=20
      OUT&nbsp;&nbsp;&nbsp;&nbsp;PULONG =
OPTION);<BR>NTQUERYSYSTEMINFORMATION=20
      NtQuerySystemInformation;<BR><BR>DWORD=20
      PerfInfo()<BR>{<BR>SYSTEM_PERFORMANCE_INFORMATION=20
      =
SystemPerfInfo;<BR>HMODULE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;=20
      hNtDll =3D=20
      =
NULL;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;=20
      =
dwNumberBytes;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;=20
      =
dwReturnLength;<BR>NTSTATUS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;Status;<BR>LONGLONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;llTe=
mpTime;<BR><BR>__try<BR>{<BR>hNtDll=20
      =3D=20
      =
LoadLibrary("NtDll.dll");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;=20
      if(hNtDll =3D=3D=20
      =
NULL)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;=20
      printf("LoadLibrary Error:=20
      =
%d\n",GetLastError());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;__leave;<BR>}<BR><BR>NtQuerySystemInformation=20
      =3D=20
      =
(NTQUERYSYSTEMINFORMATION)GetProcAddress(hNtDll,"NtQuerySystemInformation=
");<BR>if(NtQuerySystemInformation=20
      =3D=3D NULL)<BR>{<BR>printf("GetProcAddress for =
NtQuerySystemInformation=20
      Error: =
%d\n",GetLastError());<BR>__leave;<BR>}<BR><BR>dwNumberBytes =3D=20
      sizeof(SYSTEM_PERFORMANCE_INFORMATION);<BR>Status =3D=20
      =
NtQuerySystemInformation(SYSTEM_PERF_INFO,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      &amp;SystemPerfInfo,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      dwNumberBytes,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      &amp;dwReturnLength);<BR>if(Status !=3D=20
      STATUS_SUCCESS)<BR>{<BR>printf("NtQuerySystemInformation for =
Performance=20
      Error:=20
      =
%d\n",GetLastError());<BR>__leave;<BR>}<BR><BR>printf("IdleTime:\t\t");<B=
R>llTempTime&nbsp;&nbsp;=3D=20
      SystemPerfInfo.IdleTime.QuadPart;<BR>llTempTime /=3D=20
      10000;<BR>printf("%d:",llTempTime/(60*60*1000));<BR>llTempTime =
%=3D=20
      60*60*1000;<BR>printf("%.2d:",llTempTime/(60*1000));<BR>llTempTime =
%=3D=20
      60*1000;<BR>printf("%.2d.",llTempTime/1000);<BR>llTempTime %=3D=20
      =
1000;<BR>printf("%.3d\n",llTempTime);<BR><BR>printf("ReadOperationCount:\=
t%-10d\t",SystemPerfInfo.ReadOperationCount);<BR>printf("ReadTransferCoun=
t:\t%d\n",SystemPerfInfo.ReadTransferCount);<BR>printf("WriteOperationCou=
nt:\t%-10d\t",SystemPerfInfo.WriteOperationCount);<BR>printf("WriteTransf=
erCount:\t%d\n",SystemPerfInfo.WriteTransferCount);<BR>printf("OtherOpera=
tionCount:\t%-10d\t",SystemPerfInfo.OtherOperationCount);<BR>printf("Othe=
rTransferCount:\t%d\n",SystemPerfInfo.OtherTransferCount);<BR><BR>printf(=
"AvailablePages:\t\t%-10d\t",SystemPerfInfo.AvailablePages);<BR>printf("T=
otalCommittedPage:\t%d\n",SystemPerfInfo.TotalCommittedPages);<BR>printf(=
"CommitLimit:\t\t%-10d\t",SystemPerfInfo.TotalCommitLimit);<BR>printf("Pe=
akCommitment:\t\t%d\n",SystemPerfInfo.PeakCommitment);<BR><BR>printf("Pag=
eFault:\t\t%-10d\t",SystemPerfInfo.PageFaults);<BR>printf("WriteCopyFault=
:\t\t%d\n",SystemPerfInfo.WriteCopyFaults);<BR>printf("TransitionFault:\t=
%-10d\t",SystemPerfInfo.TransitionFaults);<BR>printf("DemandZeroFault:\t%=
d\n",SystemPerfInfo.DemandZeroFaults);<BR><BR>printf("PagesRead:\t\t%-10d=
\t",SystemPerfInfo.PagesRead);<BR>printf("PageReadIos:\t\t%d\n",SystemPer=
fInfo.PageReadIos);<BR>printf("PagesWritten:\t\t%-10d\t",SystemPerfInfo.P=
agefilePagesWritten);<BR>printf("PageWriteIos:\t\t%d\n",SystemPerfInfo.Pa=
gefilePageWriteIos);<BR>printf("MappedFilePagesWritten:\t%-10d\t",SystemP=
erfInfo.MappedFilePagesWritten);<BR>printf("MappedFileWriteIos:\t%d\n",Sy=
stemPerfInfo.MappedFileWriteIos);<BR><BR>printf("PagedPoolUsage:\t\t%-10d=
\t",SystemPerfInfo.PagedPoolUsage);<BR>printf("NonPagedPoolUsage:\t%d\n",=
SystemPerfInfo.NonPagedPoolUsage);<BR>printf("PagedPoolAllocs:\t%-10d\t",=
SystemPerfInfo.PagedPoolAllocs);<BR>printf("NonPagedPoolAllocs:\t%d\n",Sy=
stemPerfInfo.NonPagedPoolAllocs);<BR>printf("PagedPoolFrees:\t\t%-10d\t",=
SystemPerfInfo.PagedPoolFrees);<BR>printf("NonPagedPoolFrees:\t%d\n",Syst=
emPerfInfo.NonPagedPoolFress);<BR><BR>printf("SystemCodePage:\t\t%-10d\t"=
,SystemPerfInfo.SystemCodePage);<BR>printf("TotalSystemCodePage:\t%d\n",S=
ystemPerfInfo.TotalSystemCodePages);<BR>printf("TotalFreeSysPTE:\t%-10d\t=
",SystemPerfInfo.TotalFreeSystemPtes);<BR>printf("TotalSystemDriverPages:=
\t%d\n",SystemPerfInfo.TotalSystemDriverPages);<BR>printf("PagedPoolPage:=
\t\t%-10d\t",SystemPerfInfo.PagedPoolPage);<BR>printf("SystemDriverPage:\=
t%d\n",SystemPerfInfo.SystemDriverPage);<BR><BR>printf("FastReadWait:\t\t=
%-10d\t",SystemPerfInfo.FastReadWait);<BR>printf("FastReadNoWait:\t\t%d\n=
",SystemPerfInfo.FastReadNoWait);<BR>printf("FastReadNoPossible:\t%-10d\t=
",SystemPerfInfo.FastReadNotPossible);<BR>printf("FastReadResourceMiss:\t=
%d\n",SystemPerfInfo.FastReadResourceMiss);<BR>printf("FastMdlReadWait:\t=
%-10d\t",SystemPerfInfo.FastMdlReadWait);<BR>printf("FastMdlReadNoWait:\t=
%d\n",SystemPerfInfo.FastMdlReadNoWait);<BR>printf("FastMdlReadNotPossibl=
e:\t%-10d\t",SystemPerfInfo.FastMdlReadNotPossible);<BR>printf("FastMdlRe=
adResourceMiss:%d\n",SystemPerfInfo.FastMdlReadResourceMiss);<BR><BR><BR>=
printf("MapDataWait:\t\t%-10d\t",SystemPerfInfo.MapDataWait);<BR>printf("=
MapDataNoWait:\t\t%d\n",SystemPerfInfo.MapDataNoWait);<BR>printf("MapData=
WaitMiss:\t%-10d\t",SystemPerfInfo.MapDataWaitMiss);<BR>printf("MapDataNo=
WaitMiss:\t%d\n",SystemPerfInfo.MapDataNoWaitMiss);<BR><BR>printf("ReadAh=
eadIos:\t\t%-10d\t",SystemPerfInfo.ReadAheadIos);<BR>printf("PinMappedDat=
aCount:\t%d\n",SystemPerfInfo.PinMappedDataCount);<BR>printf("PinReadWait=
:\t\t%-10d\t",SystemPerfInfo.PinReadWait);<BR>printf("PinReadNoWait:\t\t%=
d\n",SystemPerfInfo.PinReadNoWait);<BR>printf("PinReadWaitMiss:\t%-10d\t"=
,SystemPerfInfo.PinReadWaitMiss);<BR>printf("PinReadNoWaitMiss:\t%d\n",Sy=
stemPerfInfo.PinReadNoWaitMiss);<BR><BR>printf("CopyReadWait:\t\t%-10d\t"=
,SystemPerfInfo.CopyReadWait);<BR>printf("CopyReadNoWait:\t\t%d\n",System=
PerfInfo.CopyReadNoWait);<BR>printf("CopyReadWaitMiss:\t%-10d\t",SystemPe=
rfInfo.CopyReadWaitMiss);<BR>printf("CopyReadNoWaitMiss:\t%-10d\n",System=
PerfInfo.CopyReadNoWaitMiss);<BR>printf("MdlReadWait:\t\t%-10d\t",SystemP=
erfInfo.MdlReadWait);<BR>printf("MdlReadNoWait:\t\t%d\n",SystemPerfInfo.M=
dlReadNoWait);<BR>printf("MdlReadWaitMiss:\t%-10d\t",SystemPerfInfo.MdlRe=
adWaitMiss);<BR>printf("MdlReadNoWaitMiss:\t%d\n",SystemPerfInfo.MdlReadN=
oWaitMiss);<BR><BR>printf("LazyWriteIos:\t\t%-10d\t",SystemPerfInfo.LazyW=
riteIos);<BR>printf("LazyWritePages:\t\t%d\n",SystemPerfInfo.LazyWritePag=
es);<BR>printf("DataPages:\t\t%-10d\t",SystemPerfInfo.DataPages);<BR>prin=
tf("DataFlushes:\t\t%d\n",SystemPerfInfo.DataFlushes);<BR>printf("FirstLe=
velTbFills:\t%-10d\t",SystemPerfInfo.FirstLevelTbFills);<BR>printf("Secon=
dLevelTbFills:\t%d\n",SystemPerfInfo.SecondLevelTbFills);<BR>printf("Cont=
extSwitches:\t%-10d\t",SystemPerfInfo.ContextSwitches);<BR>printf("SytemC=
all:\t\t%d\n",SystemPerfInfo.SystemCall);<BR><BR>printf("MemorySystemCach=
ePage:\t\t\t%d\n",SystemPerfInfo.MmSystemCachePage);<BR>printf("SmallPage=
dLookasideListAllocateHits:\t%d\n",SystemPerfInfo.SmallPagedLookasideList=
AllocateHits);<BR>printf("SmallNonPagedLookasideListAllocateHits:\t%d\n",=
SystemPerfInfo.SmallNonPagedLookasideListAllocateHits);<BR><BR>}<BR>__fin=
ally<BR>{<BR>if(hNtDll !=3D=20
      NULL)<BR>{<BR>FreeLibrary(hNtDll);<BR>}<BR>}<BR><BR>return=20
      0;<BR>}<BR><BR>DWORD=20
      =
ProcTime()<BR>{<BR>SYSTEM_PROCESSOR_TIMES&nbsp;&nbsp;SystemProcTime;<BR>H=
MODULE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      hNtDll =3D=20
      =
NULL;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
dwNumberBytes;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
dwReturnLength;<BR>NTSTATUS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Status;<BR>LONGLONG&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;llTempTime;<BR><BR>__try<BR>{<BR>hNtDll=20
      =3D =
LoadLibrary("NtDll.dll");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      if(hNtDll =3D=3D=20
      NULL)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      printf("LoadLibrary Error:=20
      %d\n",GetLastError());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      __leave;<BR>}<BR><BR>NtQuerySystemInformation =3D=20
      =
(NTQUERYSYSTEMINFORMATION)GetProcAddress(hNtDll,"NtQuerySystemInformation=
");<BR>if(NtQuerySystemInformation=20
      =3D=3D NULL)<BR>{<BR>printf("GetProcAddress for =
NtQuerySystemInformation=20
      Error: =
%d\n",GetLastError());<BR>__leave;<BR>}<BR><BR>dwNumberBytes =3D=20
      sizeof(SYSTEM_PROCESSOR_TIMES);<BR>NtQuerySystemInformation =3D=20
      =
(NTQUERYSYSTEMINFORMATION)GetProcAddress(hNtDll,"NtQuerySystemInformation=
");<BR>if(NtQuerySystemInformation=20
      =3D=3D NULL)<BR>{<BR>printf("GetProcAddress Error:=20
      %d\n",GetLastError());<BR>__leave;<BR>}<BR><BR>Status =3D=20
      =
NtQuerySystemInformation(SYSTEM_PROC_TIME,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      &amp;SystemProcTime,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      dwNumberBytes,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      &amp;dwReturnLength);<BR>if(Status !=3D=20
      STATUS_SUCCESS)<BR>{<BR>printf("NtQuerySystemInformation for =
Processor=20
      Time Error:=20
      =
%d\n",GetLastError());<BR>__leave;<BR>}<BR><BR>printf("IdleTime:\t\t");<B=
R>llTempTime&nbsp;&nbsp;=3D=20
      SystemProcTime.IdleTime.QuadPart;<BR>llTempTime /=3D=20
      10000;<BR>printf("%d:",llTempTime/(60*60*1000));<BR>llTempTime =
%=3D=20
      60*60*1000;<BR>printf("%.2d:",llTempTime/(60*1000));<BR>llTempTime =
%=3D=20
      60*1000;<BR>printf("%.2d.",llTempTime/1000);<BR>llTempTime %=3D=20
      =
1000;<BR>printf("%.3d\n",llTempTime);<BR><BR>printf("KernelTime:\t\t");<B=
R>llTempTime&nbsp;&nbsp;=3D=20
      SystemProcTime.KernelTime.QuadPart;<BR>llTempTime /=3D=20
      10000;<BR>printf("%d:",llTempTime/(60*60*1000));<BR>llTempTime =
%=3D=20
      60*60*1000;<BR>printf("%.2d:",llTempTime/(60*1000));<BR>llTempTime =
%=3D=20
      60*1000;<BR>printf("%.2d.",llTempTime/1000);<BR>llTempTime %=3D=20
      =
1000;<BR>printf("%.3d\n",llTempTime);<BR><BR>printf("UserTime:\t\t");<BR>=
llTempTime&nbsp;&nbsp;=3D=20
      SystemProcTime.UserTime.QuadPart;<BR>llTempTime /=3D=20
      10000;<BR>printf("%d:",llTempTime/(60*60*1000));<BR>llTempTime =
%=3D=20
      60*60*1000;<BR>printf("%.2d:",llTempTime/(60*1000));<BR>llTempTime =
%=3D=20
      60*1000;<BR>printf("%.2d.",llTempTime/1000);<BR>llTempTime %=3D=20
      =
1000;<BR>printf("%.3d\n",llTempTime);<BR><BR>printf("DpcTime:\t\t");<BR>l=
lTempTime&nbsp;&nbsp;=3D=20
      SystemProcTime.DpcTime.QuadPart;<BR>llTempTime /=3D=20
      10000;<BR>printf("%d:",llTempTime/(60*60*1000));<BR>llTempTime =
%=3D=20
      60*60*1000;<BR>printf("%.2d:",llTempTime/(60*1000));<BR>llTempTime =
%=3D=20
      60*1000;<BR>printf("%.2d.",llTempTime/1000);<BR>llTempTime %=3D=20
      =
1000;<BR>printf("%.3d\n",llTempTime);<BR><BR>printf("InterruptTime:\t\t")=
;<BR>llTempTime&nbsp;&nbsp;=3D=20
      SystemProcTime.InterruptTime.QuadPart;<BR>llTempTime /=3D=20
      10000;<BR>printf("%d:",llTempTime/(60*60*1000));<BR>llTempTime =
%=3D=20
      60*60*1000;<BR>printf("%.2d:",llTempTime/(60*1000));<BR>llTempTime =
%=3D=20
      60*1000;<BR>printf("%.2d.",llTempTime/1000);<BR>llTempTime %=3D=20
      =
1000;<BR>printf("%.3d\n",llTempTime);<BR><BR>printf("InterruptCount:\t\t%=
d\n",SystemProcTime.InterruptCount);<BR><BR>}<BR>__finally<BR>{<BR>if(hNt=
Dll=20
      !=3D NULL)<BR>{<BR>FreeLibrary(hNtDll);<BR>}<BR>}<BR><BR>return=20
      0;<BR>}<BR><BR>DWORD=20
      PagefileInfo()<BR>{<BR>PSYSTEM_PAGEFILE_INFORMATION&nbsp;&nbsp;=20
      =
pSystemPagefileInfo;<BR>PVOID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pBuffer;<BR>HMODULE&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hNtDll=20
      =3D=20
      =
NULL;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;dwNumberBytes;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwReturnLength;<=
BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
NTSTATUS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      Status;<BR><BR>__try<BR>{<BR>hNtDll =3D=20
      =
LoadLibrary("NtDll.dll");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;=20
      if(hNtDll =3D=3D=20
      =
NULL)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;printf("LoadLibrary=20
      Error:=20
      =
%d\n",GetLastError());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;=20
      __leave;<BR>}<BR><BR>NtQuerySystemInformation =3D=20
      =
(NTQUERYSYSTEMINFORMATION)GetProcAddress(hNtDll,"NtQuerySystemInformation=
");<BR>if(NtQuerySystemInformation=20
      =3D=3D NULL)<BR>{<BR>printf("GetProcAddress for =
NtQuerySystemInformation=20
      Error: =
%d\n",GetLastError());<BR>__leave;<BR>}<BR><BR>dwNumberBytes =3D=20
      MAX_INFO_BUF_LEN;<BR>pBuffer =3D=20
      (LPVOID)malloc(dwNumberBytes);<BR>Status&nbsp;&nbsp;=3D=20
      =
NtQuerySystemInformation(SYSTEM_PAGE_INFO,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pBuffer,<BR>&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwNumberBytes,<BR>&amp;dwRetur=
nLength);<BR>if(Status=20
      !=3D STATUS_SUCCESS)<BR>{<BR>printf("NtQuerySystemInformation for =
Pagefile=20
      Error: =
%d\n",GetLastError());<BR>__leave;<BR>}<BR><BR>pSystemPagefileInfo=20
      =3D=20
      =
(PSYSTEM_PAGEFILE_INFORMATION)pBuffer;<BR>do<BR>{<BR>printf("CurrentPagef=
ileSize:\t%d\n",pSystemPagefileInfo-&gt;CurrentSize);<BR>printf("TotalPag=
efileUsed:\t%d\n",pSystemPagefileInfo-&gt;TotalUsed);<BR>printf("PeakPage=
fileUsed:\t%d\n",pSystemPagefileInfo-&gt;PeakUsed);<BR>wprintf(L"Pagefile=
FileName:\t%s\n",pSystemPagefileInfo-&gt;FileName.Buffer);<BR><BR>pSystem=
PagefileInfo=20
      =3D (PSYSTEM_PAGEFILE_INFORMATION)((char *)pBuffer +=20
      =
pSystemPagefileInfo-&gt;NetxEntryOffset);<BR>}while(pSystemPagefileInfo-&=
gt;NetxEntryOffset=20
      !=3D 0);<BR>}<BR>__finally<BR>{<BR>if(pBuffer !=3D=20
      NULL)<BR>{<BR>free(pBuffer);<BR>} <BR>if(hNtDll&nbsp;&nbsp;!=3D=20
      NULL)<BR>{<BR>FreeLibrary(hNtDll);<BR>}<BR>}<BR><BR>return=20
      0;<BR>}<BR><BR>DWORD=20
      =
CacheInfo()<BR>{<BR>SYSTEM_CACHE_INFORMATION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;=20
      =
SystemCacheInfo;<BR>HMODULE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbs=
p;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;hNtDll=20
      =3D=20
      =
NULL;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;dwNumberBytes;<BR>DWORD&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwReturnLength;<=
BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      =
NTSTATUS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      Status;<BR><BR>__try<BR>{<BR>hNtDll =3D=20
      =
LoadLibrary("NtDll.dll");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;=20
      if(hNtDll =3D=3D=20
      =
NULL)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;=20
      printf("LoadLibrary Error:=20
      =
%d\n",GetLastError());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp=
;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=20
      __leave;<BR>}<BR><BR>NtQuerySystemInformation =3D=20
      =
(NTQUERYSYSTEMINFORMATION)GetProcAddress(hNtDll,"NtQuerySystemInformation=
");<BR>if(NtQuerySystemInformation=20
      =3D=3D NULL)<BR>{<BR>printf("GetProcAddress for =
NtQuerySystemInformation=20
      Error: =
%d\n",GetLastError());<BR>__leave;<BR>}<BR><BR>dwNumberBytes =3D=20
      sizeof(SYSTEM_CACHE_INFORMATION);<BR>Status&nbsp;&nbsp;=3D=20
      =
NtQuerySystemInformation(SYSTEM_CACHE_INFO,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&n=
bsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nb=
sp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;SystemCache=
Info,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dwNumberBytes,<B=
R>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;dwReturnLength);<B=
R>if(Status=20
      !=3D STATUS_SUCCESS)<BR>{<BR>printf("NtQuerySystemInformation for =
Cache=20
      Error:=20
      =
%d\n",GetLastError());<BR>__leave;<BR>}<BR><BR>printf("CacheWorkingSetSiz=
e:\t\t%d(KB)\n",SystemCacheInfo.SystemCacheWsSize/1024);<BR>printf("Cache=
WorkingSetPeakSize:\t%d(KB)\n",SystemCacheInfo.SystemCacheWsPeakSize/1024=
);<BR>printf("CacheWorkingSetFaults:\t\t%d\n",SystemCacheInfo.SystemCache=
WsFaults);<BR>printf("CacheWorkingSetMinimum:\t\t%d\n",SystemCacheInfo.Sy=
stemCacheWsMinimum);<BR>printf("CacheWorkingSetMaximum:\t\t%d\n",SystemCa=
cheInfo.SystemCacheWsMaximum);<BR>printf("TransitionSharedPages:\t\t%d\n"=
,SystemCacheInfo.TransitionSharedPages);<BR>printf("TransitionSharedPages=
Peak:\t%d\n",SystemCacheInfo.TransitionSharedPagesPeak);<BR><BR>}<BR>__fi=
nally<BR>{<BR>if(hNtDll=20
      !=3D NULL)<BR>{<BR>FreeLibrary(hNtDll);<BR>}<BR>}<BR><BR>return=20
      0;<BR>}<BR><BR>VOID Start()<BR>{<BR>printf("T-PMPerf, by=20
      TOo2y\n");<BR>printf("E-mail:=20
      TOo2y@safechina.net\n");<BR>printf("HomePage:=20
      www.safechina.net\n");<BR>printf("Date: =
05-09-2003\n\n");<BR>return=20
      ;<BR>}<BR><BR>VOID Usage()<BR>{<BR>printf("Usage:\tT-PMPerf=20
      =
&lt;Option&gt;\n");<BR>printf("Option:\n");<BR>printf("&nbsp;&nbsp;-Perf&=
nbsp;&nbsp;=20
      System Performance=20
      Information\n");<BR>printf("&nbsp;&nbsp;-Proc&nbsp;&nbsp; System =
Processor=20
      Information\n");<BR>printf("&nbsp;&nbsp;-Page&nbsp;&nbsp; System =
Pagefile=20
      Information\n");<BR>printf("&nbsp;&nbsp;-Cache&nbsp;&nbsp;System =
Cache=20
      Information\n");<BR>return ;<BR>}<BR><BR>#endif<BR><BR>Reference: =
=A1=B6Windows=20
      NT/2000 Native API =
Reference=A1=B7=A1=A3<BR><BR>=B9=D8=D3=DA=CE=D2=C3=C7=A3=BA =
<BR><BR>FZ5FZ=20
      =
=D6=F7=D2=AA=B4=D3=CA=C2=CD=F8=C2=E7/=CF=B5=CD=B3=B0=B2=C8=AB=B5=C4=D1=A7=
=CF=B0=D3=EB=D1=D0=BE=BF=A3=AC=C9=EE=C8=EB=B1=E0=B3=CC=BC=BC=CA=F5=B5=C4=C6=
=CA=CE=F6=D3=EB=CC=BD=CC=D6=A3=AC=BC=E1=B3=D6=D4=AD=B4=B4=A3=AC=D7=B7=C7=F3=
=B9=B2=CF=ED=A1=A3<BR>FZ5FZ=20
    =
=D6=F7=D2=B3=A3=BAhttp://www.fz5fz.org</TD></TR></TBODY></TABLE></BODY></=
HTML>
