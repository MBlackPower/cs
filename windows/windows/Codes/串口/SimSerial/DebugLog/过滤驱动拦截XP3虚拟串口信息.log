================ Thu Dec 18 20:57:59 2003
NTICE: Unload32 MOD=browseui
NTICE: Unload32 MOD=shdocvw
NTICE: Unload32 MOD=HTRN_JIS
DevUpper.sys: + Enter FilterCreate routine
DevUpper.sys: - Exit FilterCreate routine
DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_SET_QUEUE_SIZE ---
DevUpper.sys: IoControl code:  1769480
InputBufferLength:  8     OutputBufferLength:   0   Irp:   0x815f5648
DevUpper.sys: Input Buf (816ec9a8):
 0 20  0  0  0 20  0  0
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  0
return buffer(0x816ec9a8):

DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: --- Default  ---
DevUpper.sys: IoControl code:  1769600
InputBufferLength:  0     OutputBufferLength:   4   Irp:   0x815f5648
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  4
return buffer(0x816ec9a8):
 0  0  0  0
DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine



=============        Win32调用 GetCommState     ============================

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_GET_BAUD_RATE ---
DevUpper.sys: IoControl code:  1769552
InputBufferLength:  0     OutputBufferLength:   4   Irp:   0x815f5648
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  4
return buffer(0x816ec9a8):
b0  4  0  0
DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_GET_LINE_CONTROL ---
DevUpper.sys: IoControl code:  1769556
InputBufferLength:  0     OutputBufferLength:   3   Irp:   0x815f5648
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  3
return buffer(0x816ec9a8):
 0  2  7
DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_GET_CHARS ---
DevUpper.sys: IoControl code:  1769560
InputBufferLength:  0     OutputBufferLength:   6   Irp:   0x815f5648
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  6
return buffer(0x816ec9a8):
 0  0  0  0 11 13
DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_GET_HANDFLOW ---
DevUpper.sys: IoControl code:  1769568
InputBufferLength:  0     OutputBufferLength:   16   Irp:   0x815f5648
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  16
return buffer(0x816ec9a8):
 1  0  0  0 40  0  0  0  0 10  0  0  0  4  0  0
DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine



===============Win32调用SetCommState====================

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_GET_BAUD_RATE ---
DevUpper.sys: IoControl code:  1769552
InputBufferLength:  0     OutputBufferLength:   4   Irp:   0x815f5648
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  4
return buffer(0x816ec9a8):
b0  4  0  0
DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_GET_LINE_CONTROL ---
DevUpper.sys: IoControl code:  1769556
InputBufferLength:  0     OutputBufferLength:   3   Irp:   0x815f5648
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  3
return buffer(0x816ec9a8):
 0  2  7
DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_GET_CHARS ---
DevUpper.sys: IoControl code:  1769560
InputBufferLength:  0     OutputBufferLength:   6   Irp:   0x815f5648
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  6
return buffer(0x816ec9a8):
 0  0  0  0 11 13
DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_GET_HANDFLOW ---
DevUpper.sys: IoControl code:  1769568
InputBufferLength:  0     OutputBufferLength:   16   Irp:   0x815f5648
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  16
return buffer(0x816ec9a8):
 1  0  0  0 40  0  0  0  0 10  0  0  0  4  0  0
DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_SET_BAUD_RATE ---
DevUpper.sys: IoControl code:  1769476
InputBufferLength:  4     OutputBufferLength:   0   Irp:   0x815f5648
DevUpper.sys: Input Buf (816ec9a8):
60  9  0  0
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  0
return buffer(0x816ec9a8):

DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_SET_DTR ---
DevUpper.sys: IoControl code:  1769508
InputBufferLength:  0     OutputBufferLength:   0   Irp:   0x815f5648
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  0
return buffer(0x0):

DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_SET_LINE_CONTROL ---
DevUpper.sys: IoControl code:  1769484
InputBufferLength:  3     OutputBufferLength:   0   Irp:   0x815f5648
DevUpper.sys: Input Buf (816ec9a8):
 0  0  8
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  0
return buffer(0x816ec9a8):

DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_SET_CHARS ---
DevUpper.sys: IoControl code:  1769564
InputBufferLength:  6     OutputBufferLength:   0   Irp:   0x815f5648
DevUpper.sys: Input Buf (816ec9a8):
 0  0  0  0 11 13
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  0
return buffer(0x816ec9a8):

DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_SET_HANDFLOW ---
DevUpper.sys: IoControl code:  1769572
InputBufferLength:  16     OutputBufferLength:   0   Irp:   0x815f5648
DevUpper.sys: Input Buf (816ec9a8):
 9  0  0 80 80  0  0 80 50  0  0  0 c8  0  0  0
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  0
return buffer(0x816ec9a8):

DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

============================================================

===============    Win32调用SetTimeouts    ==============

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_SET_TIMEOUTS ---
DevUpper.sys: IoControl code:  1769500
InputBufferLength:  20     OutputBufferLength:   0   Irp:   0x815f5648
DevUpper.sys: Input Buf (816ec9a8):
 a  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 88 13  0  0
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  0
return buffer(0x816ec9a8):

DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine

===============  Win32设置WAIT_MASK   =====================

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_SET_WAIT_MASK ---
DevUpper.sys: IoControl code:  1769540
InputBufferLength:  4     OutputBufferLength:   0   Irp:   0x815f5648
DevUpper.sys: Input Buf (816ec9a8):
a0  0  0  0
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x815f5648
info:  0
return buffer(0x816ec9a8):

DevUpper.sys: -  Exit Completion routine...
DevUpper.sys: - Exit FilterIoControl routine


==============   开始等待Mask    ======================

DevUpper.sys: + Enter FilterIoControl routine
DevUpper.sys: ---  IOCTL_SERIAL_WAIT_ON_MASK ---
DevUpper.sys: IoControl code:  1769544
InputBufferLength:  0     OutputBufferLength:   4   Irp:   0x815f5648
DevUpper.sys: - Exit FilterIoControl routine



=============      开始读取数据    ======================
DevUpper.sys: +  Enter Filter Read routine
InputBufferLength:  0     OutputBufferLength:   80   Irp:   0x817f2008
DevUpper.sys: -  Exit Filter Read routine
注意这里：  很快返回，但是Read IRP没有完成。在下面有数据到达以后才完成。

NTICE: Unload32 MOD=NAVEX32A
NTICE: Unload32 MOD=NAVENG32
NTICE: Unload32 MOD=Navap32
NTICE: Unload32 MOD=navscan
NTICE: Unload32 MOD=Navapi32
NTICE: Unload32 MOD=wininet
NTICE: Unload32 MOD=sensapi
NTICE: Exit32 PID=55C  MOD=NDETECT

==========  通过COM10串口向本串口（Com9）发送数据“1”
DevUpper.sys: +  Enter Completion routine...
CompletionRoutine:  Irp:  0x817f2008
info:  1
return buffer(0x816a6708):
31
DevUpper.sys: -  Exit Completion routine...

=========  上层Win32继续发送ReadFile   =============
DevUpper.sys: +  Enter Filter Read routine
InputBufferLength:  0     OutputBufferLength:   80   Irp:   0x817f2008
DevUpper.sys: -  Exit Filter Read routine
