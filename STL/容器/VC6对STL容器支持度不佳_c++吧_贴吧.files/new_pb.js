var Thread={showSetGoodView:function(B){var C=400;var A=125;var E=(screen.width-C)/2;var D=(screen.height-A)/2;window.open(B,"","width=400,height=125,top="+D+",left="+E+",scrollbars=0,resizable=0")},showRemoveTip:function(B,A){var C=B+escape(PageData.forum_url);if(A){if(confirm("此主题已有较多回复，您确认要删除?")){window.location.href=C}}else{window.location.href=C}},showManageList:function(){var A=document.getElementById("top_good");if(A.style.display=="none"){A.style.display="block"}},hideManageList:function(){var A=document.getElementById("top_good");A.style.display="none"}};var Page={isBaiduDomain:function(B){var A=/^((https:\/\/|http:\/\/|ftp:\/\/|rtsp:\/\/|mms:\/\/)(([0-9a-zA-Z\.\-\_]+\.baidu.com)|(baidu.com))\/)/;return A.test(B)},resizePic:function(H,C){var F=C;var I=false;var D=H;if(D.width==0){var E=this;var A=arguments;setTimeout(function(){A.callee.apply(E,A)},100);return false}if(D.width>C){I=true}var B=this.getRightWH(D.width,D.height,C);H.style.width=B[0]+"px";H.style.height=B[1]+"px";H.style.visibility="visible";return I},getRightWH:function(A,C,B){var D=A,E=C;if(A>B){D=B;E=C*B/A}D=parseInt(D);E=parseInt(E);return[D,E]},resetChangedSizeImage:function(C,A){if(C&&A&&C=="old"){if(this.resizePic(A,570)){var D=A;if(Page.isBaiduDomain(D.src)){D.style.cursor="pointer";D.title="点击查看原图";D.onclick=function(I){if(!I){I=window.event}var H=I.target||I.srcElement;if(NsLogLinker.isOutLink(H.src)){NsLogLinker.stat(H.src,110)}window.open(H.src,"_blank")}}}return true}var F=document.getElementsByTagName("IMG");for(var B=0,E=F.length;B<E;B++){var D=F[B];if(D&&D.className=="BDE_Image"&&D.getAttribute("changedsize")=="true"){if(Page.isBaiduDomain(D.src)){D.style.cursor="pointer";D.title="点击查看原图";D.onclick=function(I){if(!I){I=window.event}var H=I.target||I.srcElement;if(NsLogLinker.isOutLink(H.src)){NsLogLinker.stat(H.src,110)}window.open(H.src,"_blank")}}}}},changeNumber:function(H,F){var A=PageData.curr_page_num;var D=PageData.all_page_num;if(F.tagName!="input"&&F.tagName!="INPUT"&&A>0&&A<=D){var C=0;var B=PageData.thread_cur_url;var E=/&pn=[^&]+/;if(E.exec(B)){B=RegExp.leftContext+RegExp.rightContext}C=(A-1+H)*30;if(C>=0&&C<=(D-1)*30){window.location.href=B+"&pn="+C}return true}return false},changeVersion:function(B){var A=PageData.thread_cur_url;var C=/&rs1=[^&]+/;if(C.exec(A)){A=RegExp.leftContext+RegExp.rightContext}window.location.href=A+"&rs1="+B}};var Captcha={forum_id:"",forum_name_u:"",_container_ele:"captcha_container",_content_ele:"captcha_content",_error_ele:"captcha_error",_img_url:"/cgi-bin/genimg?",_audio_url:"/cgi-bin/genaudio?",_need_update:true,sign_str:"",getData:function(){AntiAnswer.antiProcess();var url=AntiAnswer.getVcodeUrl()+"&t="+Math.random();Fe.Ajax.request(url,function(xhr){var return_value=eval("("+xhr.responseText+")");Captcha.sign_str=return_value.nbdSignStr},{async:false});Fe.G("bs").value=Captcha.sign_str},changeYImg:function(A){var B=A;B.src="http://static.tieba.baidu.com/tb/img/errorYimg.jpg"},init:function(){if(!this._need_update){return }this._need_update=false;this.getData();var C=Fe.G("captcha_img");var A=this._img_url+this.sign_str+"&t="+Math.random();if(!C){var B=Fe.G("captcha_img_con");B.innerHTML='<img onerror="Captcha.changeYImg(this);" id="captcha_img" src="'+A+'" style="margin-bottom:-3px;">'}else{C.src=A}Fe.G(this._content_ele).style.display=""},updateImage:function(){Captcha._need_update=false;var B=Fe.G("captcha");B.value="";B.focus();var A=this._img_url+this.sign_str+"&t="+Math.random();Fe.G("captcha_img").src=A},getAudio:function(){Captcha._need_update=false;Fe.G("audio_img").style.display="";var A=Fe.G("captcha_audio");var B=this._audio_url+this.sign_str+"&t="+Math.random();if(!document.all){A.innerHTML='<embed src="'+B+'" name="MediaPlayer" type="video/x-ms-wmv" autostart="1" showcontrols="1" allowscan="1" playcount="1" enablecontextmenu="0" height="0" width="0"></object>'}else{A.innerHTML='<object height=0 width=0 classid=CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6><param name="AutoStart" value="1"><param NAME="url" value="'+B+'"><param name="PlayCount" value="1">'}Fe.G("captcha").focus()},show:function(){Fe.G(Captcha._container_ele).style.display="";var B=Fe.G(Captcha._content_ele);if(B.innerHTML!=""){return }var A='<table style="width:auto;"><tr><td id="captcha_img_con"></td><td valign="bottom">&nbsp;&nbsp;<a href="" onclick="Captcha.updateImage();return false;">看不清?</a>&nbsp;<a href="" id="listen_vcode"  onclick="Captcha.getAudio();return false;">收听验证码</a></td><td valign="bottom"><img id="audio_img" src="http://static.tieba.baidu.com/tb/img/audio.gif" style="display:none;vertical-align:top;"><span id="captcha_audio"></span></td></tr></table>';B.innerHTML=A;if(AntiAnswer.answer.showShenshou==1&&Fe.G("captcha_tip")){Fe.G("captcha_tip").innerHTML="为抵御爆吧挖坟危害，本吧吧主已暂时放出贴吧神兽--超级验证马。";if(Fe.G("captcha")){Fe.G("captcha").style.imeMode="active"}if(Fe.G("listen_vcode")){Fe.G("listen_vcode").style.display="none"}}},hide:function(){Fe.G(Captcha._container_ele).style.display="none";Fe.G(Captcha._content_ele).style.display="none";Fe.G("captcha").value="";var A=Fe.G(Captcha._error_ele);A.innerHTML="";A.style.display="none"},controlVerify:function(A){if(A>5000){Captcha.show();return 1}AntiAnswer.antiProcess();if(PageData.need_captcha){Captcha.show();return 1}else{Captcha.hide();return 0}},reset:function(){this._need_update=true}};var SignNameApply={getSignNameUrl:"/f?ct=503316480&cm=60001&tn=jsonSignName&t="+new Date().getTime().toString(36),isFirst:true,active:function(){var B=this.postProcess;if(this.isFirst){this.isFirst=false;var A=this.getSignNameUrl;new Ajax.Request(A,{method:"get",parameters:"",onComplete:function(C){B(C)}})}},postProcess:function(xmlHttp){var json=eval("("+xmlHttp.responseText+")");if(!json.hasError){var viewAllUrl="/i/sys/jump?type=signsetting";var use="";SignNameApply.tbs5=json.tbs5;SignNameApply.tbs6=json.tbs6;SignNameApply.select_sign=json.select_sign;if(json.useSign==1){if(json.signNames.length>0){if(SignNameApply.select_sign){var html='<input type="checkbox" name="useSignName" id="useSignName" checked onclick="SignNameApply.useSignNameClick(this)"><label for="useSignName">使用签名档</label>&nbsp;<span id="signNameShow"><select name= "signName" id="signName" onchange="SignNameApply.selectChange(this)">'}else{var html='<input type="checkbox" name="useSignName" id="useSignName" onclick="SignNameApply.useSignNameClick(this)"><label for="useSignName">使用签名档</label>&nbsp;<span id="signNameShow" style="display:none"><select name= "signName" id="signName" onchange="SignNameApply.selectChange(this)">'}for(var i=0;i<json.signNames.length;i++){if(i==json.selectIndex){html+="<option value='"+json.signNames[i].id+"' selected>"+json.signNames[i].name+"</option>"}else{html+="<option value='"+json.signNames[i].id+"'>"+json.signNames[i].name+"</option>"}}html+='</select>&nbsp;<a href="'+viewAllUrl+'" target="_blank" style="color:#0449be">查看全部</a></span>';G("signNamePanel").innerHTML='<div id="signNameWrapper">'+html+"</div>"}else{var html='<input type="checkbox" name="useSignName" id="useSignName" onclick="SignNameApply.useSignNameClick(this)"><label for="useSignName">使用签名档</label>&nbsp;<span id="signNameShow" style="display:none"><span style="color:#666666">（您目前没有可使用的签名档，<a href="'+viewAllUrl+'" target="_blank" style="color:#0449be">查看全部</a>）</span></span>';G("signNamePanel").innerHTML='<div id="signNameWrapper">'+html+"</div>"}G("signNamePanel").style.display=""}else{G("signNamePanel").style.display="none"}}},_showSignName:function(){},useSignNameClick:function(C){if(C.checked){G("signNameShow").style.display="";var A=1}else{G("signNameShow").style.display="none";var A=0}var B="/f";new Ajax.Request(B,{method:"post",parameters:"ct=369098752&cm=2714&rs5="+SignNameApply.tbs5+"&rs6="+SignNameApply.tbs6+"&rn="+A+"&tn=iframeSubmit",onComplete:function(D){}})},selectChange:function(A){G("useSignName").checked=true}};var MemTip=(function(){var D=null;function I(J){if(J){D=J;var L=A(J);var K=H();K.style.left=(L[0]-15)+"px";K.style.top=(L[1]-125)+"px";K.style.display=""}}function B(){var J=H();J.style.display="none"}function F(N,L,K){var J='<div id="memTipPanel" style="float:left;width:208px; font-size:12px; line-height: 22px; display:inline; margin-left: 10px;">';if(N){J+='<div id="memTipTitle" style="font-weight:bold; margin-top: 10px;">'+N+"</div>"}if(L){J+=L}J+='</div><div  id="memTipClosePanel" style="float:right;padding: 10px 10px 0px 0px;"><a id="memTipMemTipClose" href="javascript:void(0)" style="display:block; width: 15px;height: 15px;" onclick="MemTip.hide()"></a></div><div style="clear:both"></div>';var M=H();if(M){if(K){M.style.background=K}M.innerHTML=J}}function A(J){var K=curtop=0;if(J.offsetParent){K=J.offsetLeft;curtop=J.offsetTop;while(J=J.offsetParent){K+=J.offsetLeft;curtop+=J.offsetTop}}return[K,curtop]}function H(){var J=document.getElementById("memTipDiv");if(!J){J=document.createElement("div");J.id="memTipDiv";J.style.width="245px";J.style.height="120px";J.style.position="absolute";J.style.zIndex="2000";J.style.display="none";E(document,"click",C);document.body.appendChild(J)}return J}function C(L){var K=L.target||event.srcElement;if(K!=D){var M=["memTipDiv","memTipPanel","memTipTitle","memTipClosePanel"];var J=0;for(J=0;J<M.length;J++){if(document.getElementById(M[J])==K){break}}if(J==M.length){MemTip.hide()}}}function E(L,J,K){if(window.addEventListener){L.addEventListener(J,K,false)}else{if(window.attachEvent){L.attachEvent("on"+J,K)}}}return{buildHTML:function(L,K,J){F(L,K,J)},show:function(J){I(J)},hide:function(){B()}}})();function showMemTip(C){var D="会员发贴：";var B="只允许本吧会员在登录状态下发贴。<br>请检查一下您是否已经登录，以及是否<br>已经加入本吧会员。";var A="url('http://static.tieba.baidu.com/tb/img/infotip.gif') no-repeat";MemTip.buildHTML(D,B,A);MemTip.show(C)}var BdeText={EH:Element.hide,ES:Element.show,IE:Browser.IE,Gecko:Browser.Gecko,Opera:Browser.Opera,Safari:(navigator.userAgent.indexOf("Safari")>-1),Chrome:(navigator.userAgent.indexOf("Chrome")>-1),Pop:Popup,E:Event,textPanel:"bdeTextPanel",textTool:"bdeTextTool",textArea:"bdeTextArea",uneditToolbar:"bdeUneditToolbar",uneditArea:"bdeUneditArea",popup:null,body:null,listeners:{},urlLength:1024,path:"/tb/editor/",G:function(A){return document.getElementById(A)},getBody:function(){var A=this;if(!A.body){A.body=A.G(A.textArea)}return A.body},appendHtml:function(B){if(!B||B==""){return }var A=this.getBody();if(this.isEmptyContent(A.innerHTML)){A.innerHTML=B}else{A.innerHTML=A.innerHTML+B}},clearHtml:function(){var A=this.getBody();if(this.IE){A.innerHTML=""}else{A.innerHTML="<br>"}},getImageNum:function(){return this.getElemNum("IMG","BDE_Image")},getSmileyNum:function(){return this.getElemNum("IMG","BDE_Smiley")},getFlashNum:function(){var A=this.getElemNum("EMBED","BDE_Flash");if(!this.IE){A+=this.getElemNum("IMG","BDE_Flash")}return A},getMusicNum:function(){var A=this.getElemNum("EMBED","BDE_Music");if(!this.IE){A+=this.getElemNum("IMG","BDE_Music")}return A},isEmpty:function(){return this.isEmptyContent(this.getBody().innerHTML)},getHtml:function(){var M=this;M.reLayout();var L=M.setAttribute,J=M.getAttribute;var K=document.createElement("SPAN");K.innerHTML=M.getBody().innerHTML;M.parseURL(K);var H="";if(M.IE){var B=M.tags(K,"A");for(var E=0,C=B.length;E<C;E++){B[E].target="_blank"}var I=M.tags(K,"EMBED");for(var E=0,C=I.length;E<C;E++){L(I[E],"style",null)}var F=M.tags(K,"IMG");for(var E=0,C=F.length;E<C;E++){L(F[E],"style",null)}H=M.clearEmailLink(K.innerHTML)}else{var F=M.tags(K,"IMG");for(var E=0,C=F.length;E<C;E++){var D=F[E];if(D.className=="BDE_Flash"||D.className=="BDE_Music"){var A=document.createElement("EMBED");L(A,"class",D.className);L(A,"type","application/x-shockwave-flash");L(A,"pluginspage","http://www.macromedia.com/go/getflashplayer");L(A,"wmode","transparent");L(A,"play","true");L(A,"loop","false");L(A,"menu","false");L(A,"src",J(D,"flash_url"));L(A,"width",J(D,"width"));L(A,"height",J(D,"height"));L(A,"allowscriptaccess","never");L(A,"allowfullscreen","true");L(A,"scale","noborder");D.parentNode.insertBefore(A,D);L(D,"src",null);D.style.display="none"}}for(var E=F.length-1;E>=0;E--){if(F[E].className=="BDE_Flash"||F[E].className=="BDE_Music"){F[E].parentNode.removeChild(F[E])}}H=K.innerHTML}return M.replace(H,[[/<p *>/gi,""],[/< *\/p *>\r?\n/gi,"<br>"],[/< *\/p *>/gi,""],[/<p\/>/gi,"<br>"],[/<div><br><\/div>/gi,"<br>"],[/<div *>/gi,"<br>"],[/< *\/div *>\r?/gi,""],[/<div\/>/gi,"<br>"],[/<\/?strong>/gi,""],[/<\/?u>/gi,""],[/<\/?i>/gi,""],[/<\/?b>/gi,""],[/<\/?em>/gi,""]])},focus:function(){if(this.isEmpty()){this._focus()}else{this.focus2end()}},init:function(){if(this.Gecko){var A=this.getBody();if(A){A.innerHTML="<br>"}}},isSuport:function(){var A=this;var C=navigator.userAgent.toString();var B=["iPhone","Symbian","Mobile","Nokia","CellPhone","Sony","Windows CE","SmaryPhone","Samsung","J2ME","Opera Mini"];if(A.isIn(C,B)){return false}if(A.isUCWeb()){return false}return(this.Gecko||this.IE||this.Safari||this.Opera||this.Chrome)},isIn:function(C,B){for(var A=0;A<B.length;A++){if(C.indexOf(B[A])>-1){return true}}return false},isUCWeb:function(){var A=navigator.userAgent.toString();if(A.indexOf("X11;")>-1&&A.indexOf("Linux i686;")>-1&&A.indexOf("Gecko")>-1&&A.indexOf("Firefox")<0&&A.indexOf("Opera")<0){return true}return false},doImage:function(){this.saveFocus(true);this.createPopup(this.path+"quick/image.html?v=1",540,120,"插入图片")},doFlash:function(){this.saveFocus(true);this.createPopup(this.path+"quick/flash.html?v=1.3",540,120,"插入视频")},doSmiley:function(){var A=this;A.saveFocus();if(!A._smileyLoaded){A._smileyLoaded=true;A.loadSmiley()}A.createPopup(A.path+"quick/smiley.html?v=1",420,295,"插入表情")},doMusic:function(){var me=this;me.saveFocus(true);var lookmsg='<div style="padding:15px;">友情提示：此功能需要启用“发贴插入音乐”道具，你<br>可以使用贴吧豆到贴吧商城购买。<div style="text-align:center;padding-top:10px;"><a href="/m/money" target="_blank">到贴吧商城看看</a></div></div>';Fe.Ajax.get("/m/buff/get?id=3&stamp="+new Date().getTime(),function(response){var json=eval("("+response.responseText+")");if(json.error_no==0){if(json.msg&&json.msg.buff_id>0){me.createPopup(me.path+"quick/music.html?v="+new Date().getTime(),500,400,"插入音乐")}else{me.ensureFocus();Fe.Dialog.open(lookmsg,{title:""})}}else{if(json.error_no=="4"){me.ensureFocus();Fe.Dialog.open(lookmsg,{title:""})}else{me.ensureFocus();Fe.Dialog.alert('<div style="padding:15px;">'+json._info+"</div>",{title:""})}}})},_smileyLoaded:false,loadSmiley:function(){var B=this.path+"images/default/";var D=["jFace.gif","fFace.gif","wFace.gif","tFace.gif","bFace.gif"];for(var C=0,A=D.length;C<A;C++){(new Image()).src=B+D[C]}},listen:function(B,C){if(B&&C){var A=this.listeners;if(typeof (A[B])!="object"){A[B]=[]}(A[B])[A[B].length]=C}},dispatch:function(C){var B=this.listeners;if(B[C]){for(var A=0;A<B[C].length;A++){B[C][A].call(null,C)}}},dispatchDelay:function(A){var B=this;if(B.scTimer){clearTimeout(B.scTimer);delete B.scTimer}B.scTimer=setTimeout(function(){B.dispatch(A)},100)},doPasteIE:function(B){var C=clipboardData.getData("Text");if((!C)||C==""){return true}var A=this;C=A.replace(C,[[/&/g,"&amp;"],[/</g,"&lt;"],[/>/g,"&gt;"],[/\r?\n/g,"<br>"],[/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;"],[/\s/g,"&nbsp;"],[/\u3000/g,"&nbsp;&nbsp;"]]);A.paste(C);setTimeout(function(){A.dispatch("oneditorpaste")},50);return false},doPasteGecko:function(B){var A=this;setTimeout(function(){A.filte();A.dispatch("oneditorpaste")},50);return(B.returnValue=true)},pasteHandler:function(A){if(this.IE){return this.doPasteIE(A)}else{return this.doPasteGecko(A)}},selectionChangeHandler:function(B){var A=this;setTimeout(function(){A.reLayout();A.dispatch("oneditorselectionchange")},100)},focusHandler:function(A){this.dispatch("oneditorfocus")},clickHandler:function(A){this.dispatch("oneditorclick")},keydownHandler:function(H){if(!BdeText.IE){return }var E=window.event||H;var A=8;var F=E.which||E.keyCode||E.charCode;if(E.ctrlKey||E.metaKey||E.shiftKey||E.altKey){return(E.returnValue=true)}else{if(F==A&&this.IE){var D=document.selection;if("control"==D.type.toLowerCase()){var B=D.createRange();for(var C=B.length-1;C>=0;C--){B(C).parentNode.removeChild(B(C))}return(E.returnValue=false)}}}return(E.returnValue=true)},keyUpHandler:function(A){this.dispatchDelay("oneditorkeyup")},hasFocus:function(){return(document.activeElement==this.getBody())},ieControl:null,ieCursor:null,saveFocus:function(A){var E=this;if(E.IE){try{if(!E.hasFocus()){if(A&&(!E.isEmpty())){E.getBody().innerHTML=E.getBody().innerHTML+"<br>"}E.focus2end()}E.ieControl=null;E.ieCursor=null;var C=document.selection;var D=C.createRange();var B=C.type.toLowerCase();if("control"==B){var F=D(0);E.ieControl=F}else{if("none"==B||"text"==B){D.select();D.pasteHTML("<img id='BDE_cursor' class='BDE_Image' style='width:1px;height:1px'>");D.select();E.ieCursor="BDE_cursor"}}}catch(H){}}},ensureFocus:function(C){var B=this;if(B.IE){try{B.getBody().setActive();var A=null;if(B.ieControl){A=document.body.createControlRange();A.addElement(B.ieControl);A.select();B.ieControl=null}else{if(B.ieCursor){A=document.body.createControlRange();A.addElement(B.G(B.ieCursor));A.select();B.paste("");B.ieCursor=null}else{if(!B.isEmpty()){B.getBody().innerHTML=B.getBody().innerHTML}}}}catch(C){}}else{if(B.Gecko||B.Opera){B.getBody().focus()}else{if(B.isEmpty()){B.focus()}}}},_focus:function(){this.getBody().focus()},focus2end:function(){var D=this;try{var A=D.getBody();A.focus();if(D.IE){A.innerHTML=A.innerHTML}else{if(window.getSelection){var B=window.getSelection();var C=document.createRange();C.setStartAfter(A.lastChild);C.setEndAfter(A.lastChild);B.removeAllRanges();B.addRange(C)}}}catch(E){}},replace:function(C,B){for(var A=0;A<B.length;A++){C=C.replace(B[A][0],B[A][1])}return C},tags:function(B,A){return B.getElementsByTagName(A)},getElemNum:function(D,E){var F=0;var A=this.tags(this.getBody(),D);for(var C=0,B=A.length;C<B;C++){if(A[C].className==E){F++}}return F},setAttribute:function(B,A,C){if(C==null||C.length==0){B.removeAttribute(A,0)}else{B.setAttribute(A,C,0)}},getAttribute:function(E,D,C){var B=E.attributes[D];if(B==null||!B.specified){return C||""}var A=E.getAttribute(D,2);if(!A){A=B.nodeValue}return A||C},paste:function(A){var C=this;var D=document;if(C.IE){if(D.selection.type.toLowerCase()=="control"){D.execCommand("Delete",false,null)}var B=D.selection.createRange();B.select();B.pasteHTML(A);B.collapse(false);B.select()}else{D.execCommand("insertHTML",false,A)}},filte:function(){var E=this;E.paste("<img id='BDE_cursor' class='BDE_Image' style='width:1px;height:1px'>");var A=E.getBody();var C=A.innerHTML;C=E.replace(C,[[/\[/g,"[[-"],[/\]/g,"-]]"],[/<img ([^>]*class=["']?(BDE_Image|BDE_Flash|BDE_Music|BDE_Smiley)["']?[^>]*)>/gi,"[img $1]"],[/<br[^>]*( *\/?)>/gi,"[br$1]"],[/<\/ ?p[^>]*>/gi,"[br]"],[/<table[^>]*>/gi,"[br]"],[/<\/ ?tr[^>]*>/gi,"[br]"],[/<\/ ?td[^>]*>/gi,"&nbsp;&nbsp;"],[/<(ul|dl|ol)[^>]*>/gi,"[br]"],[/<(li|dd)[^>]*>/gi,"[br]"],[/<script[^>]*>(.|\r?\n)*<\/script>/gi,""],[/<xml[^>]*>(.|\r?\n)*<\/xml>/gi,""],[/<style[^>]*>(.|\r?\n)*<\/style>/gi,""],[/<applet[^>]*>(.|\r?\n)*<\/applet>/gi,""],[/<object[^>]*>(.|\r?\n)*<\/object>/gi,""],[/<!--(.*)-->/gi,""],[/<[^>]*>/gi,""],[/\[img ([^\]]*)\]/gi,"<img $1>"],[/\[br( *\/?)\]/gi,"<br$1>"],[/\[\[\-/g,"["],[/\-\]\]/g,"]"]]);A.innerHTML=C;var B=document.createRange();B.selectNode(document.getElementById("BDE_cursor"));var D=window.getSelection();D.removeAllRanges();D.addRange(B);if(E.Safari){E.paste("")}else{B.deleteContents()}},parseURL:function(E){var B="(=*+)",A="(+*=)";var D=4;var C=function(F){if(F.nodeType==3){var H=F.nodeValue;if(H&&H.length>D){H="."+H;H=H.replace(/([^0-9a-zA-Z])((www\.|http:\/\/|mms:\/\/|rtsp:\/\/|ftp:\/\/|https:\/\/)[0-9a-zA-Z\.\!\~\#\?\:\/\&\%\-\+\*\'\=\@\_\$]+)/gi,"$1"+B+'a href="$2" target="_blank"'+A+"$2"+B+"/a"+A);H=H.substring(1);F.nodeValue=H}}else{if(F.nodeType==1){var I=F.firstChild;while(I){if(I.nodeName.toUpperCase()!="A"){C(I)}I=I.nextSibling}}}};C(E);E.innerHTML=this.replace(E.innerHTML,[[/\(\=\*\+\)a\ href="www\./gi,'<a href="http://www.'],[/\(\=\*\+\)/gi,"<"],[/\(\+\*\=\)/gi,">"]])},isEmptyContent:function(A){if(!A){return true}return(""==this.replace(A,[[/<br *\/?>/gi,""],[/<\/?p *\/?>/gi,""],[/<\/?a *\/?>/gi,""],[/&nbsp;/g,""],[/(\r?\n)+/g,""],[/[\u3000\s]+/g,""]]))},clearEmailLink:function(A){return A.replace(/<a[^>]*href=[\'\"]?mailto[^>]*>([^>]*)<\/a>/gi,"$1")},reLayout:function(){var L=this;var J=L.setAttribute,H=L.getAttribute;var N=function(Q,O){var P=0;if(O=="width"){P=Q.width}else{if(O=="height"){P=Q.height}}return parseInt((P+"").replace(/px/g,""))};var A=function(Q,O,T){var P=N(Q,O);var S=(O=="width"?"height":"width");var R=N(Q,S);if(P>T||P<0){J(Q,O,T);if(P<0){P=-P}J(Q,S,R*(T/P));return true}else{J(Q,O,P);J(Q,S,R);return false}};var B=function(R,P){var Q=N(R,"height");var O=N(R,"width");if(P.toLowerCase().indexOf("player.video.qiyi.com")>-1){J(R,"width",500);J(R,"height",415)}else{if(P.toLowerCase().indexOf("baidu.com")>-1){J(R,"width",480);J(R,"height",410)}else{J(R,"width",500);J(R,"height",450)}}};var I=L.getBody();var F=L.tags(I,"IMG");for(var E=0;E<F.length;E++){var D=F[E];if(D.className=="BDE_Image"){if(A(D,"width",570)){J(D,"changedsize","true")}}else{if(D.className=="BDE_Flash"){B(D,H(D,"flash_url"))}else{if(D.className=="BDE_Music"){A(D,"width",570)}else{if(D.className=="BDE_Smiley"){var C=false;if(N(D,"width")>40||N(D,"height")>40){J(D,"width",40);J(D,"height",40)}else{J(D,"width",N(D,"width"));J(D,"height",N(D,"height"))}if(C){J(D,"changedsize","true")}}}}}}var K=L.tags(I,"EMBED");for(var E=0;E<K.length;E++){var M=K[E];if(M.className=="BDE_Flash"){B(M,H(M,"src"))}else{if(M.className=="BDE_Music"){A(M,"width",570)}}}},createPopup:function(B,A,D,C){var E=this;E.popup=new E.Pop({width:A,height:D,title:C});E.popup.setContent("callBackCancel",function(){E.ensureFocus();return true});E.popup.xwindow(B,C)},closePopup:function(){if(this.popup){this.popup.close()}},formatURL:function(A){return this.replace(A,[[/[\u3000\s]+/g,""],[/\\/g,"/"],[/</g,""],[/>/g,""],[/"/g,""],[/;/g,""],[/\(/g,""],[/\)/g,""]])}};var ContentTextInput={ES:Element.show,EH:Element.hide,E:Event,_area:null,init:function(){var A=this;A._area=G("textInput");A._area.value="";A.EH("editorInput");A.ES(A._area);return A},getHtml:function(){return this._area.value.replace(/&/gi,"&amp;").replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/\r?\n/gi,"<br>").replace(/[\u3000\s]/gi,"&nbsp;").replace(/\t/gi,"&nbsp;&nbsp;&nbsp;&nbsp;")},isEmpty:function(){var A=this._area;return !(A&&A.value&&A.value.replace(/[\u3000\s]/gi,"").replace(/\r?\n/gi,"").replace(/\t/gi,"")!="")},appendHtml:function(A){var B=A.replace(/<br>/gi,"\r\n").replace(/<[^>]*>/gi,"").replace(/&nbsp;/gi," ").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&");return this._area.value=this._area.value+B},clearHtml:function(){this._area.value=""},getImageNum:function(){return 0},getSmileyNum:function(){return 0},getFlashNum:function(){return 0},focus:function(){var A=this._area;if(A){A.focus();A.value=A.value}},listen:function(B,A){var C=this;if(B=="oneditorfocus"){C.E.observe(C._area,"focus",A,false)}else{if(B=="oneditorkeyup"){C.E.observe(C._area,"keyup",A,false)}else{if(B=="oneditorclick"){C.E.observe(C._area,"click",A,false)}else{if(B=="oneditorpaste"){C.E.observe(C._area,"paste",A,false)}}}}}};ContentInput=BdeText;var PostEditor={is_login:false,need_captcha:true,is_new_version:true,_tip:[[],["","本吧目前仅限登录用户发贴，不能使用匿名发贴功能",],["抱歉，本吧目前仅限吧务团队及注册满一定时间的老用户发贴","本吧目前仅限吧务团队及注册满一定时间的老用户发贴，不能使用匿名发贴功能"],["抱歉，根据相关法律法规和政策，本吧目前仅限会员发贴","本吧目前仅限会员发贴，不能使用匿名发贴功能"],["抱歉，本吧目前仅限吧务团队发贴","本吧目前仅限吧务团队发贴，不能使用匿名发贴功能"],["抱歉，根据相关法律法规和政策，本吧目前只能浏览，不能发贴","抱歉，根据相关法律法规和政策，本吧目前只能浏览，不能发贴"]],_showBannedTip:function(D,F,H){var C=null;var B="";if(H==1){C=Fe.G("editor_banned_tip");if(C!=null){C.style.display="none"}if(D>0){C=Fe.G("msg_cannot_anonym");B="（"+this._tip[D][1]+"）"}}else{C=Fe.G("editor_banned_tip");B='<div class="editor_banned_tip_info">'+this._tip[D][0];B=B+(D==1?"":"<br />");if(!F){var E='<a href="#" onclick="TbUtil.login();return false;">登录</a> | <a href="#" onclick="TbUtil.register();return false;">注册</a>&nbsp;';B=B+(D==1?"本吧发贴，请先 ":"你可以先 ")+E}else{var A='<a href="#" onclick="showMemTip(this);return false;">什么是会员发贴？</a>';B=B+(D==3?A:"")}B+="</div>";PostEditor.disable()}if(C){C.innerHTML=B}},showLoginAndReg:function(){Fe.G("login_reg").innerHTML='您目前是匿名发表 <a href="#" onclick="TbUtil.login();return false;">登录</a> | <a href="#" onclick="TbUtil.register();return false;">注册</a>'},init:function(A,B,C){this.is_login=B;C=parseInt(C);this._showBannedTip(A,B,C);if(PostEditor.is_new_version){this._initRichEidtor()}},_initRichEidtor:function(){var A=ContentInput.isSuport();if(!A){ContentInput=ContentTextInput}ContentInput.init();ContentInput.listen("oneditorselectionchange",PostEditor.delayInitCaptchaAndSign);ContentInput.listen("oneditorclick",PostEditor.delayInitCaptchaAndSign);ContentInput.listen("oneditorfocus",PostEditor.delayInitCaptchaAndSign);ContentInput.listen("oneditorkeyup",PostEditor.delayInitCaptchaAndSign);ContentInput.listen("oneditorpaste",PostEditor.delayInitCaptchaAndSign);if(!A){PostEditor.initCaptchaAndSign()}},delayInitCaptchaAndSign:function(){setTimeout(PostEditor.initCaptchaAndSign,500)},_validPostLength:function(){var A=0;if(PostEditor.is_new_version){A=ContentInput?Fe.String.getByteLength(ContentInput.getHtml()):0}else{A=Fe.String.getByteLength(Fe.G("co").value)}return A>5000?false:true},_setAble:function(B,C){var A=Fe.G(B);if(!A){return }if(C){A.className=""}A.disabled=false},_setDisable:function(B,C){var A=Fe.G(B);if(!A){return }A.disabled=true;if(C){A.className="notPostbg"}},enable:function(){if(PostEditor.is_new_version){ContentInput.setEditable(true)}else{this._setAble("ti",true);this._setAble("co",true);this._setAble("str1",true)}Fe.G("add_post_submit").disabled=false}};PostEditor.disable=function(){this._setDisable("ti",true);this._setDisable("co",true);this._setDisable("str1",true);var A=Fe.G("post_user");if(A){Fe.G("post_user").style.display="none"}Fe.G("add_post_submit").disabled=true};PostEditor.initCaptchaAndSign=function(){AntiAnswer.antiProcess();if(PostEditor.is_new_version){if(PostEditor.is_login&&Fe.G("post_login").checked){Fe.G("signNamePanel").style.display="";SignNameApply.active()}else{var A=Fe.G("signNamePanel");if(A){A.style.display="none"}}}if(PageData.need_captcha==1||!PostEditor._validPostLength()){Captcha.show()}else{Captcha.hide()}};var Post={};Post.showAddResult=function(xhr){var doAction=function(result){switch(result.getActionType()){case result.Action_FocusTitle:if(document.post.ti){document.post.ti.focus();document.post.ti.value=document.post.ti.value}break;case result.Action_FocusContent:if(PostEditor.is_new_version){setTimeout(function(){ContentInput.focus()},400)}else{Fe.G("co").focus()}break;case result.Action_ClearYZM:if(document.post.captcha){document.post.captcha.value="";document.post.captcha.focus()}break;case result.Action_FocusUrl:if(PostEditor.is_new_version){setTimeout(function(){ContentInput.focus()},400)}else{Fe.G("str1").focus();Fe.G("str1").value=Fe.G("str1").value}break;case result.Action_GoToHead:document.location.hash="pgTop";break;case result.Action_FlushAndGoToHead:if(PostEditor.is_new_version){ContentInput.clearHtml()}else{Fe.G("ti").value="";Fe.G("co").value=""}document.location.href=document.location.href.split("#")[0];break;default:break}};var rst=eval("("+xhr.responseText+")");var no=rst.resultNo;if(no==0){var reload_delay_time=500;WealthSystem.action_type="add_post";if(WealthSystem.EditorGuide.isNeed()){WealthSystem.EditorGuide.show();reload_delay_time=3500}setTimeout(function(){doAction(rst)},reload_delay_time)}else{if(rst.isNeedWaitForCheck()){AlertPopup.alertMessage({width:340,height:165,title:"发表贴子",messageTitle:"等待审核...",content:rst.getMessage()},function(){doAction(rst);Fe.G("add_post_submit").disabled=false;return true});document.getElementById("dialogBody").getElementsByTagName("input")[0].focus()}else{AlertPopup.alertError({width:340,height:165,title:"发表贴子",messageTitle:"发贴失败",content:rst.getMessage()},function(){doAction(rst);Fe.G("add_post_submit").disabled=false;return true});document.getElementById("dialogBody").getElementsByTagName("input")[0].focus()}}};Post._getData=function(A){var N=Fe.G(A||"post");var J=Fe.G("post").getElementsByTagName("input");var D=J.length;var E={};var H,C;for(var F=0;F<D;F++){C=J[F].getAttribute("type");H=J[F].getAttribute("name");if((C!="radio")&&H){E[H]=J[F].value}}var I=PageData.is_login;var L=Fe.G("useSignName");var B=Fe.G("post_login");var M=Fe.G("signName");if(I&&B.checked&&L&&L.checked&&M){E.rs10=M.value}if(I&&!B.checked){E.rs1=1}var K=Fe.G("captcha").value;if(K!=""){E.word1=K}return E};Post.Validator={_validRichEditorContent:function(){var A=ContentInput.getImageNum();if(A>g_pg.imageLimite){Fe.G("coError").style.display="";Fe.G("coError").innerHTML="抱歉，每层楼插入的图片不能超过"+g_pg.imageLimite+"张，请修改后重新提交";ContentInput.focus();return false}var C=ContentInput.getFlashNum();if(C>g_pg.flashLimite){Fe.G("coError").style.display="";Fe.G("coError").innerHTML="抱歉，每层楼插入的视频不能超过"+g_pg.imageLimite+"个，请修改后重新提交";ContentInput.focus();return false}var B=ContentInput.getSmileyNum();if(B>g_pg.smileyLimite){Fe.G("coError").style.display="";Fe.G("coError").innerHTML="抱歉，每层楼插入的表情不能超过"+g_pg.smileyLimite+"个，请修改后重新提交";Fe.ContentInput.focus();return false}return true},_validCaptcha:function(){var E=!PostEditor._validPostLength();var B=Fe.G("captcha");var C=Fe.G("captcha_error");var A=B.value;var D=Fe.G("post_anonym");AntiAnswer.antiProcess();if(PageData.need_captcha==1||E){if(A==""||A==null){C.style.display="";C.innerHTML="验证码不能为空，请输入验证码";B.focus();return false}}return true},_validFrsPostTitle:function(){var A=Fe.G("ti");A.value=Fe.String.trim(A.value);title=A.value;if(title==""){Fe.G("tiError").innerHTML="标题不能为空";A.focus();return false}return true}};Post.reply=function(A){if(!PageData.can_post){return false}if(A){if(parseInt(A)>1){if(ContentInput.isEmpty()){ContentInput.appendHtml("回复："+A+"楼<br>")}else{ContentInput.appendHtml("<br>回复："+A+"楼<br>")}}}setTimeout(function(){ContentInput.focus()},300)};Post.add={_valid:function(){if(ContentInput.isEmpty()){Fe.G("coError").style.display="";Fe.G("coError").innerHTML="回复内容不能为空";ContentInput.focus();return false}if(!Post.Validator._validRichEditorContent()){return false}if(!Post.Validator._validCaptcha()){return false}return true},submit:function(){var A="/f";try{if(Post.add._valid()){var B=Post._getData();B.co=ContentInput.getHtml();Fe.G("add_post_submit").disabled=true;Fe.Ajax.post(A,Fe.Object.toQueryString(B),function(D){Post.showAddResult(D)});return false}}catch(C){}}};var OldPbPost={can_post:true,reply:function(C,B){if(!OldPbPost.can_post){return false}var D=Fe.G(B).value;if(C=="0"){D="回复："+Fe.String.trim(D)}else{D=Fe.G(B).value;var A=D.indexOf("：");if(A>=0){D=D.slice(D.indexOf("：")+1)}D="回复"+C+"："+Fe.String.trim(D)}Fe.G("ti").value=D;Fe.G("ti1").value=D;setTimeout(function(){document.post.co.focus();document.post.co.value=document.post.co.value},300);return true},truncateTitle:function(){var C=PageData.title_max_length;var A=Fe.G("ti");var B=A.value;if(A.value.length>C){A.value=B.substring(0,C)}}};OldPbPost.add={_valid:function(){var A=Fe.G("ti");var D=Fe.G("co");A.value=Fe.String.trim(A.value);D.value=Fe.String.trim(D.value);var C=A.value;var B=D.value;if(C==Fe.G("ti1").value&&B.length<1){Fe.G("coError").innerHTML="不允许发布空贴";D.focus();return false}if(C==""){Fe.G("tiError").innerHTML="标题不能为空";A.focus();return false}if(B==""){Fe.G("coError").innerHTML="内容不能为空";D.focus();return false}if(!Post.Validator._validCaptcha()){return false}return true},submit:function(){var A="/f";if(OldPbPost.add._valid()){var B=Post._getData();B.co=Fe.G("co").value;Fe.G("add_post_submit").disabled=true;Fe.Ajax.post(A,Fe.Object.toQueryString(B),function(C){Post.showAddResult(C)})}}};var AntiAnswer={_is_anomy:0,_vcodeUrl:"",answer:{antiNeedVerify:null,antiNeedVerifyA:null},post_type:"thread",forum_name_url:"",forum_id:0,_ifHasKnowAnti:function(A){switch(A){case 1:return !(this.answer.antiNeedVerifyA==null);break;case 0:default:return !(this.answer.antiNeedVerify==null)}},setVcodeUrl:function(A){this._vcodeUrl=A},getVcodeUrl:function(){return this._vcodeUrl},_getAntiAnswer:function(){var _url="/f?ct=486539264&cm=59201&tn=antiAnswerJson&rs1="+(this._is_anomy==1?"1":"0")+"&rs10="+(this.post_type=="thread"?"1":"2")+"&lm="+this.forum_id+"&word="+this.forum_name_url+"&t="+Math.random();Fe.Ajax.request(_url,function(xhr){var rst=eval("("+xhr.responseText+")");AntiAnswer.handleAnswer(rst)},{async:false})},handleAnswer:function(A){if(this._is_anomy==1){AntiAnswer.answer.antiNeedVerifyA=A.nbdAntiNeedVerify}else{AntiAnswer.answer.antiNeedVerify=A.nbdAntiNeedVerify}AntiAnswer.answer.showShenshou=A.nbdShenshou;AntiAnswer.setVcodeUrl(A.vcodeUrl)},antiProcess:function(){this._is_anomy=0;if(Fe.G("post_anonym")&&(Fe.G("post_anonym").checked)){this._is_anomy=1}var A="";if(!this._ifHasKnowAnti(this._is_anomy)){this._getAntiAnswer()}if(this._is_anomy){A=this.answer.antiNeedVerifyA}else{A=this.answer.antiNeedVerify}if(A=="1"){PageData.need_captcha=1}else{PageData.need_captcha=0}},init:function(B,C,A){this.forum_name_url=B;this.forum_id=C;if(A=="reply"){this.post_type="reply"}}};function userLogin(){TbUtil.login()}var ForumFlashBuilder={buildEmbed:function(C,A){var B=this.getEmbedHtml(A);if(C===undefined){document.write(B)}else{document.getElementById(C).innerHTML=B}},buildObjAndEmbed:function(C,A){var B=this.getObjAndEmbedHtml(A);if(C===undefined){document.write(B)}else{document.getElementById(C).innerHTML=B}},getEmbedHtml:function(A){var B='<embed id="'+(A.id||"")+'" class="'+(A.className||"")+'" pluginspage="http://www.macromedia.com/go/getflashplayer"';B+=' src="'+A.src+'"';B+=' width="'+(A.width||550)+'" height="'+(A.height||480)+'"';B+=' type="application/x-shockwave-flash" wmode="transparent" play="true" loop="false" ';B+=' menu="false" allowscriptaccess="'+(A.allowscriptaccess||"always")+'" scale="noborder">';return B},getObjAndEmbedHtml:function(A){var B='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"';B+=' codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9.0.0" ';B+='WIDTH="'+(A.width||550)+'" HEIGHT="'+(A.height||480)+'" id="voteFlash">';B+='<PARAM NAME=movie VALUE="'+A.src+'">';B+="<PARAM NAME=quality VALUE=high>";B+="<PARAM NAME=allowScriptAccess VALUE="+(A.allowscriptaccess||"always")+">";B+=this.getEmbedHtml(A);B+="</object>";return B}};function showcpro(A){document.getElementById("cproshow").innerHTML=A}function checkErrorImage(B){var A=B.parentNode;A.innerHTML="<br><img src='http://yourimgloaderroratbaidu' border='0'/>"}function h(B,A){B.style.behavior="url(#default#homepage)";B.setHomePage(A)}function ss(A){window.status=A;return true}function cs(){window.status=""}function ga(B,A){if(document.getElementById){a=B.id.substring(1);p="";r="";g=A.target;if(g){t=g.id;f=g.parentNode;if(f){p=f.id;h=f.parentNode;if(h){r=h.id}}}else{h=A.srcElement;f=h.parentNode;if(f){p=f.id}t=h.id}if(t==a||p==a||r==a){return true}window.open(document.getElementById(a).href,"_blank")}}Page.showSuccessTip=function(C,B){var A='<div style="padding:20px 0 0 0;line-height:18px;font-size:14px;text-align:center;">'+B.replace(/\r?\n/gi,"<br>")+"</div>";Fe.Dialog.open(A,{title:C,width:340,height:90,buttonClose:false})};Page.showErrorTip=showErrorTip=function(C,B){var A='<div style="padding:20px 6px 12px 6px;line-height:18px;font-size:14px;text-align:center;">'+B.replace(/\r?\n/gi,"<br>")+"</div>";Fe.Dialog.alert(A,{title:C,width:380})};Thread.forward=function(){if(PageData.is_login){var B='<div id="tb_forward_cnt" style="padding:10px 30px 6px 30px;font-size:14px;"><h4 style="font-size:12px;color:#666;padding-bottom:4px;">添加评论：</h4><div style="position:relative;font-size:12px;"><p id="tb_forward_comment_guide" style="color:#BFBFBF;position:absolute;top:6px;left:6px;">说点什么吧，选填...</p><textarea id="tb_forward_comment" style="font-size:12px;width:328px;height:72px;padding:4px 0 0 4px;overflow:auto;" onclick="document.getElementById(\'tb_forward_comment_guide\').style.display=\'none\';"></textarea><p style="color:#808080;">转贴文章会收藏到<span class="itb_i_small">i</span>贴吧“我的转贴”栏目中</p></div><p style="text-align:center;padding-top:6px;"><input type="button" value="确 定" onclick="Thread.doForward();" /></p></div>';var A=Fe.Dialog.open(B,{title:"转贴并收藏",width:400,height:180})}else{TbUtil.login()}};Thread.doForward=function(){var _data={cmd:"repaste",product_id:"1",tbs:PageData.forward_sign,tid:PageData.thread.id,title:PageData.thread.title,fid:PageData.forum_id,fname:PageData.forum_name,ie:"utf-8",pid:0,uname:PageData.thread.author};_data.comment=Fe.G("tb_forward_comment").value;var _url="/i/commit?st_mod=pb&fr=tb0_forum&st_type=forward";Fe.Ajax.post(_url,Fe.Object.toQueryString(_data),function(xhr){var data=eval("("+xhr.responseText+")");if(typeof data=="undefined"){return }if(data.is_done){var ele=Fe.G("forward_num");var num=parseInt(ele.innerHTML);ele.innerHTML=num+1;ele.parentNode.style.display="block";Fe.G("tb_forward_cnt").innerHTML='<p style="margin-top:54px;text-align:center;">您已成功添加了转贴！</p>';setTimeout(function(){Fe.Dialog.close()},1000)}else{Fe.G("tb_forward_cnt").innerHTML='<p style="margin-top:42px;text-align:center;">'+data._info+'</p><p style="text-align:center;padding-top:12px;"><button onclick="Fe.Dialog.close();" style="width:75px;">确 定</button></p>'}})};var UserIcon=UserIcon||{};UserIcon.timer=null;UserIcon.follow=function(A){Itieba.follow(A,"pb");UserIcon.sex=A.className};UserIcon.unfollow=function(A){Itieba.unfollow(A,"pb")};UserIcon.showHasFollowed=function(C){var B=C.parentNode.getAttribute("data-class");var A=C.parentNode.getAttribute("data-concerned");var D=(A=="1")?"has_followed":B;C.parentNode.innerHTML='<a href="#" class="'+D+'" onclick="return false;" onmouseover="UserIcon.showUnfollowEntry(this);" onmouseout="UserIcon.cleraTimer(this);"></a>'};UserIcon.showUnfollowEntry=function(A){if(UserIcon.timer!=null){clearTimeout(UserIcon.timer)}UserIcon.timer=setTimeout(function(){A.parentNode.innerHTML='<a href="#" class="unfollow" onclick="UserIcon.unfollow(this,\'pb\');return false;" onmouseout="UserIcon.showHasFollowed(this);"></a>'},200)};UserIcon.cleraTimer=function(A){if(UserIcon.timer!=null){clearTimeout(UserIcon.timer)}};var Itieba=Itieba||{};Itieba.follow=function(ele,type){if(!PageData.user.is_login){TbUtil.login();return false}var obj=Itieba.follow_config[type];var _portrait=obj.getPortrait(ele);var data={portrait:_portrait,cmd:"follow",tbs:PageData.follow_sign,ie:"urf-8"};var _url="/i/commit?"+obj.st_params_follow;Fe.Ajax.post(_url,Fe.Object.toQueryString(data),function(xhr){var data=eval("("+xhr.responseText+")");if(typeof data=="undefined"){return }obj.doAfterFollow(data,_portrait)})};Itieba.unfollow=function(ele,type){if(!PageData.user.is_login){TbUtil.login();return false}var obj=Itieba.follow_config[type];var _portrait=obj.getPortrait(ele);var data={portrait:_portrait,cmd:"unfollow",tbs:PageData.follow_sign,ie:"urf-8"};var _url="/i/commit?"+obj.st_params_unfollow;Fe.Ajax.post(_url,Fe.Object.toQueryString(data),function(xhr){var data=eval("("+xhr.responseText+")");if(typeof data=="undefined"){return }obj.doAfterUnfollow(data,_portrait)})};Itieba.follow_config={pb:{st_params_follow:"st_mod=pb&fr=tb0_forum&st_type=add_follow",st_params_unfollow:"st_mod=pb&fr=tb0_forum&st_type=unfollow",getPortrait:function(A){var B=A.parentNode.id;return B},doAfterFollow:function(A,B){if(A.is_done){this._updateFollowState(true,B)}else{Page.showErrorTip("加关注",A._info)}},doAfterUnfollow:function(A,B){if(A.is_done){this._updateFollowState(false,B)}else{Page.showErrorTip("取消关注",A._info)}},_updateFollowState:function(A,I){var J=document.getElementsByName(I);var C="";var D=document.getElementsByName(I+"_fans_num");var E=D.length;if(E>0){var H=parseInt(D[0].innerHTML)}if(A){C='<a href="#" class="has_followed"  onclick="return false;"></a>';H++}else{C='<a href="#" class="'+J[0].getAttribute("data-class")+'" onclick="UserIcon.follow(this);return false;"></a>';H=(--H<0)?0:H}for(var B=0,F=J.length;B<F;B++){J[B].innerHTML=C;if(E>0){D[B].innerHTML=H;if(H>0){D[B].parentNode.style.display=""}else{D[B].parentNode.style.display="none"}}J[B].setAttribute("data-concerned",A==true?1:0)}if(A){setTimeout(function(){var L=document.getElementsByName(I);var N=null;for(var M=0,K=L.length;M<K;M++){N=L[M].firstChild;N.onmouseover=function(){UserIcon.showUnfollowEntry(this)};N.onmouseout=function(){UserIcon.cleraTimer()}}},1000)}J=null;D=null}}};var VipComplain={view:function(D,B){var H={"1":"黄色，反动信息","2":"侮辱、诽谤等文字攻击内容","3":"发布广告","4":"冒用ID","0":"其它"};var C='<ul id="cpl_type_list">';var I;for(var E in H){I='<li><label><input type="radio" name="vip_categories" value="'+E+'"/>&nbsp;'+H[E]+"</label></li>";C+=I}C+="</ul>";var A='<div id="vip_complain"><form id="vip_cpl_form" name="vip_cpl_form" onsubmit="return VipComplain.add();" target="ifr_vip_complain" action="/tousu/new/commit" method="post"><table><tr><td class="left">投诉贴：</td><td>#{title} #{floor}</td></tr><tr><td class="left"><span class="star">*</span> 投诉类型：</td><td>#{c_type}<span id="vip_categories_msg" class="err_msg"></span></td></tr><tr><td class="left"><span class="star">*</span> 投诉描述：</td><td><textarea name="cplDetail" id="cplDetail" onpaste="VipComplain.limit_length(this,500)" onkeyup="VipComplain.limit_length(this,500)"></textarea><br /><span id="cplDetail_msg" class="err_msg"></span></td></tr><tr><td class="left"></td><td><input id="vip_c_s" type="submit" value="提交" />&nbsp;&nbsp;<span id="vip_c_s_msg" class="err_msg"></span></td></tr></table><input type="hidden" name="cplTitle" value="#{title}" /><input type="hidden" name="cplCategoryID" value="6" /><input type="hidden" name="cplLink" value="#{link}" /><input type="hidden" name="cplForumName" value="#{f_name}" /><input type="hidden" name="cplForumID" value="#{f_id}" /></form>';var J="",F="http://tieba.baidu.com/";if("0"!=D){J=D+"楼";F=F+"f?ct=335675392&tn=baiduPostBrowser&sc="+B+"&z="+PageData.thread.id+"#"+B}else{F=F+"f?kz="+PageData.thread.id}A=Fe.format(A,{title:Fe.String.escapeHTML(PageData.thread.title),floor:J,c_type:C,link:F,f_name:Fe.String.escapeHTML(PageData.forum_name),f_id:PageData.forum_id});Fe.Dialog.open(A,{title:"绿色投诉通道",width:470})},add:function(){var C=Fe.G("vip_cpl_form");var E="";var F=Fe.G("cpl_type_list").getElementsByTagName("input");for(var A=F.length;A>0;A--){if(F[A-1].checked){E=F[A-1].value;break}}var D=C.cplDetail.value;console.log(E+"::::::::"+D);var B=Fe.G("vip_categories_msg");var H=Fe.G("cplDetail_msg");if(""==E){B.innerHTML="请选择投诉类型";B.style.display="";return false}else{B.innerHTML="请选择投诉类型";B.style.display="none"}if(""==D){H.innerHTML="请填写投诉描述";H.style.display="";return false}else{H.innerHTML="";H.style.display="none"}return true},agree:function(B){var A=Fe.G("vip_c_s");A.disabled=!B.checked},limit_length:function(C,E){function B(L,K){L=String(L);var I,F,M,N;for(var J=Math.floor(length/2)-1,H=L.length;J<H;J++){I=L.substr(0,J);M=Fe.String.getByteLength(I);if(M==K){return I}else{F=L.substr(0,J+1);N=Fe.String.getByteLength(F);if(M<K&&N>K){return I}}}return L}var A=Fe.trim(C.value);if(Fe.String.getByteLength(A)>E){var D=B(A,E);C.value=D}}};function resultCall(C){var D;var A=C.resultNo;if(A=="0"){Fe.Dialog.close();var E='<div style="padding:20px 0 0 24px;line-height:18px;"><table><tr><td><img src="http://static.tieba.baidu.com/tb/static-itieba/img/public/successFace.gif"></td><td><h4 style="font:lighter 18px/36px 黑体;margin-left:12px;">您的投诉已经提交成功！</h4></td></tr><tr><td colspan="2" style="padding:12px 0 12px 16px;">我们将尽快处理您的投诉！请耐心等待！<td></tr></table></div>';Fe.Dialog.alert(E,{title:"绿色投诉通道",width:370})}else{var B=Fe.G("vip_c_s_msg");var F={"201":"退出或失去权限","103":"您已经提交过完全相同投诉","104":"请不要在短时间内连续发起投诉","105":"您的账号由于违规操作而被封，目前无权限进行该操作","107":"由于系统维护，暂时不能发起任何投诉"};if(A=="-1"){}else{if(A in F){B.innerHTML=F[A]}else{B.innerHTML="服务器端未知错误，提交未成功"}}}}var TipPanel=function(D,J){var I=null;window.TipGlobalDiv_clickObj=D;var C=J;window.TipGlobalDiv=this;function H(){if(window.TipGlobalDiv_clickObj){I=window.TipGlobalDiv_clickObj;var N=A(window.TipGlobalDiv_clickObj);var M=L();M.style.left=(N[0]-15)+"px";M.style.top=(N[1]-100)+"px";M.style.display=""}}function E(){var M=L();M.style.display="none"}this.hide=E;function B(){var M='<div  id="memTipClosePanel" style="position:absolute; top:0px; right:0px; width:25px; height:30px; padding: 10px 0px 0px 0px;"><a id="memTipMemTipClose" href="javascript:void(0)" style="display:block; width: 15px;height: 15px;" onclick="javascript:window[\'TipGlobalDiv\'].hide()">&nbsp;&nbsp;&nbsp;</a></div>';M+='<div id="memTipPanel">';M+=C.content;M+="</div>";M+='<div style="clear:both"></div>';var N=L();if(N){N.style.background=C.background;N.innerHTML=M}}function A(M){var N=curtop=0;if(M.offsetParent){N=M.offsetLeft;curtop=M.offsetTop;while(M=M.offsetParent){N+=M.offsetLeft;curtop+=M.offsetTop}}return[N,curtop]}function L(){var M=document.getElementById("TipParentDiv");if(!M){M=document.createElement("div");M.id="TipParentDiv";M.style.width=C.width+"px";M.style.height=C.height+"px";M.style.position="absolute";M.style.zIndex="999";M.style.zoom="1";M.style.display="none";F(document,"click",K);F(window,"resize",function(){E()});document.body.appendChild(M)}return M}function K(P){var O=P.target||event.srcElement;if(O==window.TipGlobalDiv_clickObj||O.id=="TipParentDiv"){return }var N=O;var M=false;N=N.offsetParent;while(N&&N.nodeName!="BODY"){if(N.id=="TipParentDiv"){M=true;break}N=N.offsetParent}if(!M){E()}}function F(O,M,N){if(window.addEventListener){O.addEventListener(M,N,false)}else{if(window.attachEvent){O.attachEvent("on"+M,N)}}}B();H()};function showChuanTip(C){var D=PageData.is_login?"http://tieba.baidu.com/i/sys/jump?type=all":"http://passport.baidu.com/?login&tpl=tb&u="+escape("http://tieba.baidu.com/i/sys/jump?type=all");var B='<div style="width:213px; font-size:12px; line-height: 17px; padding-left: 13px; padding-top:20px">在贴吧里关注与您兴趣相投的朋友，<br>便可在i贴吧传送门收到TA的最新动态。<span style="margin-top: 7px; display:block;"><a target="_blank" href="'+D+'" onclick="Statistics.sendRequest(\'st_mod=pb_door&fr=tb0_forum&st_type=display\');return true">进入我的i贴吧传送门</a></span></div>';var A="url('http://static.tieba.baidu.com/tb/img/pb/tip_back.gif') no-repeat";new TipPanel(C,{width:245,height:100,content:B,background:A});setTimeout(function(){Statistics.sendRequest("st_mod=pb_door&fr=tb0_forum&st_type=display")},10)}var VoteInfo={_vote_id:"",ele_id:"",rc:function(E,C,D,B){var A='<div class="'+C+'" id="'+E+'">	<div class="rc_top"><b></b><i></i></div>	<div class="rc_content">	<div class="title">'+D+'</div>	<div class="cnt">'+B+'</div>	</div>	<div class="rc_bottom"><b></b><i></i></div></div>';return A},render:function(uname_gbk,vote_id,ele_id){this._vote_id=vote_id;this.ele_id=ele_id;var _url="/i/data/user_data?type=double_follow&un="+uname_gbk+"&alt=json&t="+new Date().getTime().toString(32);Fe.Ajax.get(_url,function(xhr){var data=eval("("+xhr.responseText+")");if(typeof data=="undefined"&&data.length==0){return }var _url="/vote/data/user_options?alt=json";if(data.length>0){Fe.Ajax.post(_url,VoteInfo.buildParams(data),function(xhr){var data=eval("("+xhr.responseText+")");var _html=[];var str="";var vote_option={};var _uname_link="";var _time;var ele;if(data.errno==0){len=data.vote_options.length;if(len>0){_html.push("<table>");for(var i=0;i<len;i++){vote_option=data.vote_options[i];_time=new Date(parseInt(vote_option.op_time)*1000);_uname_link='<a target="_blank" href="/i/sys/jump?ie=utf-8&un='+encodeURIComponent(vote_option.user_name)+'">'+vote_option.user_name+"</a>";str='<tr><td valign="top"><nobr>'+_uname_link+"&nbsp;&nbsp;</nobr></td><td>"+Fe.Date.format(_time,"yyyy-MM-dd HH:mm")+'&nbsp;&nbsp;<span class="vote_options">投票给'+vote_option.options+"</span></td></tr>";_html.push(str)}_html.push("</table>");ele=Fe.G(VoteInfo.ele_id);ele.innerHTML=VoteInfo.rc("","vote_detail_rc","",_html.join(""));ele.style.display="block"}}})}})},buildParams:function(E){var D=[];var C=0;D.push("product_name=forum");D.push("vote_id="+this._vote_id);for(var B=0,A=E.length;B<A;B++){D.push("user_id_"+(B+1)+"="+E[B].id)}return D.join("&")}};